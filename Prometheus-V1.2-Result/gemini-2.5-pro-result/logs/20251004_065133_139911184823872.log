2025-10-04 06:51:33,182 - thread-139911184823872.app.docker.base_container - INFO - Created temporary project directory: /tmp/tmpchl6ysvl/astropy
2025-10-04 06:51:33,182 - thread-139911184823872.app.docker.base_container - DEBUG - Using workdir: /testbed
2025-10-04 06:51:33,182 - thread-139911184823872.app.docker.base_container - INFO - Pulling docker image: swebench/sweb.eval.x86_64.astropy_1776_astropy-13236:v1
2025-10-04 06:51:51,368 - thread-139911184823872.app.docker.base_container - INFO - Tagging pulled image as: prometheus_user_defined_container_2bce411492
2025-10-04 06:51:51,372 - thread-139911184823872.app.docker.base_container - INFO - Starting container from image prometheus_user_defined_container_2bce411492
2025-10-04 06:51:53,227 - thread-139911184823872.app.docker.base_container - INFO - Starting persistent shell for interactive mode...
2025-10-04 06:51:53,365 - thread-139911184823872.app.docker.base_container - INFO - Persistent shell is ready
2025-10-04 06:51:53,366 - thread-139911184823872.app.docker.base_container - DEBUG - Executing command: . /opt/miniconda3/bin/activate
2025-10-04 06:51:53,489 - thread-139911184823872.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-04 06:51:53,489 - thread-139911184823872.app.docker.base_container - DEBUG - Command output:


2025-10-04 06:51:53,489 - thread-139911184823872.app.docker.base_container - DEBUG - Executing command: conda activate testbed
2025-10-04 06:51:53,613 - thread-139911184823872.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-04 06:51:53,613 - thread-139911184823872.app.docker.base_container - DEBUG - Command output:


2025-10-04 06:51:53,613 - thread-139911184823872.app.docker.base_container - DEBUG - Executing command: python -m pip install -e .[test] --verbose
2025-10-04 06:52:37,642 - thread-139911184823872.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-04 06:52:37,642 - thread-139911184823872.app.docker.base_container - DEBUG - Command output:
python -m pip install -e .[test]
] --verbose

Using pip 24.2 from /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pip (python 3.9)
Obtaining file:///testbed
  Running command pip subprocess to install build dependencies
  Using pip 24.2 from /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pip (python 3.9)
  Collecting setuptools==68.0.0
    Obtaining dependency information for setuptools==68.0.0 from https://files.pythonhosted.org/packages/c7/42/be1c7bbdd83e1bfb160c94b9cafd8e25efc7400346cf7ccdbdb452c467fa/setuptools-68.0.0-py3-none-any.whl.metadata
    Using cached setuptools-68.0.0-py3-none-any.whl.metadata (6.4 kB)
  Collecting setuptools_scm>=6.2
    Obtaining dependency information for setuptools_scm>=6.2 from https://files.pythonhosted.org/packages/f7/14/dd3a6053325e882fe191fb4b42289bbdfabf5f44307c302903a8a3236a0a/setuptools_scm-9.2.0-py3-none-any.whl.metadata
    Downloading setuptools_scm-9.2.0-py3-none-any.whl.metadata (7.7 kB)
  Collecting wheel
    Obtaining dependency information for wheel from https://files.pythonhosted.org/packages/0b/2c/87f3254fd8ffd29e4c02732eee68a83a1d3c346ae39bc6822dcbcb697f2b/wheel-0.45.1-py3-none-any.whl.metadata
    Downloading wheel-0.45.1-py3-none-any.whl.metadata (2.3 kB)
  Collecting cython==0.29.22
    Obtaining dependency information for cython==0.29.22 from https://files.pythonhosted.org/packages/08/3b/7697d21e325f27946ee41ef1c78648b6009b609ff22d8614270a758706a1/Cython-0.29.22-cp39-cp39-manylinux1_x86_64.whl.metadata
    Using cached Cython-0.29.22-cp39-cp39-manylinux1_x86_64.whl.metadata (2.6 kB)
  Collecting oldest-supported-numpy
    Obtaining dependency information for oldest-supported-numpy from https://files.pythonhosted.org/packages/dc/5c/e3c84cfdd488701aa074b22cf5bd227fb15d26e1d55a66d9088c39afa123/oldest_supported_numpy-2023.12.21-py3-none-any.whl.metadata
    Using cached oldest_supported_numpy-2023.12.21-py3-none-any.whl.metadata (9.8 kB)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/88/ff/5a7cd8c9698628b3c04215ee3a96c69865477f451b4f096682e78d085bfc/extension_helpers-1.3.0-py3-none-any.whl (from https://pypi.org/simple/extension-helpers/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/8e/b1/73ce2924fe46281faf31567e96fb9eee4eca02fd1cb852562bb2971e9df1/extension_helpers-1.3.0.tar.gz (from https://pypi.org/simple/extension-helpers/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/f8/fb/f9a88ccea5377736d5d1e53c8a6c70207178cdc1ebbf305a50a610cbb751/extension_helpers-1.4.0-py3-none-any.whl (from https://pypi.org/simple/extension-helpers/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/24/51/d03359b683ed288b34d713dea97d2aee87a9bd866af1652554d9f643b47d/extension_helpers-1.4.0.tar.gz (from https://pypi.org/simple/extension-helpers/) (requires-python:>=3.10)
  Collecting extension-helpers
    Obtaining dependency information for extension-helpers from https://files.pythonhosted.org/packages/b3/0e/22599eac9e50f4274e78e47cef7e760d7a1bb2f0d0fdfb0bb5b0d2da263a/extension_helpers-1.2.0-py3-none-any.whl.metadata
    Using cached extension_helpers-1.2.0-py3-none-any.whl.metadata (2.2 kB)
  Collecting packaging>=20 (from setuptools_scm>=6.2)
    Obtaining dependency information for packaging>=20 from https://files.pythonhosted.org/packages/20/12/38679034af332785aac8774540895e234f4d07f7545804097de4b666afd8/packaging-25.0-py3-none-any.whl.metadata
    Downloading packaging-25.0-py3-none-any.whl.metadata (3.3 kB)
  Collecting tomli>=1 (from setuptools_scm>=6.2)
    Obtaining dependency information for tomli>=1 from https://files.pythonhosted.org/packages/6e/c2/61d3e0f47e2b74ef40a68b9e6ad5984f6241a942f7cd3bbfbdbd03861ea9/tomli-2.2.1-py3-none-any.whl.metadata
    Downloading tomli-2.2.1-py3-none-any.whl.metadata (10 kB)
  Collecting typing-extensions (from setuptools_scm>=6.2)
    Obtaining dependency information for typing-extensions from https://files.pythonhosted.org/packages/18/67/36e9267722cc04a6b9f15c7f3441c2363321a3ea07da7ae0c0707beb2a9c/typing_extensions-4.15.0-py3-none-any.whl.metadata
    Downloading typing_extensions-4.15.0-py3-none-any.whl.metadata (3.3 kB)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/54/a4/f8188c4f3e07f7737683588210c073478abcb542048cf4ab6fedad0b458a/numpy-2.1.0.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/59/5f/9003bb3e632f2b58f5e3a3378902dcc73c5518070736c6740fe52454e8e1/numpy-2.1.1.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/4b/d1/8a730ea07f4a37d94f9172f4ce1d81064b7a64766b460378be278952de75/numpy-2.1.2.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/25/ca/1166b75c21abd1da445b97bf1fa2f14f423c6cfb4fc7c4ef31dccf9f6a94/numpy-2.1.3.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/47/1b/1d565e0f6e156e1522ab564176b8b29d71e13d8caf003a08768df3d5cec5/numpy-2.2.0.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/f2/a5/fdbf6a7871703df6160b5cf3dd774074b086d278172285c52c2758b76305/numpy-2.2.1.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/ec/d0/c12ddfd3a02274be06ffc71f3efc6d0e457b0409c4481596881e748cb264/numpy-2.2.2.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/fb/90/8956572f5c4ae52201fdec7ba2044b2c882832dcec7d5d0922c9e9acf2de/numpy-2.2.3.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/e1/78/31103410a57bc2c2b93a3597340a8119588571f6a4539067546cb9a0bfac/numpy-2.2.4.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/dc/b2/ce4b867d8cd9c0ee84938ae1e6a6f7926ebf928c9090d036fc3c6a04f946/numpy-2.2.5.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/76/21/7d2a95e4bba9dc13d043ee156a356c0a8f0c6309dff6b21b4d71a073b8a8/numpy-2.2.6.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/f3/db/8e12381333aea300890829a0a36bfa738cac95475d88982d538725143fd9/numpy-2.3.0.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/2e/19/d7c972dfe90a353dbd3efbbe1d14a5951de80c99c9dc1b93cd998d51dc0f/numpy-2.3.1.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/37/7d/3fec4199c5ffb892bed55cff901e4f39a58c81df9c44c280499e92cad264/numpy-2.3.2.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/d0/19/95b3d357407220ed24c139018d2518fab0a61a948e68286a25f1a4d049ff/numpy-2.3.3.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
  Collecting numpy==1.19.3 (from oldest-supported-numpy)
    Obtaining dependency information for numpy==1.19.3 from https://files.pythonhosted.org/packages/c3/8d/2ae53d96a92a66b8daa3dfb2dd6cf4bfcb8e3d4148bdd713c8fc7de83141/numpy-1.19.3-cp39-cp39-manylinux2010_x86_64.whl.metadata
    Using cached numpy-1.19.3-cp39-cp39-manylinux2010_x86_64.whl.metadata (2.0 kB)
  Using cached setuptools-68.0.0-py3-none-any.whl (804 kB)
  Using cached Cython-0.29.22-cp39-cp39-manylinux1_x86_64.whl (1.9 MB)
  Downloading setuptools_scm-9.2.0-py3-none-any.whl (62 kB)
  Downloading wheel-0.45.1-py3-none-any.whl (72 kB)
  Using cached oldest_supported_numpy-2023.12.21-py3-none-any.whl (4.9 kB)
  Using cached numpy-1.19.3-cp39-cp39-manylinux2010_x86_64.whl (14.9 MB)
  Using cached extension_helpers-1.2.0-py3-none-any.whl (23 kB)
  Downloading packaging-25.0-py3-none-any.whl (66 kB)
  Downloading tomli-2.2.1-py3-none-any.whl (14 kB)
  Downloading typing_extensions-4.15.0-py3-none-any.whl (44 kB)
  Installing collected packages: wheel, typing-extensions, tomli, setuptools, packaging, numpy, cython, setuptools_scm, oldest-supported-numpy, extension-helpers
    Creating /tmp/pip-build-env-fn13fcdz/overlay/bin
    changing mode of /tmp/pip-build-env-fn13fcdz/overlay/bin/wheel to 755
    changing mode of /tmp/pip-build-env-fn13fcdz/overlay/bin/f2py to 755
    changing mode of /tmp/pip-build-env-fn13fcdz/overlay/bin/f2py3 to 755
    changing mode of /tmp/pip-build-env-fn13fcdz/overlay/bin/f2py3.9 to 755
    changing mode of /tmp/pip-build-env-fn13fcdz/overlay/bin/cygdb to 755
    changing mode of /tmp/pip-build-env-fn13fcdz/overlay/bin/cython to 755
    changing mode of /tmp/pip-build-env-fn13fcdz/overlay/bin/cythonize to 755
    changing mode of /tmp/pip-build-env-fn13fcdz/overlay/bin/setuptools-scm to 755
  Successfully installed cython-0.29.22 extension-helpers-1.2.0 numpy-1.19.3 oldest-supported-numpy-2023.12.21 packaging-25.0 setuptools-68.0.0 setuptools_scm-9.2.0 tomli-2.2.1 typing-extensions-4.15.0 wheel-0.45.1
  WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
  Installing build dependencies ... [?25l[?25hdone
  Running command Checking if build backend supports build_editable
  Checking if build backend supports build_editable ... [?25l[?25hdone
  Running command Getting requirements to build editable
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/setuptools/config/setupcfg.py:293: _DeprecatedConfig: Deprecated config in `setup.cfg`
  !!

          ********************************************************************************
          The license_file parameter is deprecated, use license_files instead.

          This deprecation is overdue, please update your project and remove deprecated
          calls to avoid build errors in the future.

          See https://setuptools.pypa.io/en/latest/userguide/declarative_config.html for details.
          ********************************************************************************

  !!
    parsed = self.parsers.get(option_name, lambda x: x)(value)
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/setuptools/config/setupcfg.py:293: _DeprecatedConfig: Deprecated config in `setup.cfg`
  !!

          ********************************************************************************
          The license_file parameter is deprecated, use license_files instead.

          This deprecation is overdue, please update your project and remove deprecated
          calls to avoid build errors in the future.

          See https://setuptools.pypa.io/en/latest/userguide/declarative_config.html for details.
          ********************************************************************************

  !!
    parsed = self.parsers.get(option_name, lambda x: x)(value)
  running egg_info
  writing astropy.egg-info/PKG-INFO
  writing dependency_links to astropy.egg-info/dependency_links.txt
  writing entry points to astropy.egg-info/entry_points.txt
  writing requirements to astropy.egg-info/requires.txt
  writing top-level names to astropy.egg-info/top_level.txt
  reading manifest template 'MANIFEST.in'
  warning: no files found matching '*.templ' under directory 'astropy'
  warning: no files found matching 'astropy/astropy.cfg'
  warning: no files found matching '*' under directory 'scripts'
  warning: no files found matching '*' under directory 'static'
  no previously-included directories found matching 'docs/_build'
  no previously-included directories found matching 'build'
  warning: no previously-included files matching '*.pyc' found anywhere in distribution
  warning: no previously-included files matching '*.o' found anywhere in distribution
  adding license file 'LICENSE.rst'
  writing manifest file 'astropy.egg-info/SOURCES.txt'
  Getting requirements to build editable ... [?25l[?25hdone
  Running command Preparing editable metadata (pyproject.toml)
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/setuptools/config/setupcfg.py:293: _DeprecatedConfig: Deprecated config in `setup.cfg`
  !!

          ********************************************************************************
          The license_file parameter is deprecated, use license_files instead.

          This deprecation is overdue, please update your project and remove deprecated
          calls to avoid build errors in the future.

          See https://setuptools.pypa.io/en/latest/userguide/declarative_config.html for details.
          ********************************************************************************

  !!
    parsed = self.parsers.get(option_name, lambda x: x)(value)
  running dist_info
  creating /tmp/pip-modern-metadata-nqszcilr/astropy.egg-info
  writing /tmp/pip-modern-metadata-nqszcilr/astropy.egg-info/PKG-INFO
  writing dependency_links to /tmp/pip-modern-metadata-nqszcilr/astropy.egg-info/dependency_links.txt
  writing entry points to /tmp/pip-modern-metadata-nqszcilr/astropy.egg-info/entry_points.txt
  writing requirements to /tmp/pip-modern-metadata-nqszcilr/astropy.egg-info/requires.txt
  writing top-level names to /tmp/pip-modern-metadata-nqszcilr/astropy.egg-info/top_level.txt
  writing manifest file '/tmp/pip-modern-metadata-nqszcilr/astropy.egg-info/SOURCES.txt'
  reading manifest template 'MANIFEST.in'
  warning: no files found matching '*.templ' under directory 'astropy'
  warning: no files found matching 'astropy/astropy.cfg'
  warning: no files found matching '*' under directory 'scripts'
  warning: no files found matching '*' under directory 'static'
  no previously-included directories found matching 'docs/_build'
  no previously-included directories found matching 'build'
  warning: no previously-included files matching '*.pyc' found anywhere in distribution
  warning: no previously-included files matching '*.o' found anywhere in distribution
  adding license file 'LICENSE.rst'
  writing manifest file '/tmp/pip-modern-metadata-nqszcilr/astropy.egg-info/SOURCES.txt'
  creating '/tmp/pip-modern-metadata-nqszcilr/astropy-5.2.dev64+g6ed769d58.d20251003.dist-info'
  Preparing editable metadata (pyproject.toml) ... [?25l[?25hdone
Requirement already satisfied: numpy>=1.18 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev64+g6ed769d58.d20251003) (1.25.2)
Requirement already satisfied: pyerfa>=2.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev64+g6ed769d58.d20251003) (2.0.0.3)
Requirement already satisfied: PyYAML>=3.13 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev64+g6ed769d58.d20251003) (6.0.1)
Requirement already satisfied: packaging>=19.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev64+g6ed769d58.d20251003) (23.1)
Requirement already satisfied: pytest>=7.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev64+g6ed769d58.d20251003) (7.4.0)
Requirement already satisfied: pytest-doctestplus>=0.12 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev64+g6ed769d58.d20251003) (1.0.0)
Requirement already satisfied: pytest-astropy-header>=0.2.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev64+g6ed769d58.d20251003) (0.2.2)
Requirement already satisfied: pytest-astropy>=0.10 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev64+g6ed769d58.d20251003) (0.10.0)
Requirement already satisfied: pytest-xdist in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev64+g6ed769d58.d20251003) (3.3.1)
Requirement already satisfied: iniconfig in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest>=7.0->astropy==5.2.dev64+g6ed769d58.d20251003) (2.0.0)
Requirement already satisfied: pluggy<2.0,>=0.12 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest>=7.0->astropy==5.2.dev64+g6ed769d58.d20251003) (1.3.0)
Requirement already satisfied: exceptiongroup>=1.0.0rc8 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest>=7.0->astropy==5.2.dev64+g6ed769d58.d20251003) (1.1.3)
Requirement already satisfied: tomli>=1.0.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest>=7.0->astropy==5.2.dev64+g6ed769d58.d20251003) (2.0.1)
Requirement already satisfied: pytest-remotedata>=0.3.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.2.dev64+g6ed769d58.d20251003) (0.4.0)
Requirement already satisfied: pytest-openfiles>=0.3.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.2.dev64+g6ed769d58.d20251003) (0.5.0)
Requirement already satisfied: pytest-arraydiff>=0.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.2.dev64+g6ed769d58.d20251003) (0.5.0)
Requirement already satisfied: pytest-filter-subpackage>=0.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.2.dev64+g6ed769d58.d20251003) (0.1.2)
Requirement already satisfied: pytest-cov>=2.3.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.2.dev64+g6ed769d58.d20251003) (4.1.0)
Requirement already satisfied: pytest-mock>=2.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.2.dev64+g6ed769d58.d20251003) (3.11.1)
Requirement already satisfied: attrs>=19.2.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.2.dev64+g6ed769d58.d20251003) (23.1.0)
Requirement already satisfied: hypothesis>=5.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.2.dev64+g6ed769d58.d20251003) (6.82.6)
Requirement already satisfied: setuptools>=30.3.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-doctestplus>=0.12->astropy==5.2.dev64+g6ed769d58.d20251003) (68.0.0)
Requirement already satisfied: execnet>=1.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-xdist->astropy==5.2.dev64+g6ed769d58.d20251003) (2.0.2)
Requirement already satisfied: sortedcontainers<3.0.0,>=2.1.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from hypothesis>=5.1->pytest-astropy>=0.10->astropy==5.2.dev64+g6ed769d58.d20251003) (2.4.0)
Requirement already satisfied: coverage>=5.2.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from coverage[toml]>=5.2.1->pytest-cov>=2.3.1->pytest-astropy>=0.10->astropy==5.2.dev64+g6ed769d58.d20251003) (7.6.2)
Requirement already satisfied: psutil in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-openfiles>=0.3.1->pytest-astropy>=0.10->astropy==5.2.dev64+g6ed769d58.d20251003) (5.9.5)
Building wheels for collected packages: astropy
  Running command Building editable for astropy (pyproject.toml)
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/setuptools/config/setupcfg.py:293: _DeprecatedConfig: Deprecated config in `setup.cfg`
  !!

          ********************************************************************************
          The license_file parameter is deprecated, use license_files instead.

          This deprecation is overdue, please update your project and remove deprecated
          calls to avoid build errors in the future.

          See https://setuptools.pypa.io/en/latest/userguide/declarative_config.html for details.
          ********************************************************************************

  !!
    parsed = self.parsers.get(option_name, lambda x: x)(value)
  running editable_wheel
  creating /tmp/pip-wheel-nu7kpdin/.tmp-ow9l0iq0/astropy.egg-info
  writing /tmp/pip-wheel-nu7kpdin/.tmp-ow9l0iq0/astropy.egg-info/PKG-INFO
  writing dependency_links to /tmp/pip-wheel-nu7kpdin/.tmp-ow9l0iq0/astropy.egg-info/dependency_links.txt
  writing entry points to /tmp/pip-wheel-nu7kpdin/.tmp-ow9l0iq0/astropy.egg-info/entry_points.txt
  writing requirements to /tmp/pip-wheel-nu7kpdin/.tmp-ow9l0iq0/astropy.egg-info/requires.txt
  writing top-level names to /tmp/pip-wheel-nu7kpdin/.tmp-ow9l0iq0/astropy.egg-info/top_level.txt
  writing manifest file '/tmp/pip-wheel-nu7kpdin/.tmp-ow9l0iq0/astropy.egg-info/SOURCES.txt'
  reading manifest template 'MANIFEST.in'
  warning: no files found matching '*.templ' under directory 'astropy'
  warning: no files found matching 'astropy/astropy.cfg'
  warning: no files found matching '*' under directory 'scripts'
  warning: no files found matching '*' under directory 'static'
  no previously-included directories found matching 'docs/_build'
  no previously-included directories found matching 'build'
  warning: no previously-included files matching '*.pyc' found anywhere in distribution
  warning: no previously-included files matching '*.o' found anywhere in distribution
  adding license file 'LICENSE.rst'
  writing manifest file '/tmp/pip-wheel-nu7kpdin/.tmp-ow9l0iq0/astropy.egg-info/SOURCES.txt'
  creating '/tmp/pip-wheel-nu7kpdin/.tmp-ow9l0iq0/astropy-5.2.dev64+g6ed769d58.d20251003.dist-info'
  creating /tmp/pip-wheel-nu7kpdin/.tmp-ow9l0iq0/astropy-5.2.dev64+g6ed769d58.d20251003.dist-info/WHEEL
  running build_py
  running build_ext
  skipping 'astropy/table/_np_utils.c' Cython extension (up-to-date)
  skipping 'astropy/table/_column_mixins.c' Cython extension (up-to-date)
  skipping 'astropy/io/ascii/cparser.c' Cython extension (up-to-date)
  skipping 'astropy/timeseries/periodograms/bls/_impl.c' Cython extension (up-to-date)
  skipping './astropy/stats/_stats.c' Cython extension (up-to-date)
  skipping './astropy/io/fits/_utils.c' Cython extension (up-to-date)
  skipping './astropy/cosmology/flrw/scalar_inv_efuncs.c' Cython extension (up-to-date)
  skipping './astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.c' Cython extension (up-to-date)
  building 'astropy.stats._fast_sigma_clip' extension
  creating /tmp/tmpaeyyc2s3.build-temp/astropy
  creating /tmp/tmpaeyyc2s3.build-temp/astropy/stats
  creating /tmp/tmpaeyyc2s3.build-temp/astropy/stats/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/stats/src/compute_bounds.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/stats/src/compute_bounds.o
  astropy/stats/src/compute_bounds.c: In function â€˜compute_sigma_clipped_boundsâ€™:
  astropy/stats/src/compute_bounds.c:53:24: warning: â€˜cenâ€™ may be used uninitialized in this function [-Wmaybe-uninitialized]
     53 |     *upper_bound = cen + sigma_upper * std;
        |                    ~~~~^~~~~~~~~~~~~~~~~~~
  astropy/stats/src/compute_bounds.c:38:45: warning: â€˜medianâ€™ may be used uninitialized in this function [-Wmaybe-uninitialized]
     38 |         mad_buffer[i] = fabs(data_buffer[i] - median);
        |                              ~~~~~~~~~~~~~~~^~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/stats/src/fast_sigma_clip.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/stats/src/fast_sigma_clip.o
  astropy/stats/src/fast_sigma_clip.c: In function â€˜PyInit__fast_sigma_clipâ€™:
  astropy/stats/src/fast_sigma_clip.c:44:48: warning: initialization of â€˜void (*)(char **, const npy_intp *, const npy_intp *, void *)â€™ {aka â€˜void (*)(char **, const long int *, const long int *, void *)â€™} from incompatible pointer type â€˜void (*)(char **, npy_intp *, npy_intp *, void *)â€™ {aka â€˜void (*)(char **, long int *, long int *, void *)â€™} [-Wincompatible-pointer-types]
     44 |     static PyUFuncGenericFunction funcs[1] = { &_sigma_clip_fast };
        |                                                ^
  astropy/stats/src/fast_sigma_clip.c:44:48: note: (near initialization for â€˜funcs[0]â€™)
  In file included from /opt/miniconda3/envs/testbed/include/python3.9/pytime.h:6,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:81,
                   from astropy/stats/src/fast_sigma_clip.c:3:
  /opt/miniconda3/envs/testbed/include/python3.9/object.h:496:8: warning: â€˜dâ€™ may be used uninitialized [-Wmaybe-uninitialized]
    496 |     if (op != NULL) {
        |        ^
  astropy/stats/src/fast_sigma_clip.c:30:19: note: â€˜dâ€™ was declared here
     30 |     PyObject *m, *d;
        |                   ^
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/stats/src/wirth_select.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/stats/src/wirth_select.o
  creating /tmp/tmphxzey05s.build-lib/astropy
  creating /tmp/tmphxzey05s.build-lib/astropy/stats
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpaeyyc2s3.build-temp/astropy/stats/src/compute_bounds.o /tmp/tmpaeyyc2s3.build-temp/astropy/stats/src/fast_sigma_clip.o /tmp/tmpaeyyc2s3.build-temp/astropy/stats/src/wirth_select.o -o /tmp/tmphxzey05s.build-lib/astropy/stats/_fast_sigma_clip.cpython-39-x86_64-linux-gnu.so
  building 'astropy.table._np_utils' extension
  creating /tmp/tmpaeyyc2s3.build-temp/astropy/table
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/table/_np_utils.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/table/_np_utils.o
  In file included from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/table/_np_utils.c:610:
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  creating /tmp/tmphxzey05s.build-lib/astropy/table
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpaeyyc2s3.build-temp/astropy/table/_np_utils.o -o /tmp/tmphxzey05s.build-lib/astropy/table/_np_utils.cpython-39-x86_64-linux-gnu.so
  building 'astropy.table._column_mixins' extension
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/table/_column_mixins.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/table/_column_mixins.o
  In file included from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/table/_column_mixins.c:608:
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  In file included from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:21,
                   from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/table/_column_mixins.c:608:
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/__multiarray_api.h:1463:1: warning: â€˜_import_arrayâ€™ defined but not used [-Wunused-function]
   1463 | _import_array(void)
        | ^~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpaeyyc2s3.build-temp/astropy/table/_column_mixins.o -o /tmp/tmphxzey05s.build-lib/astropy/table/_column_mixins.cpython-39-x86_64-linux-gnu.so
  building 'astropy.utils._compiler' extension
  creating /tmp/tmpaeyyc2s3.build-temp/astropy/utils
  creating /tmp/tmpaeyyc2s3.build-temp/astropy/utils/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/utils/src/compiler.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/utils/src/compiler.o
  creating /tmp/tmphxzey05s.build-lib/astropy/utils
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpaeyyc2s3.build-temp/astropy/utils/src/compiler.o -o /tmp/tmphxzey05s.build-lib/astropy/utils/_compiler.cpython-39-x86_64-linux-gnu.so
  building 'astropy.wcs._wcs' extension
  creating /tmp/tmpaeyyc2s3.build-temp/astropy/wcs
  creating /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src
  creating /tmp/tmpaeyyc2s3.build-temp/cextern
  creating /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib
  creating /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C
  creating /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/flexed
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/astropy_wcs.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/astropy_wcs.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/astropy_wcs_api.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/astropy_wcs_api.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/distortion.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/distortion.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/distortion_wrap.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/distortion_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/docstrings.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/docstrings.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/pipeline.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/pipeline.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/pyutil.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/pyutil.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  In file included from /usr/include/string.h:535,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:30,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:13,
                   from astropy/wcs/src/pyutil.c:9:
  In function â€˜strncpyâ€™,
      inlined from â€˜set_pscardsâ€™ at astropy/wcs/src/pyutil.c:807:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ specified bound 72 equals destination size [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/sip.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/sip.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/sip_wrap.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/sip_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/str_list_proxy.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/str_list_proxy.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/unit_list_proxy.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/unit_list_proxy.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/util.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/util.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_auxprm_wrap.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/wcslib_auxprm_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_celprm_wrap.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/wcslib_celprm_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  astropy/wcs/src/wcslib_celprm_wrap.c: In function â€˜PyCelprm_deepcopyâ€™:
  astropy/wcs/src/wcslib_celprm_wrap.c:167:22: warning: initialization of â€˜PyCelprm *â€™ from incompatible pointer type â€˜PyObject *â€™ {aka â€˜struct _object *â€™} [-Wincompatible-pointer-types]
    167 |     PyCelprm* copy = PyCelprm_new(&PyCelprmType, NULL, NULL);
        |                      ^~~~~~~~~~~~
  In file included from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  astropy/wcs/src/wcslib_celprm_wrap.c: In function â€˜PyCelprm_set_refâ€™:
  astropy/wcs/src/wcslib_celprm_wrap.c:327:25: warning: passing argument 1 of â€˜PyArray_DIMSâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    327 |     size = PyArray_SIZE(value_array);
        |                         ^~~~~~~~~~~
        |                         |
        |                         PyObject * {aka struct _object *}
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:59: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                           ^
  In file included from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1487:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1487 | PyArray_DIMS(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  astropy/wcs/src/wcslib_celprm_wrap.c:327:25: warning: passing argument 1 of â€˜PyArray_NDIMâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    327 |     size = PyArray_SIZE(value_array);
        |                         ^~~~~~~~~~~
        |                         |
        |                         PyObject * {aka struct _object *}
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:76: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                                            ^
  In file included from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1469:35: note: expected â€˜const PyArrayObject *â€™ {aka â€˜const struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1469 | PyArray_NDIM(const PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~~~~~~~^~~
  astropy/wcs/src/wcslib_celprm_wrap.c:348:35: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    348 |     data = (double*) PyArray_DATA(value_array);
        |                                   ^~~~~~~~~~~
        |                                   |
        |                                   PyObject * {aka struct _object *}
  In file included from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_prjprm_wrap.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/wcslib_prjprm_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_deepcopyâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:149:22: warning: initialization of â€˜PyPrjprm *â€™ from incompatible pointer type â€˜PyObject *â€™ {aka â€˜struct _object *â€™} [-Wincompatible-pointer-types]
    149 |     PyPrjprm* copy = PyPrjprm_new(&PyPrjprmType, NULL, NULL);
        |                      ^~~~~~~~~~~~
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_get_pvâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:517:14: warning: assignment to â€˜PyObject *â€™ {aka â€˜struct _object *â€™} from incompatible pointer type â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} [-Wincompatible-pointer-types]
    517 |     pv_array = (PyArrayObject*) PyArray_SimpleNew(1, &size, NPY_DOUBLE);
        |              ^
  astropy/wcs/src/wcslib_prjprm_wrap.c:519:33: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    519 |     pv = (double*) PyArray_DATA(pv_array);
        |                                 ^~~~~~~~
        |                                 |
        |                                 PyObject * {aka struct _object *}
  In file included from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_set_pvâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:556:25: warning: passing argument 1 of â€˜PyArray_DIMSâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    556 |     size = PyArray_SIZE(value_array);
        |                         ^~~~~~~~~~~
        |                         |
        |                         PyObject * {aka struct _object *}
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:59: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                           ^
  In file included from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1487:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1487 | PyArray_DIMS(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c:556:25: warning: passing argument 1 of â€˜PyArray_NDIMâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    556 |     size = PyArray_SIZE(value_array);
        |                         ^~~~~~~~~~~
        |                         |
        |                         PyObject * {aka struct _object *}
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:76: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                                            ^
  In file included from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1469:35: note: expected â€˜const PyArrayObject *â€™ {aka â€˜const struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1469 | PyArray_NDIM(const PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~~~~~~~^~~
  astropy/wcs/src/wcslib_prjprm_wrap.c:583:35: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    583 |     data = (double*) PyArray_DATA(value_array);
        |                                   ^~~~~~~~~~~
        |                                   |
        |                                   PyObject * {aka struct _object *}
  In file included from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_get_pviâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:615:15: warning: unused variable â€˜valueâ€™ [-Wunused-variable]
    615 |     PyObject* value = NULL;
        |               ^~~~~
  In file included from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_set_pviâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:712:29: warning: passing argument 1 of â€˜PyArray_DIMSâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    712 |         size = PyArray_SIZE(value_array);
        |                             ^~~~~~~~~~~
        |                             |
        |                             PyObject * {aka struct _object *}
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:59: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                           ^
  In file included from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1487:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1487 | PyArray_DIMS(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c:712:29: warning: passing argument 1 of â€˜PyArray_NDIMâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    712 |         size = PyArray_SIZE(value_array);
        |                             ^~~~~~~~~~~
        |                             |
        |                             PyObject * {aka struct _object *}
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:76: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                                            ^
  In file included from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1469:35: note: expected â€˜const PyArrayObject *â€™ {aka â€˜const struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1469 | PyArray_NDIM(const PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c:720:48: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    720 |         scalar = PyArray_ToScalar(PyArray_DATA(value_array), value_array);
        |                                                ^~~~~~~~~~~
        |                                                |
        |                                                PyObject * {aka struct _object *}
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:129:24: note: in definition of macro â€˜PyArray_ToScalarâ€™
    129 |         PyArray_Scalar(data, PyArray_DESCR(arr), (PyObject *)arr)
        |                        ^~~~
  In file included from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c:720:62: warning: passing argument 1 of â€˜PyArray_DESCRâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    720 |         scalar = PyArray_ToScalar(PyArray_DATA(value_array), value_array);
        |                                                              ^~~~~~~~~~~
        |                                                              |
        |                                                              PyObject * {aka struct _object *}
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:129:44: note: in definition of macro â€˜PyArray_ToScalarâ€™
    129 |         PyArray_Scalar(data, PyArray_DESCR(arr), (PyObject *)arr)
        |                                            ^~~
  In file included from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1517:30: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1517 | PyArray_DESCR(PyArrayObject *arr)
        |               ~~~~~~~~~~~~~~~^~~
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_get_wâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:780:32: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    780 |     w = (double*) PyArray_DATA(w_array);
        |                                ^~~~~~~
        |                                |
        |                                PyObject * {aka struct _object *}
  In file included from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_tabprm_wrap.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/wcslib_tabprm_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_wrap.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/wcslib_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  astropy/wcs/src/wcslib_wrap.c: In function â€˜PyWcsprm_copyâ€™:
  astropy/wcs/src/wcslib_wrap.c:634:24: warning: unused variable â€˜wtb0â€™ [-Wunused-variable]
    634 |   struct wtbarr *wtb, *wtb0;
        |                        ^~~~
  astropy/wcs/src/wcslib_wrap.c:634:18: warning: unused variable â€˜wtbâ€™ [-Wunused-variable]
    634 |   struct wtbarr *wtb, *wtb0;
        |                  ^~~
  astropy/wcs/src/wcslib_wrap.c:633:38: warning: unused variable â€˜ndimâ€™ [-Wunused-variable]
    633 |   int           status, nelem, i, j, ndim;
        |                                      ^~~~
  astropy/wcs/src/wcslib_wrap.c:633:35: warning: unused variable â€˜jâ€™ [-Wunused-variable]
    633 |   int           status, nelem, i, j, ndim;
        |                                   ^
  astropy/wcs/src/wcslib_wrap.c:633:32: warning: unused variable â€˜iâ€™ [-Wunused-variable]
    633 |   int           status, nelem, i, j, ndim;
        |                                ^
  astropy/wcs/src/wcslib_wrap.c:633:25: warning: unused variable â€˜nelemâ€™ [-Wunused-variable]
    633 |   int           status, nelem, i, j, ndim;
        |                         ^~~~~
  In file included from /usr/include/string.h:535,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:30,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:13,
                   from astropy/wcs/include/astropy_wcs/wcslib_wrap.h:8,
                   from astropy/wcs/src/wcslib_wrap.c:8:
  In function â€˜strncpyâ€™,
      inlined from â€˜PyWcsprm_sptrâ€™ at astropy/wcs/src/wcslib_wrap.c:1757:3:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ specified bound 9 equals destination size [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_wtbarr_wrap.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/wcslib_wtbarr_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  astropy/wcs/src/wcslib_wtbarr_wrap.c:208:3: warning: initialization of â€˜int (*)(PyObject *, int (*)(PyObject *, void *), void *)â€™ {aka â€˜int (*)(struct _object *, int (*)(struct _object *, void *), void *)â€™} from incompatible pointer type â€˜int (*)(PyWtbarr *, int (*)(PyObject *, void *), void *)â€™ {aka â€˜int (*)(PyWtbarr *, int (*)(struct _object *, void *), void *)â€™} [-Wincompatible-pointer-types]
    208 |   PyWtbarr_traverse,            /* tp_traverse */
        |   ^~~~~~~~~~~~~~~~~
  astropy/wcs/src/wcslib_wtbarr_wrap.c:208:3: note: (near initialization for â€˜PyWtbarrType.tp_traverseâ€™)
  astropy/wcs/src/wcslib_wtbarr_wrap.c:209:3: warning: initialization of â€˜int (*)(PyObject *)â€™ {aka â€˜int (*)(struct _object *)â€™} from incompatible pointer type â€˜int (*)(PyWtbarr *)â€™ [-Wincompatible-pointer-types]
    209 |   PyWtbarr_clear,               /* tp_clear */
        |   ^~~~~~~~~~~~~~
  astropy/wcs/src/wcslib_wtbarr_wrap.c:209:3: note: (near initialization for â€˜PyWtbarrType.tp_clearâ€™)
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/cel.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/cel.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/dis.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/dis.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/flexed/wcsbth.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/flexed/wcsbth.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/flexed/wcspih.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/flexed/wcspih.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/flexed/wcsulex.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/flexed/wcsulex.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/flexed/wcsutrn.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/flexed/wcsutrn.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/lin.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/lin.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/log.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/log.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/prj.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/prj.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/spc.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/spc.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/sph.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/sph.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/spx.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/spx.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/tab.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/tab.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcs.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/wcs.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcserr.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/wcserr.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcsfix.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/wcsfix.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcshdr.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/wcshdr.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcsprintf.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/wcsprintf.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcsunits.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/wcsunits.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcsutil.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/wcsutil.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  creating /tmp/tmphxzey05s.build-lib/astropy/wcs
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/astropy_wcs.o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/astropy_wcs_api.o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/distortion.o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/distortion_wrap.o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/docstrings.o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/pipeline.o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/pyutil.o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/sip.o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/sip_wrap.o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/str_list_proxy.o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/unit_list_proxy.o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/util.o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/wcslib_auxprm_wrap.o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/wcslib_celprm_wrap.o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/wcslib_prjprm_wrap.o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/wcslib_tabprm_wrap.o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/wcslib_wrap.o /tmp/tmpaeyyc2s3.build-temp/astropy/wcs/src/wcslib_wtbarr_wrap.o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/cel.o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/dis.o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/flexed/wcsbth.o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/flexed/wcspih.o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/flexed/wcsulex.o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/flexed/wcsutrn.o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/lin.o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/log.o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/prj.o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/spc.o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/sph.o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/spx.o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/tab.o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/wcs.o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/wcserr.o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/wcsfix.o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/wcshdr.o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/wcsprintf.o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/wcsunits.o /tmp/tmpaeyyc2s3.build-temp/cextern/wcslib/C/wcsutil.o -o /tmp/tmphxzey05s.build-lib/astropy/wcs/_wcs.cpython-39-x86_64-linux-gnu.so
  building 'astropy.time._parse_times' extension
  creating /tmp/tmpaeyyc2s3.build-temp/astropy/time
  creating /tmp/tmpaeyyc2s3.build-temp/astropy/time/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/time/src/parse_times.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/time/src/parse_times.o
  creating /tmp/tmphxzey05s.build-lib/astropy/time
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpaeyyc2s3.build-temp/astropy/time/src/parse_times.o -o /tmp/tmphxzey05s.build-lib/astropy/time/_parse_times.cpython-39-x86_64-linux-gnu.so
  building 'astropy.convolution._convolve' extension
  creating /tmp/tmpaeyyc2s3.build-temp/astropy/convolution
  creating /tmp/tmpaeyyc2s3.build-temp/astropy/convolution/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/convolution/src/convolve.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/convolution/src/convolve.o -UNDEBUG -fPIC
  creating /tmp/tmphxzey05s.build-lib/astropy/convolution
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpaeyyc2s3.build-temp/astropy/convolution/src/convolve.o -o /tmp/tmphxzey05s.build-lib/astropy/convolution/_convolve.cpython-39-x86_64-linux-gnu.so
  building 'astropy.utils.xml._iterparser' extension
  creating /tmp/tmpaeyyc2s3.build-temp/astropy/utils/xml
  creating /tmp/tmpaeyyc2s3.build-temp/astropy/utils/xml/src
  creating /tmp/tmpaeyyc2s3.build-temp/cextern/expat
  creating /tmp/tmpaeyyc2s3.build-temp/cextern/expat/lib
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/utils/xml/src/iterparse.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/utils/xml/src/iterparse.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/expat/lib/xmlparse.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/expat/lib/xmlparse.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/expat/lib/xmlrole.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/expat/lib/xmlrole.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/expat/lib/xmltok.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/expat/lib/xmltok.o
  In file included from cextern/expat/lib/xmltok.c:55:
  cextern/expat/lib/xmltok_ns.c: In function â€˜findEncodingNSâ€™:
  cextern/expat/lib/xmltok.h:272:10: warning: â€˜bufâ€™ may be used uninitialized [-Wmaybe-uninitialized]
    272 |   (((enc)->utf8Convert)(enc, fromP, fromLim, toP, toLim))
        |   ~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/expat/lib/xmltok_ns.c:95:3: note: in expansion of macro â€˜XmlUtf8Convertâ€™
     95 |   XmlUtf8Convert(enc, &ptr, end, &p, p + ENCODING_MAX - 1);
        |   ^~~~~~~~~~~~~~
  cextern/expat/lib/xmltok.h:272:10: note: by argument 5 of type â€˜const char *â€™ to â€˜enum XML_Convert_Result(const ENCODING *, const char **, const char *, char **, const char *)â€™ {aka â€˜enum XML_Convert_Result(const struct encoding *, const char **, const char *, char **, const char *)â€™}
    272 |   (((enc)->utf8Convert)(enc, fromP, fromLim, toP, toLim))
        |   ~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/expat/lib/xmltok_ns.c:95:3: note: in expansion of macro â€˜XmlUtf8Convertâ€™
     95 |   XmlUtf8Convert(enc, &ptr, end, &p, p + ENCODING_MAX - 1);
        |   ^~~~~~~~~~~~~~
  In file included from cextern/expat/lib/xmltok.c:1657:
  cextern/expat/lib/xmltok_ns.c:92:8: note: â€˜bufâ€™ declared here
     92 |   char buf[ENCODING_MAX];
        |        ^~~
  In file included from cextern/expat/lib/xmltok.c:55:
  cextern/expat/lib/xmltok_ns.c: In function â€˜findEncodingâ€™:
  cextern/expat/lib/xmltok.h:272:10: warning: â€˜bufâ€™ may be used uninitialized [-Wmaybe-uninitialized]
    272 |   (((enc)->utf8Convert)(enc, fromP, fromLim, toP, toLim))
        |   ~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/expat/lib/xmltok_ns.c:95:3: note: in expansion of macro â€˜XmlUtf8Convertâ€™
     95 |   XmlUtf8Convert(enc, &ptr, end, &p, p + ENCODING_MAX - 1);
        |   ^~~~~~~~~~~~~~
  cextern/expat/lib/xmltok.h:272:10: note: by argument 5 of type â€˜const char *â€™ to â€˜enum XML_Convert_Result(const ENCODING *, const char **, const char *, char **, const char *)â€™ {aka â€˜enum XML_Convert_Result(const struct encoding *, const char **, const char *, char **, const char *)â€™}
    272 |   (((enc)->utf8Convert)(enc, fromP, fromLim, toP, toLim))
        |   ~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/expat/lib/xmltok_ns.c:95:3: note: in expansion of macro â€˜XmlUtf8Convertâ€™
     95 |   XmlUtf8Convert(enc, &ptr, end, &p, p + ENCODING_MAX - 1);
        |   ^~~~~~~~~~~~~~
  In file included from cextern/expat/lib/xmltok.c:1646:
  cextern/expat/lib/xmltok_ns.c:92:8: note: â€˜bufâ€™ declared here
     92 |   char buf[ENCODING_MAX];
        |        ^~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/expat/lib/xmltok_impl.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/expat/lib/xmltok_impl.o
  creating /tmp/tmphxzey05s.build-lib/astropy/utils/xml
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpaeyyc2s3.build-temp/astropy/utils/xml/src/iterparse.o /tmp/tmpaeyyc2s3.build-temp/cextern/expat/lib/xmlparse.o /tmp/tmpaeyyc2s3.build-temp/cextern/expat/lib/xmlrole.o /tmp/tmpaeyyc2s3.build-temp/cextern/expat/lib/xmltok.o /tmp/tmpaeyyc2s3.build-temp/cextern/expat/lib/xmltok_impl.o -o /tmp/tmphxzey05s.build-lib/astropy/utils/xml/_iterparser.cpython-39-x86_64-linux-gnu.so -Wl,--version-script=astropy/utils/xml/src/iterparse.map
  building 'astropy.io.votable.tablewriter' extension
  creating /tmp/tmpaeyyc2s3.build-temp/astropy/io
  creating /tmp/tmpaeyyc2s3.build-temp/astropy/io/votable
  creating /tmp/tmpaeyyc2s3.build-temp/astropy/io/votable/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -Iastropy/io/votable/src -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/io/votable/src/tablewriter.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/io/votable/src/tablewriter.o
  astropy/io/votable/src/tablewriter.c: In function â€˜write_tabledataâ€™:
  astropy/io/votable/src/tablewriter.c:270:30: warning: assignment discards â€˜constâ€™ qualifier from pointer target type [-Wdiscarded-qualifiers]
    270 |                 if ((str_tmp = PyUnicode_AsUTF8AndSize(str_val, &str_len)) == NULL) {
        |                              ^
  creating /tmp/tmphxzey05s.build-lib/astropy/io
  creating /tmp/tmphxzey05s.build-lib/astropy/io/votable
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpaeyyc2s3.build-temp/astropy/io/votable/src/tablewriter.o -o /tmp/tmphxzey05s.build-lib/astropy/io/votable/tablewriter.cpython-39-x86_64-linux-gnu.so
  building 'astropy.io.fits.compression' extension
  creating /tmp/tmpaeyyc2s3.build-temp/astropy/io/fits
  creating /tmp/tmpaeyyc2s3.build-temp/astropy/io/fits/src
  creating /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio
  creating /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib
  creating /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/zlib
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/io/fits/src/compressionmodule.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/io/fits/src/compressionmodule.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  astropy/io/fits/src/compressionmodule.c: In function â€˜compression_compress_hduâ€™:
  astropy/io/fits/src/compressionmodule.c:1042:16: warning: comparison of integer expressions of different signedness: â€˜npy_intpâ€™ {aka â€˜long intâ€™} and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
   1042 |     if (znaxis < outbufsize) {
        |                ^
  astropy/io/fits/src/compressionmodule.c: In function â€˜tcolumns_from_headerâ€™:
  astropy/io/fits/src/compressionmodule.c:446:32: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    446 |         snprintf(tkw, 9, "TTYPE%u", idx);
        |                                ^~
  astropy/io/fits/src/compressionmodule.c:446:26: note: directive argument in the range [1, 2147483647]
    446 |         snprintf(tkw, 9, "TTYPE%u", idx);
        |                          ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from astropy/io/fits/src/compressionmodule.c:96:
  In function â€˜strncpyâ€™,
      inlined from â€˜tcolumns_from_headerâ€™ at astropy/io/fits/src/compressionmodule.c:450:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 69 bytes from a string of length 71 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c: In function â€˜tcolumns_from_headerâ€™:
  astropy/io/fits/src/compressionmodule.c:453:32: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    453 |         snprintf(tkw, 9, "TFORM%u", idx);
        |                                ^~
  astropy/io/fits/src/compressionmodule.c:453:26: note: directive argument in the range [1, 2147483647]
    453 |         snprintf(tkw, 9, "TFORM%u", idx);
        |                          ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from astropy/io/fits/src/compressionmodule.c:96:
  In function â€˜strncpyâ€™,
      inlined from â€˜tcolumns_from_headerâ€™ at astropy/io/fits/src/compressionmodule.c:457:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 9 bytes from a string of length 71 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c: In function â€˜tcolumns_from_headerâ€™:
  astropy/io/fits/src/compressionmodule.c:469:32: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    469 |         snprintf(tkw, 9, "TSCAL%u", idx);
        |                                ^~
  astropy/io/fits/src/compressionmodule.c:469:26: note: directive argument in the range [1, 2147483647]
    469 |         snprintf(tkw, 9, "TSCAL%u", idx);
        |                          ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c:474:32: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    474 |         snprintf(tkw, 9, "TZERO%u", idx);
        |                                ^~
  astropy/io/fits/src/compressionmodule.c:474:26: note: directive argument in the range [1, 2147483647]
    474 |         snprintf(tkw, 9, "TZERO%u", idx);
        |                          ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c:479:32: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    479 |         snprintf(tkw, 9, "TNULL%u", idx);
        |                                ^~
  astropy/io/fits/src/compressionmodule.c:479:26: note: directive argument in the range [1, 2147483647]
    479 |         snprintf(tkw, 9, "TNULL%u", idx);
        |                          ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from astropy/io/fits/src/compressionmodule.c:96:
  In function â€˜strncpyâ€™,
      inlined from â€˜configure_compressionâ€™ at astropy/io/fits/src/compressionmodule.c:600:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 11 bytes from a string of length 71 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c: In function â€˜configure_compressionâ€™:
  astropy/io/fits/src/compressionmodule.c:643:36: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    643 |         snprintf(keyword, 9, "ZNAME%u", idx);
        |                                    ^~
  astropy/io/fits/src/compressionmodule.c:643:30: note: directive argument in the range [1, 2147483647]
    643 |         snprintf(keyword, 9, "ZNAME%u", idx);
        |                              ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c:654:35: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 5 [-Wformat-truncation=]
    654 |         snprintf(keyword, 9, "ZVAL%u", idx);
        |                                   ^~
  astropy/io/fits/src/compressionmodule.c:654:30: note: directive argument in the range [1, 2147483647]
    654 |         snprintf(keyword, 9, "ZVAL%u", idx);
        |                              ^~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 6 and 15 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c: In function â€˜init_output_bufferâ€™:
  astropy/io/fits/src/compressionmodule.c:776:36: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    776 |         snprintf(keyword, 9, "ZTILE%u", idx);
        |                                    ^~
  astropy/io/fits/src/compressionmodule.c:776:30: note: directive argument in the range [1, 2147483647]
    776 |         snprintf(keyword, 9, "ZTILE%u", idx);
        |                              ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/buffers.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/buffers.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/cfileio.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/cfileio.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/cfileio.c:7:
  In function â€˜strncpyâ€™,
      inlined from â€˜ffoptpltâ€™ at cextern/cfitsio/lib/cfileio.c:7788:7:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 30 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_is_this_a_copyâ€™ at cextern/cfitsio/lib/cfileio.c:1711:13,
      inlined from â€˜fits_is_this_a_copyâ€™ at cextern/cfitsio/lib/cfileio.c:1693:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 5 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/cfileio.c: In function â€˜ffomemâ€™:
  cextern/cfitsio/lib/cfileio.c:339:38: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 55 [-Wformat-truncation=]
    339 |           " extension with EXTNAME = %s,", extname);
        |                                      ^~    ~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/cfileio.c:13:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 28 and 98 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/cfileio.c: In function â€˜ffopenâ€™:
  cextern/cfitsio/lib/cfileio.c:971:38: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 55 [-Wformat-truncation=]
    971 |           " extension with EXTNAME = %s,", extname);
        |                                      ^~    ~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/cfileio.c:13:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 28 and 98 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/checksum.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/checksum.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/drvrfile.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/drvrfile.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/drvrmem.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/drvrmem.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/drvrmem.c: In function â€˜mem_truncateâ€™:
  cextern/cfitsio/lib/drvrmem.c:273:23: warning: comparison of integer expressions of different signedness: â€˜LONGLONGâ€™ {aka â€˜long long intâ€™} and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
    273 |         if ( filesize > *(memTable[handle].memsizeptr) )
        |                       ^
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/drvrnet.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/drvrnet.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/drvrsmem.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/drvrsmem.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/editcol.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/editcol.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/editcol.c:8:
  In function â€˜strncpyâ€™,
      inlined from â€˜ffkshfâ€™ at cextern/cfitsio/lib/editcol.c:2849:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 8 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜ffkshfâ€™ at cextern/cfitsio/lib/editcol.c:2809:13:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 4 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffkshfâ€™ at cextern/cfitsio/lib/editcol.c:2844:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output may be truncated copying between 4 and 5 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜ffkshfâ€™ at cextern/cfitsio/lib/editcol.c:2851:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin___strncpy_chkâ€™ output truncated before terminating nul copying as many bytes from a string as its length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/editcol.c: In function â€˜ffkshfâ€™:
  cextern/cfitsio/lib/editcol.c:2850:24: note: length computed here
   2850 |                   i1 = strlen(newkey);
        |                        ^~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/edithdu.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/edithdu.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/eval_f.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/eval_f.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/eval_l.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/eval_l.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/eval_y.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/eval_y.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/fits_hcompress.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/fits_hcompress.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/fits_hdecompress.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/fits_hdecompress.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/fitscore.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/fitscore.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffmkkyâ€™:
  cextern/cfitsio/lib/fitscore.c:1118:30: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
   1118 |             if (strlen(cptr) > maxlen) maxlen = strlen(cptr); /* find longest token */
        |                              ^
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffmkeyâ€™:
  cextern/cfitsio/lib/fitscore.c:1295:19: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
   1295 |     for (ii=0; ii < keylength; ii++)       /* make sure keyword name is uppercase */
        |                   ^
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/fitscore.c:37:
  In function â€˜strncatâ€™,
      inlined from â€˜ffmkkyâ€™ at cextern/cfitsio/lib/fitscore.c:1115:8:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output may be truncated copying 74 bytes from a string of length 74 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffmkkyâ€™ at cextern/cfitsio/lib/fitscore.c:1159:13:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying 74 bytes from a string of length 74 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffbinit.part.0â€™:
  cextern/cfitsio/lib/fitscore.c:5098:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 72 [-Wformat-truncation=]
   5098 |             snprintf(message,FLEN_ERRMSG,"Required %s keyword not found (ffbinit).", name);
        |                                                    ^~                                ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 39 and 113 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffainit.part.0â€™:
  cextern/cfitsio/lib/fitscore.c:4901:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 72 [-Wformat-truncation=]
   4901 |             snprintf(message,FLEN_ERRMSG,"Value of %s keyword out of range: %ld (ffainit).",
        |                                                    ^~
   4902 |             name, (long) tbcoln);
        |             ~~~~
  cextern/cfitsio/lib/fitscore.c:4901:42: note: using the range [-9223372036854775808, 9223372036854775807] for directive argument
   4901 |             snprintf(message,FLEN_ERRMSG,"Value of %s keyword out of range: %ld (ffainit).",
        |                                          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 45 and 138 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c:4892:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 72 [-Wformat-truncation=]
   4892 |             snprintf(message,FLEN_ERRMSG,"Required %s keyword not found (ffainit).", name);
        |                                                    ^~                                ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 39 and 113 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c:4884:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 72 [-Wformat-truncation=]
   4884 |             snprintf(message,FLEN_ERRMSG,"Required %s keyword not found (ffainit).", name);
        |                                                    ^~                                ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 39 and 113 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c: In function â€˜fftheapâ€™:
  cextern/cfitsio/lib/fitscore.c:6083:75: warning: â€˜__builtin___snprintf_chkâ€™ output may be truncated before the last format character [-Wformat-truncation=]
   6083 |                 "Descriptor in row %ld, column %d has invalid heap address",
        |                                                                           ^
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 55 and 82 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffcmphâ€™:
  cextern/cfitsio/lib/fitscore.c:6221:69: warning: â€˜ blocks.â€™ directive output may be truncated writing 8 bytes into a region of size between 7 and 23 [-Wformat-truncation=]
   6221 |        "Failed to extend the size of the variable length heap by %ld blocks.",
        |                                                                     ^~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 67 and 83 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffgcprllâ€™:
  cextern/cfitsio/lib/fitscore.c:5959:69: warning: â€˜ blocks.â€™ directive output may be truncated writing 8 bytes into a region of size between 7 and 23 [-Wformat-truncation=]
   5959 |        "Failed to extend the size of the variable length heap by %ld blocks.",
        |                                                                     ^~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 67 and 83 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c:5761:76: warning: â€˜__builtin___snprintf_chkâ€™ output may be truncated before the last format character [-Wformat-truncation=]
   5761 |         "First element to write is too large: %ld; max allowed value is %ld",
        |                                                                            ^
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 63 and 101 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcol.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getcol.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcolb.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getcolb.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcold.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getcold.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcole.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getcole.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcoli.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getcoli.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcolj.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getcolj.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcolk.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getcolk.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcoll.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getcoll.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcols.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getcols.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/getcols.c:9:
  In function â€˜strncatâ€™,
      inlined from â€˜ffgclsâ€™ at cextern/cfitsio/lib/getcols.c:442:15:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying 20 bytes from a string of length 399 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgclsâ€™ at cextern/cfitsio/lib/getcols.c:423:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying between 0 and 78 bytes from a string of length 79 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgclsâ€™ at cextern/cfitsio/lib/getcols.c:384:15:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying 20 bytes from a string of length 399 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgclsâ€™ at cextern/cfitsio/lib/getcols.c:365:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying between 0 and 78 bytes from a string of length 79 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgclsâ€™ at cextern/cfitsio/lib/getcols.c:587:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying between 0 and 78 bytes from a string of length 79 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcolsb.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getcolsb.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcolui.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getcolui.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcoluj.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getcoluj.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/getcoluj.c: In function â€˜fffi8u4â€™:
  cextern/cfitsio/lib/getcoluj.c:1331:36: warning: comparison of integer expressions of different signedness: â€˜LONGLONGâ€™ {aka â€˜long long intâ€™} and â€˜long unsigned intâ€™ [-Wsign-compare]
   1331 |                 else if (input[ii] > ULONG_MAX)
        |                                    ^
  cextern/cfitsio/lib/getcoluj.c:1414:40: warning: comparison of integer expressions of different signedness: â€˜LONGLONGâ€™ {aka â€˜long long intâ€™} and â€˜long unsigned intâ€™ [-Wsign-compare]
   1414 |                     else if (input[ii] > ULONG_MAX)
        |                                        ^
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcoluk.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getcoluk.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getkey.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getkey.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/getkey.c: In function â€˜ffgskyâ€™:
  cextern/cfitsio/lib/getkey.c:1080:23: warning: comparison of integer expressions of different signedness: â€˜intâ€™ and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
   1080 |         if (firstchar <= len)
        |                       ^~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/getkey.c:8:
  In function â€˜strncpyâ€™,
      inlined from â€˜ffgcntâ€™ at cextern/cfitsio/lib/getkey.c:1134:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated copying 10 bytes from a string of length 11 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c: In function â€˜ffgphd.part.0â€™:
  cextern/cfitsio/lib/getkey.c:2855:62: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 33 [-Wformat-truncation=]
   2855 |             "First keyword of the extension is not XTENSION: %s", name);
        |                                                              ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 123 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2847:53: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 49 [-Wformat-truncation=]
   2847 |                    "This is not an IMAGE extension: %s", value);
        |                                                     ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 33 and 103 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2821:62: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 40 [-Wformat-truncation=]
   2821 |                    "First keyword of the file is not SIMPLE: %s", name);
        |                                                              ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 42 and 116 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2930:48: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 47 [-Wformat-truncation=]
   2930 |             "Illegal value for BITPIX keyword: %s", value);
        |                                                ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 35 and 105 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2921:57: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 38 [-Wformat-truncation=]
   2921 |             "Value of BITPIX keyword is not an integer: %s", value);
        |                                                         ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 44 and 114 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2913:61: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 34 [-Wformat-truncation=]
   2913 |             "Second keyword of the extension is not BITPIX: %s", name);
        |                                                             ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 48 and 122 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3021:70: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size between 19 and 28 [-Wformat-truncation=]
   3021 |               "Name of keyword no. %d contains illegal character(s): %s",
        |                                                                      ^~
   3022 |               nextkey, name);
        |                        ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 54 and 137 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3118:67: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 32 [-Wformat-truncation=]
   3118 |                 "Error reading EXTEND keyword value as a logical: %s", value);
        |                                                                   ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 50 and 120 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3101:68: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 31 [-Wformat-truncation=]
   3101 |                 "Error reading GCOUNT keyword value as an integer: %s", value);
        |                                                                    ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 51 and 121 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3088:68: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 31 [-Wformat-truncation=]
   3088 |                 "Error reading PCOUNT keyword value as an integer: %s", value);
        |                                                                    ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 51 and 121 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3075:67: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 32 [-Wformat-truncation=]
   3075 |                 "Error reading BLANK keyword value as an integer: %s", value);
        |                                                                   ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 50 and 120 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3058:65: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 34 [-Wformat-truncation=]
   3058 |                 "Error reading BZERO keyword value as a double: %s", value);
        |                                                                 ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 48 and 118 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3041:66: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 33 [-Wformat-truncation=]
   3041 |                 "Error reading BSCALE keyword value as a double: %s", value);
        |                                                                  ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 119 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c: In function â€˜ffghtbâ€™:
  cextern/cfitsio/lib/getkey.c:2282:58: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 33 [-Wformat-truncation=]
   2282 |         "First keyword of the extension is not XTENSION: %s", name);
        |                                                          ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 123 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2273:49: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 50 [-Wformat-truncation=]
   2273 |                 "This is not a TABLE extension: %s", value);
        |                                                 ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 32 and 102 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c: In function â€˜ffghtbllâ€™:
  cextern/cfitsio/lib/getkey.c:2425:58: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 33 [-Wformat-truncation=]
   2425 |         "First keyword of the extension is not XTENSION: %s", name);
        |                                                          ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 123 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2416:49: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 50 [-Wformat-truncation=]
   2416 |                 "This is not a TABLE extension: %s", value);
        |                                                 ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 32 and 102 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c: In function â€˜ffghbnâ€™:
  cextern/cfitsio/lib/getkey.c:2570:58: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 33 [-Wformat-truncation=]
   2570 |         "First keyword of the extension is not XTENSION: %s", name);
        |                                                          ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 123 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2561:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 47 [-Wformat-truncation=]
   2561 |                 "This is not a BINTABLE extension: %s", value);
        |                                                    ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 35 and 105 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c: In function â€˜ffghbnllâ€™:
  cextern/cfitsio/lib/getkey.c:2693:58: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 33 [-Wformat-truncation=]
   2693 |         "First keyword of the extension is not XTENSION: %s", name);
        |                                                          ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 123 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2684:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 47 [-Wformat-truncation=]
   2684 |                 "This is not a BINTABLE extension: %s", value);
        |                                                    ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 35 and 105 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/group.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/group.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/group.c: In function â€˜ffgmopâ€™:
  cextern/cfitsio/lib/group.c:2290:62: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 39 [-Wformat-truncation=]
   2290 |                   "Cannot open member HDU file with URI type %s (ffgmop)",
        |                                                              ^~
   2291 |                           uri);
        |                           ~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/group.c:17:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 52 and 122 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/grparser.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/grparser.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/histo.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/histo.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/imcompress.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/imcompress.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/imcompress.c: In function â€˜imcomp_decompress_tileâ€™:
  cextern/cfitsio/lib/imcompress.c:6072:30: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
   6072 |             if (tilebytesize == 4 * tilelen) {  /* float pixels */
        |                              ^~
  cextern/cfitsio/lib/imcompress.c:6103:37: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
   6103 |             } else if (tilebytesize == 8 * tilelen) { /* double pixels */
        |                                     ^~
  cextern/cfitsio/lib/imcompress.c: In function â€˜fits_compress_tableâ€™:
  cextern/cfitsio/lib/imcompress.c:8517:30: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜LONGLONGâ€™ {aka â€˜long long intâ€™} [-Wsign-compare]
   8517 |                     if (dlen < vlamemlen) {
        |                              ^
  cextern/cfitsio/lib/imcompress.c: In function â€˜fits_uncompress_tableâ€™:
  cextern/cfitsio/lib/imcompress.c:9258:39: warning: comparison of integer expressions of different signedness: â€˜LONGLONGâ€™ {aka â€˜long long intâ€™} and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
   9258 |                         if (cvlalen   == vlamemlen ) {
        |                                       ^~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/imcompress.c:3:
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_compress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8170:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_compress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8174:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_compress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8178:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_uncompress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8803:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_uncompress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8807:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_uncompress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8811:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜imcomp_get_compressed_image_parâ€™ at cextern/cfitsio/lib/imcompress.c:5271:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output may be truncated copying 11 bytes from a string of length 70 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜fits_compress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8671:6:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying between 0 and 29 bytes from a string of length 70 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜fits_compress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8544:3:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying between 0 and 29 bytes from a string of length 70 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/iraffits.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/iraffits.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofitsâ€™ at cextern/cfitsio/lib/iraffits.c:576:11:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 3 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofitsâ€™ at cextern/cfitsio/lib/iraffits.c:889:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 3 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcomâ€™ at cextern/cfitsio/lib/iraffits.c:2088:6:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 2 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcâ€™ at cextern/cfitsio/lib/iraffits.c:1930:2:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying as many bytes from a string as its length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/iraffits.c: In function â€˜hputcâ€™:
  cextern/cfitsio/lib/iraffits.c:1909:12: note: length computed here
   1909 |     lval = strlen (value);
        |            ^~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcâ€™ at cextern/cfitsio/lib/iraffits.c:1992:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying as many bytes from a string as its length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/iraffits.c: In function â€˜hputcâ€™:
  cextern/cfitsio/lib/iraffits.c:1908:16: note: length computed here
   1908 |     lkeyword = strlen (keyword);
        |                ^~~~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcâ€™ at cextern/cfitsio/lib/iraffits.c:2009:2:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying as many bytes from a string as its length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/iraffits.c: In function â€˜hputcâ€™:
  cextern/cfitsio/lib/iraffits.c:1909:12: note: length computed here
   1909 |     lval = strlen (value);
        |            ^~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcâ€™ at cextern/cfitsio/lib/iraffits.c:2001:2:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying as many bytes from a string as its length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/iraffits.c: In function â€˜hputcâ€™:
  cextern/cfitsio/lib/iraffits.c:1909:12: note: length computed here
   1909 |     lval = strlen (value);
        |            ^~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcâ€™ at cextern/cfitsio/lib/iraffits.c:2020:6:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying between 0 and 49 bytes from a string of length 49 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜hputsâ€™ at cextern/cfitsio/lib/iraffits.c:1875:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin___strncpy_chkâ€™ specified bound depends on the length of the source argument [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/iraffits.c: In function â€˜hputsâ€™:
  cextern/cfitsio/lib/iraffits.c:1869:13: note: length computed here
   1869 |     lcval = strlen (cval);
        |             ^~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:624:11:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:864:10:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:853:13:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:823:10:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:811:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:880:11:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/modkey.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/modkey.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/modkey.c:8:
  In function â€˜strncpyâ€™,
      inlined from â€˜ffiklsâ€™ at cextern/cfitsio/lib/modkey.c:1282:12:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated copying 2 bytes from a string of length 3 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜ffmklsâ€™ at cextern/cfitsio/lib/modkey.c:783:12:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated copying 2 bytes from a string of length 3 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffpuntâ€™ at cextern/cfitsio/lib/modkey.c:567:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output may be truncated copying between 0 and 72 bytes from a string of length 72 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffpuntâ€™ at cextern/cfitsio/lib/modkey.c:562:13:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output may be truncated copying between 0 and 72 bytes from a string of length 72 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/pliocomp.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/pliocomp.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcol.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcol.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolb.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcolb.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcold.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcold.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcole.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcole.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcoli.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcoli.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolj.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcolj.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolk.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcolk.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcoll.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcoll.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcols.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcols.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolsb.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcolsb.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolu.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcolu.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolui.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcolui.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcoluj.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcoluj.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcoluk.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcoluk.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putkey.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putkey.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/putkey.c: In function â€˜ffprecâ€™:
  cextern/cfitsio/lib/putkey.c:326:19: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
    326 |     for (ii=0; ii < keylength; ii++)       /* make sure keyword name is uppercase */
        |                   ^
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/putkey.c:8:
  In function â€˜strncpyâ€™,
      inlined from â€˜ffpklsâ€™ at cextern/cfitsio/lib/putkey.c:483:12:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated copying 2 bytes from a string of length 3 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/quantize.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/quantize.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/region.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/region.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/region.c:988:1: warning: "/*" within comment [-Wcomment]
    988 | /*---------------------------------------------------------------------------*/
        |
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/ricecomp.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/ricecomp.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/scalnull.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/scalnull.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/simplerng.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/simplerng.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/swapproc.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/swapproc.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/swapproc.c: In function â€˜ffswap2â€™:
  cextern/cfitsio/lib/swapproc.c:87:24: warning: comparison of integer expressions of different signedness: â€˜long intâ€™ and â€˜long unsigned intâ€™ [-Wsign-compare]
     87 |     for (ii = peel; ii < (nvals - peel - (nvals - peel) % 8); ii+=8) {
        |                        ^
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/wcssub.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/wcssub.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/wcssub.c:3:
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:847:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:852:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:858:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:889:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:898:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:907:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:916:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:925:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:934:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:945:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:1040:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 77 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/wcsutil.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/wcsutil.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/zcompress.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/zcompress.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/zcompress.c: In function â€˜uncompress2fileâ€™:
  cextern/cfitsio/lib/zcompress.c:347:13: warning: comparison of integer expressions of different signedness: â€˜intâ€™ and â€˜long unsigned intâ€™ [-Wsign-compare]
    347 |             != (d_stream.total_out - bytes_out)) {
        |             ^~
  cextern/cfitsio/lib/zcompress.c: In function â€˜compress2file_from_memâ€™:
  cextern/cfitsio/lib/zcompress.c:515:13: warning: comparison of integer expressions of different signedness: â€˜intâ€™ and â€˜long unsigned intâ€™ [-Wsign-compare]
    515 |             != (c_stream.total_out - bytes_out)) {
        |             ^~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/zuncompress.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/zuncompress.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/zuncompress.c: In function â€˜write_bufâ€™:
  cextern/cfitsio/lib/zuncompress.c:581:27: warning: comparison of integer expressions of different signedness: â€˜long intâ€™ and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
    581 |       if (bytes_out + cnt > *memsize)
        |                           ^
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/adler32.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/zlib/adler32.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/crc32.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/zlib/crc32.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/deflate.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/zlib/deflate.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/infback.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/zlib/infback.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/inffast.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/zlib/inffast.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/inflate.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/zlib/inflate.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/inftrees.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/zlib/inftrees.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/trees.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/zlib/trees.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/uncompr.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/zlib/uncompr.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/zutil.c -o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/zlib/zutil.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  creating /tmp/tmphxzey05s.build-lib/astropy/io/fits
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpaeyyc2s3.build-temp/astropy/io/fits/src/compressionmodule.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/buffers.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/cfileio.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/checksum.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/drvrfile.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/drvrmem.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/drvrnet.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/drvrsmem.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/editcol.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/edithdu.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/eval_f.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/eval_l.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/eval_y.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/fits_hcompress.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/fits_hdecompress.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/fitscore.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getcol.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getcolb.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getcold.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getcole.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getcoli.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getcolj.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getcolk.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getcoll.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getcols.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getcolsb.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getcolui.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getcoluj.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getcoluk.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/getkey.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/group.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/grparser.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/histo.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/imcompress.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/iraffits.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/modkey.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/pliocomp.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcol.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcolb.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcold.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcole.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcoli.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcolj.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcolk.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcoll.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcols.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcolsb.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcolu.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcolui.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcoluj.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putcoluk.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/putkey.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/quantize.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/region.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/ricecomp.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/scalnull.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/simplerng.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/swapproc.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/wcssub.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/wcsutil.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/zcompress.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/lib/zuncompress.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/zlib/adler32.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/zlib/crc32.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/zlib/deflate.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/zlib/infback.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/zlib/inffast.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/zlib/inflate.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/zlib/inftrees.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/zlib/trees.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/zlib/uncompr.o /tmp/tmpaeyyc2s3.build-temp/cextern/cfitsio/zlib/zutil.o -o /tmp/tmphxzey05s.build-lib/astropy/io/fits/compression.cpython-39-x86_64-linux-gnu.so
  building 'astropy.io.ascii.cparser' extension
  creating /tmp/tmpaeyyc2s3.build-temp/astropy/io/ascii
  creating /tmp/tmpaeyyc2s3.build-temp/astropy/io/ascii/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/io/ascii/cparser.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/io/ascii/cparser.o
  In file included from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/io/ascii/cparser.c:610:
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/io/ascii/src/tokenizer.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/io/ascii/src/tokenizer.o
  astropy/io/ascii/src/tokenizer.c: In function â€˜pushâ€™:
  astropy/io/ascii/src/tokenizer.c:124:54: warning: comparison of integer expressions of different signedness: â€˜long intâ€™ and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
    124 |     if (self->col_ptrs[col] - self->output_cols[col] >=
        |                                                      ^~
  astropy/io/ascii/src/tokenizer.c: In function â€˜tokenizeâ€™:
  astropy/io/ascii/src/tokenizer.c:424:42: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
    424 |                     if (self->source_pos == -1
        |                                          ^~
  astropy/io/ascii/src/tokenizer.c:360:9: warning: enumeration value â€˜QUOTED_FIELD_NEWLINEâ€™ not handled in switch [-Wswitch]
    360 |         switch (self->state)
        |         ^~~~~~
  creating /tmp/tmphxzey05s.build-lib/astropy/io/ascii
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpaeyyc2s3.build-temp/astropy/io/ascii/cparser.o /tmp/tmpaeyyc2s3.build-temp/astropy/io/ascii/src/tokenizer.o -o /tmp/tmphxzey05s.build-lib/astropy/io/ascii/cparser.cpython-39-x86_64-linux-gnu.so
  building 'astropy.timeseries.periodograms.bls._impl' extension
  creating /tmp/tmpaeyyc2s3.build-temp/astropy/timeseries
  creating /tmp/tmpaeyyc2s3.build-temp/astropy/timeseries/periodograms
  creating /tmp/tmpaeyyc2s3.build-temp/astropy/timeseries/periodograms/bls
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/timeseries/periodograms/bls/_impl.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/timeseries/periodograms/bls/_impl.o
  In file included from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/timeseries/periodograms/bls/_impl.c:610:
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/timeseries/periodograms/bls/bls.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/timeseries/periodograms/bls/bls.o
  astropy/timeseries/periodograms/bls/bls.c: In function â€˜run_blsâ€™:
  astropy/timeseries/periodograms/bls/bls.c:92: warning: ignoring â€˜#pragma omp parallelâ€™ [-Wunknown-pragmas]
     92 | #pragma omp parallel
        |
  astropy/timeseries/periodograms/bls/bls.c:116: warning: ignoring â€˜#pragma omp parallelâ€™ [-Wunknown-pragmas]
    116 |     #pragma omp parallel for reduction(+:sum_y), reduction(+:sum_ivar)
        |
  astropy/timeseries/periodograms/bls/bls.c:125: warning: ignoring â€˜#pragma omp parallelâ€™ [-Wunknown-pragmas]
    125 |     #pragma omp parallel for
        |
  creating /tmp/tmphxzey05s.build-lib/astropy/timeseries
  creating /tmp/tmphxzey05s.build-lib/astropy/timeseries/periodograms
  creating /tmp/tmphxzey05s.build-lib/astropy/timeseries/periodograms/bls
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpaeyyc2s3.build-temp/astropy/timeseries/periodograms/bls/_impl.o /tmp/tmpaeyyc2s3.build-temp/astropy/timeseries/periodograms/bls/bls.o -o /tmp/tmphxzey05s.build-lib/astropy/timeseries/periodograms/bls/_impl.cpython-39-x86_64-linux-gnu.so
  building 'astropy.stats._stats' extension
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c ./astropy/stats/_stats.c -o /tmp/tmpaeyyc2s3.build-temp/./astropy/stats/_stats.o
  In file included from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from ./astropy/stats/_stats.c:611:
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpaeyyc2s3.build-temp/./astropy/stats/_stats.o -o /tmp/tmphxzey05s.build-lib/astropy/stats/_stats.cpython-39-x86_64-linux-gnu.so
  building 'astropy.io.fits._utils' extension
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c ./astropy/io/fits/_utils.c -o /tmp/tmpaeyyc2s3.build-temp/./astropy/io/fits/_utils.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpaeyyc2s3.build-temp/./astropy/io/fits/_utils.o -o /tmp/tmphxzey05s.build-lib/astropy/io/fits/_utils.cpython-39-x86_64-linux-gnu.so
  building 'astropy.cosmology.flrw.scalar_inv_efuncs' extension
  creating /tmp/tmpaeyyc2s3.build-temp/astropy/cosmology
  creating /tmp/tmpaeyyc2s3.build-temp/astropy/cosmology/flrw
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c ./astropy/cosmology/flrw/scalar_inv_efuncs.c -o /tmp/tmpaeyyc2s3.build-temp/./astropy/cosmology/flrw/scalar_inv_efuncs.o
  ./astropy/cosmology/flrw/scalar_inv_efuncs.c: In function â€˜__pyx_f_7astropy_9cosmology_4flrw_17scalar_inv_efuncs_nufuncâ€™:
  ./astropy/cosmology/flrw/scalar_inv_efuncs.c:6281:33: warning: comparison of integer expressions of different signedness: â€˜unsigned intâ€™ and â€˜intâ€™ [-Wsign-compare]
   6281 |   for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
        |                                 ^
  creating /tmp/tmphxzey05s.build-lib/astropy/cosmology
  creating /tmp/tmphxzey05s.build-lib/astropy/cosmology/flrw
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpaeyyc2s3.build-temp/./astropy/cosmology/flrw/scalar_inv_efuncs.o -o /tmp/tmphxzey05s.build-lib/astropy/cosmology/flrw/scalar_inv_efuncs.cpython-39-x86_64-linux-gnu.so
  building 'astropy.timeseries.periodograms.lombscargle.implementations.cython_impl' extension
  creating /tmp/tmpaeyyc2s3.build-temp/astropy/timeseries/periodograms/lombscargle
  creating /tmp/tmpaeyyc2s3.build-temp/astropy/timeseries/periodograms/lombscargle/implementations
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c ./astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.c -o /tmp/tmpaeyyc2s3.build-temp/./astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.o
  In file included from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from ./astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.c:610:
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  creating /tmp/tmphxzey05s.build-lib/astropy/timeseries/periodograms/lombscargle
  creating /tmp/tmphxzey05s.build-lib/astropy/timeseries/periodograms/lombscargle/implementations
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpaeyyc2s3.build-temp/./astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.o -o /tmp/tmphxzey05s.build-lib/astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.cpython-39-x86_64-linux-gnu.so
  building 'astropy.compiler_version' extension
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/_compiler.c -o /tmp/tmpaeyyc2s3.build-temp/astropy/_compiler.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpaeyyc2s3.build-temp/astropy/_compiler.o -o /tmp/tmphxzey05s.build-lib/astropy/compiler_version.cpython-39-x86_64-linux-gnu.so
  copying /tmp/tmphxzey05s.build-lib/astropy/stats/_fast_sigma_clip.cpython-39-x86_64-linux-gnu.so -> astropy/stats
  copying /tmp/tmphxzey05s.build-lib/astropy/table/_np_utils.cpython-39-x86_64-linux-gnu.so -> astropy/table
  copying /tmp/tmphxzey05s.build-lib/astropy/table/_column_mixins.cpython-39-x86_64-linux-gnu.so -> astropy/table
  copying /tmp/tmphxzey05s.build-lib/astropy/utils/_compiler.cpython-39-x86_64-linux-gnu.so -> astropy/utils
  copying /tmp/tmphxzey05s.build-lib/astropy/wcs/_wcs.cpython-39-x86_64-linux-gnu.so -> astropy/wcs
  copying /tmp/tmphxzey05s.build-lib/astropy/time/_parse_times.cpython-39-x86_64-linux-gnu.so -> astropy/time
  copying /tmp/tmphxzey05s.build-lib/astropy/convolution/_convolve.cpython-39-x86_64-linux-gnu.so -> astropy/convolution
  copying /tmp/tmphxzey05s.build-lib/astropy/utils/xml/_iterparser.cpython-39-x86_64-linux-gnu.so -> astropy/utils/xml
  copying /tmp/tmphxzey05s.build-lib/astropy/io/votable/tablewriter.cpython-39-x86_64-linux-gnu.so -> astropy/io/votable
  copying /tmp/tmphxzey05s.build-lib/astropy/io/fits/compression.cpython-39-x86_64-linux-gnu.so -> astropy/io/fits
  copying /tmp/tmphxzey05s.build-lib/astropy/io/ascii/cparser.cpython-39-x86_64-linux-gnu.so -> astropy/io/ascii
  copying /tmp/tmphxzey05s.build-lib/astropy/timeseries/periodograms/bls/_impl.cpython-39-x86_64-linux-gnu.so -> astropy/timeseries/periodograms/bls
  copying /tmp/tmphxzey05s.build-lib/astropy/stats/_stats.cpython-39-x86_64-linux-gnu.so -> astropy/stats
  copying /tmp/tmphxzey05s.build-lib/astropy/io/fits/_utils.cpython-39-x86_64-linux-gnu.so -> astropy/io/fits
  copying /tmp/tmphxzey05s.build-lib/astropy/cosmology/flrw/scalar_inv_efuncs.cpython-39-x86_64-linux-gnu.so -> astropy/cosmology/flrw
  copying /tmp/tmphxzey05s.build-lib/astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.cpython-39-x86_64-linux-gnu.so -> astropy/timeseries/periodograms/lombscargle/implementations
  copying /tmp/tmphxzey05s.build-lib/astropy/compiler_version.cpython-39-x86_64-linux-gnu.so -> astropy
  Editable install will be performed using a meta path finder.

  Options like `package-data`, `include/exclude-package-data` or
  `packages.find.exclude/include` may have no effect.

  adding '__editable___astropy_5_2_dev64_g6ed769d58_d20251003_finder.py'
  adding '__editable__.astropy-5.2.dev64+g6ed769d58.d20251003.pth'
  creating '/tmp/pip-wheel-nu7kpdin/.tmp-ow9l0iq0/astropy-5.2.dev64+g6ed769d58.d20251003-0.editable-cp39-cp39-linux_x86_64.whl' and adding '/tmp/tmpse4o_xeyastropy-5.2.dev64+g6ed769d58.d20251003-0.editable-cp39-cp39-linux_x86_64.whl' to it
  adding 'astropy-5.2.dev64+g6ed769d58.d20251003.dist-info/LICENSE.rst'
  adding 'astropy-5.2.dev64+g6ed769d58.d20251003.dist-info/METADATA'
  adding 'astropy-5.2.dev64+g6ed769d58.d20251003.dist-info/WHEEL'
  adding 'astropy-5.2.dev64+g6ed769d58.d20251003.dist-info/entry_points.txt'
  adding 'astropy-5.2.dev64+g6ed769d58.d20251003.dist-info/top_level.txt'
  adding 'astropy-5.2.dev64+g6ed769d58.d20251003.dist-info/RECORD'
  /tmp/pip-build-env-fn13fcdz/overlay/lib/python3.9/site-packages/setuptools/command/editable_wheel.py:348: InformationOnly: Editable installation.
  !!

          ********************************************************************************
          Please be careful with folders in your working directory with the same
          name as your package as they may take precedence during imports.
          ********************************************************************************

  !!
    wheel_obj.write_files(unpacked)
  Building editable for astropy (pyproject.toml) ... [?25l[?25hdone
  Created wheel for astropy: filename=astropy-5.2.dev64+g6ed769d58.d20251003-0.editable-cp39-cp39-linux_x86_64.whl size=6814 sha256=2ab37ab01ae1a044d0462f7a6639d04f9403f11b6b4ea396a2f838050a7ac79a
  Stored in directory: /tmp/pip-ephem-wheel-cache-lhs_xoq6/wheels/7d/66/67/70d1ee2124ccf21d601c352e25cdca10f611f7c8b3f9ffb9e4
Successfully built astropy
Installing collected packages: astropy
  Attempting uninstall: astropy
    Found existing installation: astropy 5.2.dev64+g6ed769d58d.d20241024
    Uninstalling astropy-5.2.dev64+g6ed769d58d.d20241024:
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fits2bitmap
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitscheck
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitsdiff
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitsheader
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitsinfo
      Removing file or directory /opt/miniconda3/envs/testbed/bin/samp_hub
      Removing file or directory /opt/miniconda3/envs/testbed/bin/showtable
      Removing file or directory /opt/miniconda3/envs/testbed/bin/volint
      Removing file or directory /opt/miniconda3/envs/testbed/bin/wcslint
      Successfully uninstalled astropy-5.2.dev64+g6ed769d58d.d20241024
  changing mode of /opt/miniconda3/envs/testbed/bin/fits2bitmap to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/fitscheck to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/fitsdiff to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/fitsheader to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/fitsinfo to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/samp_hub to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/showtable to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/volint to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/wcslint to 755
Successfully installed astropy-5.2.dev64+g6ed769d58.d20251003
[33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.[0m[33m

2025-10-04 06:52:37,686 - thread-139911184823872.app.lang_graph.nodes.issue_bug_reproduction_context_message_node - DEBUG - Sending query to context provider subgraph:
Issue title:
Consider removing auto-transform of structured column into NdarrayMixin

Issue description: 
<!-- This comments are hidden when you submit the issue,
so you do not need to remove them! -->

<!-- Please be sure to check out our contributing guidelines,
https://github.com/astropy/astropy/blob/main/CONTRIBUTING.md .
Please be sure to check out our code of conduct,
https://github.com/astropy/astropy/blob/main/CODE_OF_CONDUCT.md . -->

<!-- Please have a search on our GitHub repository to see if a similar
issue has already been posted.
If a similar issue is closed, have a quick look to see if you are satisfied
by the resolution.
If not please go ahead and open an issue! -->

### Description
<!-- Provide a general description of the feature you would like. -->
<!-- If you want to, you can suggest a draft design or API. -->
<!-- This way we have a deeper discussion on the feature. -->

Currently if you add a structured `np.array` to a Table, it gets turned into an `NdarrayMixin` (via the code below). While this mostly works, I am not sure this is necessary or desirable any more after #12644. Basically the original rational for `NdarrayMixin` was that structured dtype `Column` didn't quite work, in particular for serialization. So we pushed that out to a mixin class which would signal to unified I/O that it might not be supported.

```
        # Structured ndarray gets viewed as a mixin unless already a valid
        # mixin class
        if (not isinstance(data, Column) and not data_is_mixin
                and isinstance(data, np.ndarray) and len(data.dtype) > 1):
            data = data.view(NdarrayMixin)
            data_is_mixin = True
```

Proposal:
- Add a FutureWarning here telling the user to wrap `data` in `Column` and that in the future (5.2) the structured array will be added as a `Column`.
- Change the behavior in 5.2 by removing this clause.

This is not critical for 5.1 but if we have the opportunity due to other (critical) bugfixes it might be nice to save 6 months in the change process.

cc: @mhvk

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-10-04 06:52:37,687 - thread-139911184823872.app.lang_graph.nodes.context_retrieval_subgraph_node - INFO - Enter context retrieval subgraph
2025-10-04 06:52:37,687 - thread-139911184823872.app.lang_graph.nodes.context_query_message_node - DEBUG - Sending query to ContextProviderNode:
content='Issue title:\nConsider removing auto-transform of structured column into NdarrayMixin\n\nIssue description: \n<!-- This comments are hidden when you submit the issue,\nso you do not need to remove them! -->\n\n<!-- Please be sure to check out our contributing guidelines,\nhttps://github.com/astropy/astropy/blob/main/CONTRIBUTING.md .\nPlease be sure to check out our code of conduct,\nhttps://github.com/astropy/astropy/blob/main/CODE_OF_CONDUCT.md . -->\n\n<!-- Please have a search on our GitHub repository to see if a similar\nissue has already been posted.\nIf a similar issue is closed, have a quick look to see if you are satisfied\nby the resolution.\nIf not please go ahead and open an issue! -->\n\n### Description\n<!-- Provide a general description of the feature you would like. -->\n<!-- If you want to, you can suggest a draft design or API. -->\n<!-- This way we have a deeper discussion on the feature. -->\n\nCurrently if you add a structured `np.array` to a Table, it gets turned into an `NdarrayMixin` (via the code below). While this mostly works, I am not sure this is necessary or desirable any more after #12644. Basically the original rational for `NdarrayMixin` was that structured dtype `Column` didn\'t quite work, in particular for serialization. So we pushed that out to a mixin class which would signal to unified I/O that it might not be supported.\n\n```\n        # Structured ndarray gets viewed as a mixin unless already a valid\n        # mixin class\n        if (not isinstance(data, Column) and not data_is_mixin\n                and isinstance(data, np.ndarray) and len(data.dtype) > 1):\n            data = data.view(NdarrayMixin)\n            data_is_mixin = True\n```\n\nProposal:\n- Add a FutureWarning here telling the user to wrap `data` in `Column` and that in the future (5.2) the structured array will be added as a `Column`.\n- Change the behavior in 5.2 by removing this clause.\n\nThis is not critical for 5.1 but if we have the opportunity due to other (critical) bugfixes it might be nice to save 6 months in the change process.\n\ncc: @mhvk\n\nIssue comments:\n\n\nOBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,\nincluding ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.\n\n<reasoning>\n1. Analyze bug characteristics:\n   - Core functionality being tested\n   - Input parameters and configurations\n   - Expected error conditions\n   - Environmental dependencies\n\n2. Search requirements:\n   - Required imports and dependencies\n   - Test files exercising similar functionality\n   - Mock/fixture setup patterns\n   - Assertion styles\n   - Error handling tests\n\n3. Focus areas:\n   - All necessary imports (standard library, testing frameworks, mocking utilities)\n   - Dependencies and third-party packages\n   - Test setup and teardown\n   - Mock object configuration\n   - Network/external service simulation\n   - Error condition verification\n</reasoning>\n\nREQUIREMENTS:\n- Return 5 complete, self-contained test cases most similar to bug scenario\n- Must include ALL necessary imports at the start of each test file\n- Must include full test method implementation\n- Must include ALL mock/fixture setup\n- Must include helper functions used by test\n- Must preserve exact file paths and line numbers\n\n<examples>\n<example id="database-timeout">\n<bug>\ndb.execute("SELECT * FROM users").fetchall() \nraises ConnectionTimeout when load is high\n</bug>\n\n<ideal_test_match>\n# File: tests/test_database.py\nimport pytest\nfrom unittest.mock import Mock, patch\nfrom database.exceptions import ConnectionTimeout\nfrom database.models import QueryResult\nfrom database.client import DatabaseClient\n\nclass TestDatabaseTimeout:\n    @pytest.fixture\n    def mock_db_connection(self):\n        conn = Mock()\n        conn.execute.side_effect = [\n            ConnectionTimeout("Connection timed out"),\n            QueryResult(["user1", "user2"])  # Second try succeeds\n        ]\n        return conn\n        \n    def test_handle_timeout_during_query(self, mock_db_connection):\n        # Complete test showing timeout scenario\n        # Including retry logic verification\n        # With all necessary assertions\n</ideal_test_match>\n</example>\n\n<example id="file-permission">\n<bug>\nFileProcessor(\'/root/data.txt\').process() \nfails with PermissionError\n</bug>\n\n<ideal_test_match>\n# File: tests/test_file_processor.py\nimport os\nimport pytest\nfrom unittest.mock import patch, mock_open\nfrom file_processor import FileProcessor\nfrom file_processor.exceptions import ProcessingError\n\nclass TestFilePermissions:\n    @patch(\'os.access\')\n    @patch(\'builtins.open\')\n    def test_file_permission_denied(self, mock_open, mock_access):\n        # Full test setup with mocked file system\n        # Permission denial simulation\n        # Error handling verification\n</ideal_test_match>\n</example>\n\nSearch priority:\n1. Tests of exact same functionality (including import patterns)\n2. Tests with similar error conditions\n3. Tests with comparable mocking patterns\n4. Tests demonstrating similar assertions\n\nFind the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.\n' additional_kwargs={} response_metadata={}
2025-10-04 06:53:45,304 - thread-139911184823872.app.lang_graph.nodes.context_provider_node - DEBUG - content='In order to find relevant test cases, I started by searching for files related to table mixins, which led me to `astropy/table/tests/test_mixin.py`. I then examined this file and other related test files to identify tests that specifically deal with structured arrays being converted to `NdarrayMixin` instances, as described in the issue. From this, I selected five tests that cover the creation, serialization, and basic manipulation of these columns, which will be useful for ensuring that the proposed changes do not break existing functionality.' additional_kwargs={'function_call': {'name': 'find_file_node_with_basename', 'arguments': '{"basename": "test_mixin.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 251, 'end_index': 551, 'uri': 'https://github.com/davidrosspainter/TheAttentionAtlas', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 21576, 'candidates_token_count': 125, 'total_token_count': 28551, 'prompt_tokens_details': [{'modality': 1, 'token_count': 21576}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 125}], 'thoughts_token_count': 6850, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -6.91103759765625, 'model_name': 'gemini-2.5-pro'} id='run--e8511983-3c35-4773-97ce-534a0889d902-0' tool_calls=[{'name': 'find_file_node_with_basename', 'args': {'basename': 'test_mixin.py'}, 'id': '4f2ef27d-84a3-4fc3-b2db-26291626930d', 'type': 'tool_call'}] usage_metadata={'input_tokens': 21576, 'output_tokens': 125, 'total_tokens': 28551, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 6850}}
2025-10-04 06:53:49,280 - thread-139911184823872.app.lang_graph.nodes.context_provider_node - DEBUG - content="I've located `astropy/table/tests/test_mixin.py`, which appears to be highly relevant to the issue of structured arrays and `NdarrayMixin`. My next step is to read the entire file to get a comprehensive understanding of the existing tests. This will help me identify the most pertinent examples that demonstrate the current behavior of structured array conversion." additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "astropy/table/tests/test_mixin.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 21760, 'candidates_token_count': 100, 'total_token_count': 21988, 'prompt_tokens_details': [{'modality': 1, 'token_count': 21760}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 100}], 'thoughts_token_count': 128, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.16465219497680664, 'model_name': 'gemini-2.5-pro'} id='run--9deccd8a-cee6-4d72-958c-888e3319fb4d-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'astropy/table/tests/test_mixin.py'}, 'id': 'c7575d82-6cb1-4e88-b6d8-54782526e432', 'type': 'tool_call'}] usage_metadata={'input_tokens': 21760, 'output_tokens': 100, 'total_tokens': 21988, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 128}}
2025-10-04 06:55:01,250 - thread-139911184823872.app.lang_graph.nodes.context_provider_node - DEBUG - content="I've reviewed `astropy/table/tests/test_mixin.py` and found several relevant tests. I will now select five that best represent the functionality described in the issue, focusing on how structured arrays are handled and converted within `Table` objects. These tests will provide a solid foundation for understanding the current implementation and for verifying the proposed changes." additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"start_line": 1.0, "relative_path": "astropy/table/tests/test_mixin.py", "end_line": 500.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 843, 'end_index': 1103, 'uri': 'https://github.com/davidrosspainter/TheAttentionAtlas', 'title': '', 'license_': ''}, {'start_index': 10742, 'end_index': 11720, 'uri': 'https://github.com/astropy/astropy', 'license_': 'BSD-3-Clause', 'title': ''}]}, 'usage_metadata': {'prompt_token_count': 30125, 'candidates_token_count': 105, 'total_token_count': 36500, 'cached_content_token_count': 21600, 'prompt_tokens_details': [{'modality': 1, 'token_count': 30125}], 'cache_tokens_details': [{'modality': 1, 'token_count': 21600}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 105}], 'thoughts_token_count': 6270}, 'finish_reason': 'STOP', 'avg_logprobs': -10.527979678199404, 'model_name': 'gemini-2.5-pro'} id='run--8b21789a-21ee-49b1-babc-5303194c9ffa-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'start_line': 1.0, 'relative_path': 'astropy/table/tests/test_mixin.py', 'end_line': 500.0}, 'id': 'd058063a-90a2-4abb-b7fa-79c959853ded', 'type': 'tool_call'}] usage_metadata={'input_tokens': 30125, 'output_tokens': 105, 'total_tokens': 36500, 'input_token_details': {'cache_read': 21600}, 'output_token_details': {'reasoning': 6270}}
2025-10-04 06:55:24,360 - thread-139911184823872.app.lang_graph.nodes.context_provider_node - DEBUG - content='I have identified five relevant test cases from `astropy/table/tests/test_mixin.py` that demonstrate the current behavior of structured arrays being automatically converted to `NdarrayMixin` objects within `astropy.table.Table`. These tests cover the creation of tables with structured array columns, serialization to FITS format, and the preservation of metadata, providing a comprehensive suite for validating the proposed changes. By running these tests, we can ensure that removing the automatic conversion does not introduce regressions in table creation, I/O operations, or data manipulation.\n# File: astropy/table/tests/test_mixin.py\n```python\nimport copy\nimport pickle\nfrom io import StringIO\n\n\nimport pytest\nimport numpy as np\n\nfrom astropy.table.serialize import represent_mixins_as_columns\nfrom astropy.utils.data_info import ParentDtypeInfo\nfrom astropy.table.table_helpers import ArrayWrapper\nfrom astropy.coordinates import EarthLocation, SkyCoord\nfrom astropy.table import Table, QTable, join, hstack, vstack, Column, NdarrayMixin\nfrom astropy.table import serialize\nfrom astropy import time\nfrom astropy import coordinates\nfrom astropy import units as u\nfrom astropy.table.column import BaseColumn\nfrom astropy.table import table_helpers\nfrom astropy.utils.exceptions import AstropyUserWarning\nfrom astropy.utils.metadata import MergeConflictWarning\nfrom astropy.coordinates.tests.test_representation import representation_equal\nfrom astropy.coordinates.tests.helper import skycoord_equal\n\nfrom .conftest import MIXIN_COLS\n\n\ndef test_ndarray_mixin_init():\n    """\n    Test that initializing a structured array works, but a regular one fails.\n    """\n    dtype = np.dtype([(\'a\', \'f8\'), (\'b\', \'i4\')])\n    data = np.zeros(3, dtype=dtype)\n    nm = NdarrayMixin(data)\n    assert isinstance(nm, np.ndarray)\n\n    data = np.zeros(3)\n    with pytest.raises(TypeError):\n        NdarrayMixin(data)\n\n\ndef test_ndarray_mixin_in_table():\n    """\n    Test that a structured array in a table is converted to NdarrayMixin\n    and that it serializes correctly.\n    """\n    dtype = np.dtype([(\'a\', \'f8\'), (\'b\', \'i4\')])\n    data = np.zeros(3, dtype=dtype)\n    t = Table([data], names=[\'x\'])\n    assert isinstance(t[\'x\'], NdarrayMixin)\n\n    # Sub-class of structured array works too.\n    class MyArray(np.ndarray):\n        pass\n    data2 = data.view(MyArray)\n    t2 = Table([data2], names=[\'x\'])\n    assert isinstance(t2[\'x\'], NdarrayMixin)\n    assert not isinstance(t2[\'x\'], MyArray)\n\n    # Check that it serializes to a FITS table correctly.\n    # Without the fix for #4924 this would fail.\n    t.write(StringIO(), format=\'fits\')\n\n\ndef test_ndarray_mixin_serialize():\n    """\n    Test serializing a table with a NdarrayMixin column.  This uses a\n    Quantity column with a structured dtype as a proxy for a plain\n    NdarrayMixin, since that is not a supported mixin and will not\n    serialize as a mixin.\n    """\n    dtype = np.dtype([(\'a\', \'f8\'), (\'b\', \'i4\')])\n    q_struct = u.Quantity(np.array([(1, 2), (3, 4)], dtype=dtype), u.m)\n    t = Table()\n    t[\'q\'] = q_struct\n    assert isinstance(t[\'q\'], u.Quantity)\n\n    tm = represent_mixins_as_columns(t)\n    assert isinstance(tm[\'q\'], Column)\n    assert tm[\'q\'].dtype == dtype\n\n    t2 = serialize.construct_table_from_columns(tm)\n    assert isinstance(t2[\'q\'], u.Quantity)\n    assert t2[\'q\'].dtype == dtype\n    assert np.all(t2[\'q\'] == q_struct)\n\n\ndef test_ndarray_mixin_info():\n    """\n    Test that info of NdarrayMixin is useful.\n    """\n    dtype = np.dtype([(\'a\', \'f8\'), (\'b\', \'i4\')])\n    data = np.zeros(3, dtype=dtype)\n    nm = NdarrayMixin(data)\n    assert isinstance(nm.info, ParentDtypeInfo)\n    assert nm.info.dtype is nm.dtype\n\n\ndef test_col_and_table_and_qtable_class_for_ndarray_mixin_subclass():\n    class MyNdarrayMixin(NdarrayMixin):\n        pass\n\n    class MyColumn(Column):\n        pass\n\n    class MyTable(Table):\n        Column = MyColumn\n\n    class MyQTable(QTable):\n        Column = MyColumn\n\n    dtype = np.dtype([(\'a\', \'f8\'), (\'b\', \'i4\')])\n    data = np.array([(1, 2), (3, 4)], dtype=dtype)\n\n    # Subclass of NdarrayMixin is recognized as a mixin column\n    c = MyNdarrayMixin(data)\n    t = Table([c])\n    assert t[\'col0\'].__class__ is MyNdarrayMixin\n\n    # Check that structured array gets converted to Table.ColumnClass, which\n    # for a vanilla Table is NdarrayMixin.\n    t = Table([data])\n    assert t[\'col0\'].__class__ is NdarrayMixin\n\n    # MyTable has Column.\n    t = MyTable([data])\n    assert t[\'col0\'].__class__ is MyColumn\n\n    # MyQTable has Column.\n    t = MyQTable([data])\n    assert t[\'col0\'].__class__ is MyColumn\n\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 227, 'end_index': 527, 'uri': 'https://github.com/davidrosspainter/TheAttentionAtlas', 'title': '', 'license_': ''}, {'start_index': 3053, 'end_index': 3950, 'uri': 'https://github.com/astropy/astropy', 'license_': 'BSD-3-Clause', 'title': ''}]}, 'usage_metadata': {'prompt_token_count': 38494, 'candidates_token_count': 1340, 'total_token_count': 40494, 'cached_content_token_count': 29446, 'prompt_tokens_details': [{'modality': 1, 'token_count': 38494}], 'cache_tokens_details': [{'modality': 1, 'token_count': 29446}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 1340}], 'thoughts_token_count': 660}, 'finish_reason': 'STOP', 'avg_logprobs': -0.13262798252390393, 'model_name': 'gemini-2.5-pro'} id='run--5f1237a8-99a4-4767-8c7a-2636845d7c82-0' usage_metadata={'input_tokens': 38494, 'output_tokens': 1340, 'total_tokens': 40494, 'input_token_details': {'cache_read': 29446}, 'output_token_details': {'reasoning': 660}}
2025-10-04 06:55:24,361 - thread-139911184823872.app.lang_graph.nodes.context_extraction_node - INFO - Starting context extraction process
2025-10-04 06:55:24,361 - thread-139911184823872.app.lang_graph.nodes.context_extraction_node - DEBUG - This is the original user query:

--- BEGIN ORIGINAL QUERY ---
Issue title:
Consider removing auto-transform of structured column into NdarrayMixin

Issue description: 
<!-- This comments are hidden when you submit the issue,
so you do not need to remove them! -->

<!-- Please be sure to check out our contributing guidelines,
https://github.com/astropy/astropy/blob/main/CONTRIBUTING.md .
Please be sure to check out our code of conduct,
https://github.com/astropy/astropy/blob/main/CODE_OF_CONDUCT.md . -->

<!-- Please have a search on our GitHub repository to see if a similar
issue has already been posted.
If a similar issue is closed, have a quick look to see if you are satisfied
by the resolution.
If not please go ahead and open an issue! -->

### Description
<!-- Provide a general description of the feature you would like. -->
<!-- If you want to, you can suggest a draft design or API. -->
<!-- This way we have a deeper discussion on the feature. -->

Currently if you add a structured `np.array` to a Table, it gets turned into an `NdarrayMixin` (via the code below). While this mostly works, I am not sure this is necessary or desirable any more after #12644. Basically the original rational for `NdarrayMixin` was that structured dtype `Column` didn't quite work, in particular for serialization. So we pushed that out to a mixin class which would signal to unified I/O that it might not be supported.

```
        # Structured ndarray gets viewed as a mixin unless already a valid
        # mixin class
        if (not isinstance(data, Column) and not data_is_mixin
                and isinstance(data, np.ndarray) and len(data.dtype) > 1):
            data = data.view(NdarrayMixin)
            data_is_mixin = True
```

Proposal:
- Add a FutureWarning here telling the user to wrap `data` in `Column` and that in the future (5.2) the structured array will be added as a `Column`.
- Change the behavior in 5.2 by removing this clause.

This is not critical for 5.1 but if we have the opportunity due to other (critical) bugfixes it might be nice to save 6 months in the change process.

cc: @mhvk

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: astropy/table/tests/test_mixin.py
Line number range: 1 - 500
Content:
1. # -*- coding: utf-8 -*-
2. # Licensed under a 3-clause BSD style license - see LICENSE.rst
3. 
4. 
5. import copy
6. import pickle
7. from io import StringIO
8. 
9. import pytest
10. import numpy as np
11. 
12. from astropy.table.serialize import represent_mixins_as_columns
13. from astropy.utils.data_info import ParentDtypeInfo
14. from astropy.table.table_helpers import ArrayWrapper
15. from astropy.coordinates import EarthLocation, SkyCoord
16. from astropy.table import Table, QTable, join, hstack, vstack, Column, NdarrayMixin
17. from astropy.table import serialize
18. from astropy import time
19. from astropy import coordinates
20. from astropy import units as u
21. from astropy.table.column import BaseColumn
22. from astropy.table import table_helpers
23. from astropy.utils.exceptions import AstropyUserWarning
24. from astropy.utils.metadata import MergeConflictWarning
25. from astropy.coordinates.tests.test_representation import representation_equal
26. from astropy.coordinates.tests.helper import skycoord_equal
27. 
28. from .conftest import MIXIN_COLS
29. 
30. 
31. def test_attributes(mixin_cols):
32.     """
33.     Required attributes for a column can be set.
34.     """
35.     m = mixin_cols['m']
36.     m.info.name = 'a'
37.     assert m.info.name == 'a'
38. 
39.     m.info.description = 'a'
40.     assert m.info.description == 'a'
41. 
42.     # Cannot set unit for these classes
43.     if isinstance(m, (u.Quantity, coordinates.SkyCoord, time.Time, time.TimeDelta,
44.                       coordinates.BaseRepresentationOrDifferential)):
45.         with pytest.raises(AttributeError):
46.             m.info.unit = u.m
47.     else:
48.         m.info.unit = u.m
49.         assert m.info.unit is u.m
50. 
51.     m.info.format = 'a'
52.     assert m.info.format == 'a'
53. 
54.     m.info.meta = {'a': 1}
55.     assert m.info.meta == {'a': 1}
56. 
57.     with pytest.raises(AttributeError):
58.         m.info.bad_attr = 1
59. 
60.     with pytest.raises(AttributeError):
61.         m.info.bad_attr
62. 
63. 
64. def check_mixin_type(table, table_col, in_col):
65.     # We check for QuantityInfo rather than just isinstance(col, u.Quantity)
66.     # since we want to treat EarthLocation as a mixin, even though it is
67.     # a Quantity subclass.
68.     if ((isinstance(in_col.info, u.QuantityInfo) and type(table) is not QTable)
69.             or isinstance(in_col, Column)):
70.         assert type(table_col) is table.ColumnClass
71.     else:
72.         assert type(table_col) is type(in_col)
73. 
74.     # Make sure in_col got copied and creating table did not touch it
75.     assert in_col.info.name is None
76. 
77. 
78. def test_make_table(table_types, mixin_cols):
79.     """
80.     Make a table with the columns in mixin_cols, which is an ordered dict of
81.     three cols: 'a' and 'b' are table_types.Column type, and 'm' is a mixin.
82.     """
83.     t = table_types.Table(mixin_cols)
84.     check_mixin_type(t, t['m'], mixin_cols['m'])
85. 
86.     cols = list(mixin_cols.values())
87.     t = table_types.Table(cols, names=('i', 'a', 'b', 'm'))
88.     check_mixin_type(t, t['m'], mixin_cols['m'])
89. 
90.     t = table_types.Table(cols)
91.     check_mixin_type(t, t['col3'], mixin_cols['m'])
92. 
93. 
94. def test_io_ascii_write():
95.     """
96.     Test that table with mixin column can be written by io.ascii for
97.     every pure Python writer.  No validation of the output is done,
98.     this just confirms no exceptions.
99.     """
100.     from astropy.io.ascii.connect import _get_connectors_table
101.     t = QTable(MIXIN_COLS)
102.     for fmt in _get_connectors_table():
103.         if fmt['Write'] and '.fast_' not in fmt['Format']:
104.             out = StringIO()
105.             t.write(out, format=fmt['Format'])
106. 
107. 
108. def test_votable_quantity_write(tmpdir):
109.     """
110.     Test that table with Quantity mixin column can be round-tripped by
111.     io.votable.  Note that FITS and HDF5 mixin support are tested (much more
112.     thoroughly) in their respective subpackage tests
113.     (io/fits/tests/test_connect.py and io/misc/tests/test_hdf5.py).
114.     """
115.     t = QTable()
116.     t['a'] = u.Quantity([1, 2, 4], unit='nm')
117. 
118.     filename = str(tmpdir.join('table-tmp'))
119.     t.write(filename, format='votable', overwrite=True)
120.     qt = QTable.read(filename, format='votable')
121.     assert isinstance(qt['a'], u.Quantity)
122.     assert qt['a'].unit == 'nm'
123. 
124. 
125. @pytest.mark.remote_data
126. @pytest.mark.parametrize('table_types', (Table, QTable))
127. def test_io_time_write_fits_standard(tmpdir, table_types):
128.     """
129.     Test that table with Time mixin columns can be written by io.fits.
130.     Validation of the output is done. Test that io.fits writes a table
131.     containing Time mixin columns that can be partially round-tripped
132.     (metadata scale, location).
133. 
134.     Note that we postpone checking the "local" scale, since that cannot
135.     be done with format 'cxcsec', as it requires an epoch.
136.     """
137.     t = table_types([[1, 2], ['string', 'column']])
138.     for scale in time.STANDARD_TIME_SCALES:
139.         t['a' + scale] = time.Time([[1, 2], [3, 4]], format='cxcsec',
140.                                    scale=scale, location=EarthLocation(
141.             -2446354, 4237210, 4077985, unit='m'))
142.         t['b' + scale] = time.Time(['1999-01-01T00:00:00.123456789',
143.                                     '2010-01-01T00:00:00'], scale=scale)
144.     t['c'] = [3., 4.]
145. 
146.     filename = str(tmpdir.join('table-tmp'))
147. 
148.     # Show that FITS format succeeds
149.     with pytest.warns(
150.             AstropyUserWarning,
151.             match='Time Column "btai" has no specified location, '
152.             'but global Time Position is present'):
153.         t.write(filename, format='fits', overwrite=True)
154.     with pytest.warns(
155.             AstropyUserWarning,
156.             match='Time column reference position "TRPOSn" is not specified'):
157.         tm = table_types.read(filename, format='fits', astropy_native=True)
158. 
159.     for scale in time.STANDARD_TIME_SCALES:
160.         for ab in ('a', 'b'):
161.             name = ab + scale
162. 
163.             # Assert that the time columns are read as Time
164.             assert isinstance(tm[name], time.Time)
165. 
166.             # Assert that the scales round-trip
167.             assert tm[name].scale == t[name].scale
168. 
169.             # Assert that the format is jd
170.             assert tm[name].format == 'jd'
171. 
172.             # Assert that the location round-trips
173.             assert tm[name].location == t[name].location
174. 
175.             # Finally assert that the column data round-trips
176.             assert (tm[name] == t[name]).all()
177. 
178.     for name in ('col0', 'col1', 'c'):
179.         # Assert that the non-time columns are read as Column
180.         assert isinstance(tm[name], Column)
181. 
182.         # Assert that the non-time columns' data round-trips
183.         assert (tm[name] == t[name]).all()
184. 
185.     # Test for conversion of time data to its value, as defined by its format
186.     for scale in time.STANDARD_TIME_SCALES:
187.         for ab in ('a', 'b'):
188.             name = ab + scale
189.             t[name].info.serialize_method['fits'] = 'formatted_value'
190. 
191.     t.write(filename, format='fits', overwrite=True)
192.     tm = table_types.read(filename, format='fits')
193. 
194.     for scale in time.STANDARD_TIME_SCALES:
195.         for ab in ('a', 'b'):
196.             name = ab + scale
197. 
198.             assert not isinstance(tm[name], time.Time)
199.             assert (tm[name] == t[name].value).all()
200. 
201. 
202. @pytest.mark.parametrize('table_types', (Table, QTable))
203. def test_io_time_write_fits_local(tmpdir, table_types):
204.     """
205.     Test that table with a Time mixin with scale local can also be written
206.     by io.fits. Like ``test_io_time_write_fits_standard`` above, but avoiding
207.     ``cxcsec`` format, which requires an epoch and thus cannot be used for a
208.     local time scale.
209.     """
210.     t = table_types([[1, 2], ['string', 'column']])
211.     t['a_local'] = time.Time([[50001, 50002], [50003, 50004]],
212.                              format='mjd', scale='local',
213.                              location=EarthLocation(-2446354, 4237210, 4077985,
214.                                                     unit='m'))
215.     t['b_local'] = time.Time(['1999-01-01T00:00:00.123456789',
216.                               '2010-01-01T00:00:00'], scale='local')
217.     t['c'] = [3., 4.]
218. 
219.     filename = str(tmpdir.join('table-tmp'))
220. 
221.     # Show that FITS format succeeds
222. 
223.     with pytest.warns(AstropyUserWarning,
224.                       match='Time Column "b_local" has no specified location'):
225.         t.write(filename, format='fits', overwrite=True)
226. 
227.     with pytest.warns(AstropyUserWarning,
228.                       match='Time column reference position "TRPOSn" is not specified.'):
229.         tm = table_types.read(filename, format='fits', astropy_native=True)
230. 
231.     for ab in ('a', 'b'):
232.         name = ab + '_local'
233. 
234.         # Assert that the time columns are read as Time
235.         assert isinstance(tm[name], time.Time)
236. 
237.         # Assert that the scales round-trip
238.         assert tm[name].scale == t[name].scale
239. 
240.         # Assert that the format is jd
241.         assert tm[name].format == 'jd'
242. 
243.         # Assert that the location round-trips
244.         assert tm[name].location == t[name].location
245. 
246.         # Finally assert that the column data round-trips
247.         assert (tm[name] == t[name]).all()
248. 
249.     for name in ('col0', 'col1', 'c'):
250.         # Assert that the non-time columns are read as Column
251.         assert isinstance(tm[name], Column)
252. 
253.         # Assert that the non-time columns' data round-trips
254.         assert (tm[name] == t[name]).all()
255. 
256.     # Test for conversion of time data to its value, as defined by its format.
257.     for ab in ('a', 'b'):
258.         name = ab + '_local'
259.         t[name].info.serialize_method['fits'] = 'formatted_value'
260. 
261.     t.write(filename, format='fits', overwrite=True)
262.     tm = table_types.read(filename, format='fits')
263. 
264.     for ab in ('a', 'b'):
265.         name = ab + '_local'
266. 
267.         assert not isinstance(tm[name], time.Time)
268.         assert (tm[name] == t[name].value).all()
269. 
270. 
271. def test_votable_mixin_write_fail(mixin_cols):
272.     """
273.     Test that table with mixin columns (excluding Quantity) cannot be written by
274.     io.votable.
275.     """
276.     t = QTable(mixin_cols)
277.     # Only do this test if there are unsupported column types (i.e. anything besides
278.     # BaseColumn and Quantity class instances).
279.     unsupported_cols = t.columns.not_isinstance((BaseColumn, u.Quantity))
280. 
281.     if not unsupported_cols:
282.         pytest.skip("no unsupported column types")
283. 
284.     out = StringIO()
285.     with pytest.raises(ValueError) as err:
286.         t.write(out, format='votable')
287.     assert 'cannot write table with mixin column(s)' in str(err.value)
288. 
289. 
290. def test_join(table_types):
291.     """
292.     Join tables with mixin cols.  Use column "i" as proxy for what the
293.     result should be for each mixin.
294.     """
295.     t1 = table_types.Table()
296.     t1['a'] = table_types.Column(['a', 'b', 'b', 'c'])
297.     t1['i'] = table_types.Column([0, 1, 2, 3])
298.     for name, col in MIXIN_COLS.items():
299.         t1[name] = col
300. 
301.     t2 = table_types.Table(t1)
302.     t2['a'] = ['b', 'c', 'a', 'd']
303. 
304.     for name, col in MIXIN_COLS.items():
305.         t1[name].info.description = name
306.         t2[name].info.description = name + '2'
307. 
308.     for join_type in ('inner', 'left'):
309.         t12 = join(t1, t2, keys='a', join_type=join_type)
310.         idx1 = t12['i_1']
311.         idx2 = t12['i_2']
312.         for name, col in MIXIN_COLS.items():
313.             name1 = name + '_1'
314.             name2 = name + '_2'
315.             assert_table_name_col_equal(t12, name1, col[idx1])
316.             assert_table_name_col_equal(t12, name2, col[idx2])
317.             assert t12[name1].info.description == name
318.             assert t12[name2].info.description == name + '2'
319. 
320.     for join_type in ('outer', 'right'):
321.         with pytest.raises(NotImplementedError) as exc:
322.             t12 = join(t1, t2, keys='a', join_type=join_type)
323.         assert 'join requires masking column' in str(exc.value)
324. 
325.     with pytest.raises(TypeError) as exc:
326.         t12 = join(t1, t2, keys=['a', 'skycoord'])
327.     assert 'one or more key columns are not sortable' in str(exc.value)
328. 
329.     # Join does work for a mixin which is a subclass of np.ndarray
330.     with pytest.warns(MergeConflictWarning,
331.                       match="In merged column 'quantity' the 'description' "
332.                             "attribute does not match"):
333.         t12 = join(t1, t2, keys=['quantity'])
334.     assert np.all(t12['a_1'] == t1['a'])
335. 
336. 
337. def test_hstack(table_types):
338.     """
339.     Hstack tables with mixin cols.  Use column "i" as proxy for what the
340.     result should be for each mixin.
341.     """
342.     t1 = table_types.Table()
343.     t1['i'] = table_types.Column([0, 1, 2, 3])
344.     for name, col in MIXIN_COLS.items():
345.         t1[name] = col
346.         t1[name].info.description = name
347.         t1[name].info.meta = {'a': 1}
348. 
349.     for join_type in ('inner', 'outer'):
350.         for chop in (True, False):
351.             t2 = table_types.Table(t1)
352.             if chop:
353.                 t2 = t2[:-1]
354.                 if join_type == 'outer':
355.                     with pytest.raises(NotImplementedError) as exc:
356.                         t12 = hstack([t1, t2], join_type=join_type)
357.                     assert 'hstack requires masking column' in str(exc.value)
358.                     continue
359. 
360.             t12 = hstack([t1, t2], join_type=join_type)
361.             idx1 = t12['i_1']
362.             idx2 = t12['i_2']
363.             for name, col in MIXIN_COLS.items():
364.                 name1 = name + '_1'
365.                 name2 = name + '_2'
366.                 assert_table_name_col_equal(t12, name1, col[idx1])
367.                 assert_table_name_col_equal(t12, name2, col[idx2])
368.                 for attr in ('description', 'meta'):
369.                     assert getattr(t1[name].info, attr) == getattr(t12[name1].info, attr)
370.                     assert getattr(t2[name].info, attr) == getattr(t12[name2].info, attr)
371. 
372. 
373. def assert_table_name_col_equal(t, name, col):
374.     """
375.     Assert all(t[name] == col), with special handling for known mixin cols.
376.     """
377.     if isinstance(col, coordinates.SkyCoord):
378.         assert np.all(t[name].ra == col.ra)
379.         assert np.all(t[name].dec == col.dec)
380.     elif isinstance(col, coordinates.BaseRepresentationOrDifferential):
381.         assert np.all(representation_equal(t[name], col))
382.     elif isinstance(col, u.Quantity):
383.         if type(t) is QTable:
384.             assert np.all(t[name] == col)
385.     elif isinstance(col, table_helpers.ArrayWrapper):
386.         assert np.all(t[name].data == col.data)
387.     else:
388.         assert np.all(t[name] == col)
389. 
390. 
391. def test_get_items(mixin_cols):
392.     """
393.     Test that slicing / indexing table gives right values and col attrs inherit
394.     """
395.     attrs = ('name', 'unit', 'dtype', 'format', 'description', 'meta')
396.     m = mixin_cols['m']
397.     m.info.name = 'm'
398.     m.info.format = '{0}'
399.     m.info.description = 'd'
400.     m.info.meta = {'a': 1}
401.     t = QTable([m])
402.     for item in ([1, 3], np.array([0, 2]), slice(1, 3)):
403.         t2 = t[item]
404.         m2 = m[item]
405.         assert_table_name_col_equal(t2, 'm', m[item])
406.         for attr in attrs:
407.             assert getattr(t2['m'].info, attr) == getattr(m.info, attr)
408.             assert getattr(m2.info, attr) == getattr(m.info, attr)
409. 
410. 
411. def test_info_preserved_pickle_copy_init(mixin_cols):
412.     """
413.     Test copy, pickle, and init from class roundtrip preserve info.  This
414.     tests not only the mixin classes but a regular column as well.
415.     """
416.     def pickle_roundtrip(c):
417.         return pickle.loads(pickle.dumps(c))
418. 
419.     def init_from_class(c):
420.         return c.__class__(c)
421. 
422.     attrs = ('name', 'unit', 'dtype', 'format', 'description', 'meta')
423.     for colname in ('i', 'm'):
424.         m = mixin_cols[colname]
425.         m.info.name = colname
426.         m.info.format = '{0}'
427.         m.info.description = 'd'
428.         m.info.meta = {'a': 1}
429.         for func in (copy.copy, copy.deepcopy, pickle_roundtrip, init_from_class):
430.             m2 = func(m)
431.             for attr in attrs:
432.                 # non-native byteorder not preserved by last 2 func, _except_ for structured dtype
433.                 if (attr != 'dtype'
434.                         or getattr(m.info.dtype, 'isnative', True)
435.                         or m.info.dtype.name.startswith('void')
436.                         or func in (copy.copy, copy.deepcopy)):
437.                     original = getattr(m.info, attr)
438.                 else:
439.                     # func does not preserve byteorder, check against (native) type.
440.                     original = m.info.dtype.newbyteorder('=')
441.                 assert getattr(m2.info, attr) == original
442. 
443. 
444. def test_add_column(mixin_cols):
445.     """
446.     Test that adding a column preserves values and attributes
447.     """
448.     attrs = ('name', 'unit', 'dtype', 'format', 'description', 'meta')
449.     m = mixin_cols['m']
450.     assert m.info.name is None
451. 
452.     # Make sure adding column in various ways doesn't touch
453.     t = QTable([m], names=['a'])
454.     assert m.info.name is None
455. 
456.     t['new'] = m
457.     assert m.info.name is None
458. 
459.     m.info.name = 'm'
460.     m.info.format = '{0}'
461.     m.info.description = 'd'
462.     m.info.meta = {'a': 1}
463.     t = QTable([m])
464. 
465.     # Add columns m2, m3, m4 by two different methods and test expected equality
466.     t['m2'] = m
467.     m.info.name = 'm3'
468.     t.add_columns([m], copy=True)
469.     m.info.name = 'm4'
470.     t.add_columns([m], copy=False)
471.     for name in ('m2', 'm3', 'm4'):
472.         assert_table_name_col_equal(t, name, m)
473.         for attr in attrs:
474.             if attr != 'name':
475.                 assert getattr(t['m'].info, attr) == getattr(t[name].info, attr)
476.     # Also check that one can set using a scalar.
477.     s = m[0]
478.     if type(s) is type(m) and 'info' in s.__dict__:
479.         # We're not going to worry about testing classes for which scalars
480.         # are a different class than the real array, or where info is not copied.
481.         t['s'] = m[0]
482.         assert_table_name_col_equal(t, 's', m[0])
483.         for attr in attrs:
484.             if attr != 'name':
485.                 assert getattr(t['m'].info, attr) == getattr(t['s'].info, attr)
486. 
487.     # While we're add it, also check a length-1 table.
488.     t = QTable([m[1:2]], names=['m'])
489.     if type(s) is type(m) and 'info' in s.__dict__:
490.         t['s'] = m[0]
491.         assert_table_name_col_equal(t, 's', m[0])
492.         for attr in attrs:
493.             if attr != 'name':
494.                 assert getattr(t['m'].info, attr) == getattr(t['s'].info, attr)
495. 
496. 
497. def test_vstack():
498.     """
499.     Vstack tables with mixin cols.
500.     """


--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to a given query and return it in the specified format!
EVERY context object MUST include: reasoning, relative_path, start_line, and end_line.

2025-10-04 06:56:53,680 - thread-139911184823872.app.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning='1. Query requirement analysis:\n   - The user wants to understand the current behavior of adding a structured array to a Table. The issue is about the automatic transformation into `NdarrayMixin`.\n2. Extended relevance:\n   - This test, `test_make_table`, directly tests the creation of a `Table` with mixin columns. The included helper function, `check_mixin_type`, is crucial as it asserts the type of the column within the table, which is the core of the issue. This test demonstrates the existing mechanism for handling mixin columns during table instantiation.', relative_path='astropy/table/tests/test_mixin.py', start_line=64, end_line=93), ContextOutput(reasoning='1. Query requirement analysis:\n   - The query discusses changing the behavior of adding a structured array column.\n2. Extended relevance:\n   - This test case, `test_add_column`, specifically covers the addition of a mixin column to an existing `Table`. This is another primary way, besides `Table` initialization, that the problematic type conversion could occur. The test verifies that column attributes are preserved, which is relevant to the discussion of `Column` vs `NdarrayMixin`.', relative_path='astropy/table/tests/test_mixin.py', start_line=444, end_line=495), ContextOutput(reasoning="1. Query requirement analysis:\n   - The issue mentions that the original rationale for `NdarrayMixin` was related to serialization and structured dtypes.\n2. Extended relevance:\n   - This test is highly relevant because it explicitly checks how `info` attributes are preserved for various operations, including `pickle` (serialization). More importantly, it contains a special condition for structured dtypes (`m.info.dtype.name.startswith('void')`), which directly relates to the structured arrays mentioned in the issue. This provides insight into how structured array columns are intended to be handled.", relative_path='astropy/table/tests/test_mixin.py', start_line=411, end_line=442), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user is investigating the behavior of structured array columns. This includes how they behave after being added to a table.\n2. Extended relevance:\n   - This test checks the behavior of mixin columns when the table is sliced or indexed. This is a fundamental table operation. It's important to ensure that if a structured array is converted to an `NdarrayMixin` column, it still functions correctly in these scenarios. This test verifies that behavior.", relative_path='astropy/table/tests/test_mixin.py', start_line=391, end_line=409), ContextOutput(reasoning='1. Query requirement analysis:\n   - The issue description explicitly states that the "original rational for `NdarrayMixin` was that structured dtype `Column` didn\'t quite work, in particular for serialization. So we pushed that out to a mixin class which would signal to unified I/O that it might not be supported."\n2. Extended relevance:\n   - This test provides direct evidence for the serialization problems mentioned in the issue. It shows that writing a table with certain mixin columns to the \'votable\' format is expected to fail. This helps to understand the historical context and the motivation behind introducing `NdarrayMixin` to handle special cases like structured arrays.', relative_path='astropy/table/tests/test_mixin.py', start_line=271, end_line=288)]
2025-10-04 06:56:53,681 - thread-139911184823872.app.lang_graph.nodes.context_extraction_node - INFO - Context extraction complete, returning context [Context(relative_path='astropy/table/tests/test_mixin.py', content='64. def check_mixin_type(table, table_col, in_col):\n65.     # We check for QuantityInfo rather than just isinstance(col, u.Quantity)\n66.     # since we want to treat EarthLocation as a mixin, even though it is\n67.     # a Quantity subclass.\n68.     if ((isinstance(in_col.info, u.QuantityInfo) and type(table) is not QTable)\n69.             or isinstance(in_col, Column)):\n70.         assert type(table_col) is table.ColumnClass\n71.     else:\n72.         assert type(table_col) is type(in_col)\n73. \n74.     # Make sure in_col got copied and creating table did not touch it\n75.     assert in_col.info.name is None\n76. \n77. \n78. def test_make_table(table_types, mixin_cols):\n79.     """\n80.     Make a table with the columns in mixin_cols, which is an ordered dict of\n81.     three cols: \'a\' and \'b\' are table_types.Column type, and \'m\' is a mixin.\n82.     """\n83.     t = table_types.Table(mixin_cols)\n84.     check_mixin_type(t, t[\'m\'], mixin_cols[\'m\'])\n85. \n86.     cols = list(mixin_cols.values())\n87.     t = table_types.Table(cols, names=(\'i\', \'a\', \'b\', \'m\'))\n88.     check_mixin_type(t, t[\'m\'], mixin_cols[\'m\'])\n89. \n90.     t = table_types.Table(cols)\n91.     check_mixin_type(t, t[\'col3\'], mixin_cols[\'m\'])\n92. \n93. ', start_line_number=64, end_line_number=93), Context(relative_path='astropy/table/tests/test_mixin.py', content='444. def test_add_column(mixin_cols):\n445.     """\n446.     Test that adding a column preserves values and attributes\n447.     """\n448.     attrs = (\'name\', \'unit\', \'dtype\', \'format\', \'description\', \'meta\')\n449.     m = mixin_cols[\'m\']\n450.     assert m.info.name is None\n451. \n452.     # Make sure adding column in various ways doesn\'t touch\n453.     t = QTable([m], names=[\'a\'])\n454.     assert m.info.name is None\n455. \n456.     t[\'new\'] = m\n457.     assert m.info.name is None\n458. \n459.     m.info.name = \'m\'\n460.     m.info.format = \'{0}\'\n461.     m.info.description = \'d\'\n462.     m.info.meta = {\'a\': 1}\n463.     t = QTable([m])\n464. \n465.     # Add columns m2, m3, m4 by two different methods and test expected equality\n466.     t[\'m2\'] = m\n467.     m.info.name = \'m3\'\n468.     t.add_columns([m], copy=True)\n469.     m.info.name = \'m4\'\n470.     t.add_columns([m], copy=False)\n471.     for name in (\'m2\', \'m3\', \'m4\'):\n472.         assert_table_name_col_equal(t, name, m)\n473.         for attr in attrs:\n474.             if attr != \'name\':\n475.                 assert getattr(t[\'m\'].info, attr) == getattr(t[name].info, attr)\n476.     # Also check that one can set using a scalar.\n477.     s = m[0]\n478.     if type(s) is type(m) and \'info\' in s.__dict__:\n479.         # We\'re not going to worry about testing classes for which scalars\n480.         # are a different class than the real array, or where info is not copied.\n481.         t[\'s\'] = m[0]\n482.         assert_table_name_col_equal(t, \'s\', m[0])\n483.         for attr in attrs:\n484.             if attr != \'name\':\n485.                 assert getattr(t[\'m\'].info, attr) == getattr(t[\'s\'].info, attr)\n486. \n487.     # While we\'re add it, also check a length-1 table.\n488.     t = QTable([m[1:2]], names=[\'m\'])\n489.     if type(s) is type(m) and \'info\' in s.__dict__:\n490.         t[\'s\'] = m[0]\n491.         assert_table_name_col_equal(t, \'s\', m[0])\n492.         for attr in attrs:\n493.             if attr != \'name\':\n494.                 assert getattr(t[\'m\'].info, attr) == getattr(t[\'s\'].info, attr)\n495. ', start_line_number=444, end_line_number=495), Context(relative_path='astropy/table/tests/test_mixin.py', content='411. def test_info_preserved_pickle_copy_init(mixin_cols):\n412.     """\n413.     Test copy, pickle, and init from class roundtrip preserve info.  This\n414.     tests not only the mixin classes but a regular column as well.\n415.     """\n416.     def pickle_roundtrip(c):\n417.         return pickle.loads(pickle.dumps(c))\n418. \n419.     def init_from_class(c):\n420.         return c.__class__(c)\n421. \n422.     attrs = (\'name\', \'unit\', \'dtype\', \'format\', \'description\', \'meta\')\n423.     for colname in (\'i\', \'m\'):\n424.         m = mixin_cols[colname]\n425.         m.info.name = colname\n426.         m.info.format = \'{0}\'\n427.         m.info.description = \'d\'\n428.         m.info.meta = {\'a\': 1}\n429.         for func in (copy.copy, copy.deepcopy, pickle_roundtrip, init_from_class):\n430.             m2 = func(m)\n431.             for attr in attrs:\n432.                 # non-native byteorder not preserved by last 2 func, _except_ for structured dtype\n433.                 if (attr != \'dtype\'\n434.                         or getattr(m.info.dtype, \'isnative\', True)\n435.                         or m.info.dtype.name.startswith(\'void\')\n436.                         or func in (copy.copy, copy.deepcopy)):\n437.                     original = getattr(m.info, attr)\n438.                 else:\n439.                     # func does not preserve byteorder, check against (native) type.\n440.                     original = m.info.dtype.newbyteorder(\'=\')\n441.                 assert getattr(m2.info, attr) == original\n442. ', start_line_number=411, end_line_number=442), Context(relative_path='astropy/table/tests/test_mixin.py', content='391. def test_get_items(mixin_cols):\n392.     """\n393.     Test that slicing / indexing table gives right values and col attrs inherit\n394.     """\n395.     attrs = (\'name\', \'unit\', \'dtype\', \'format\', \'description\', \'meta\')\n396.     m = mixin_cols[\'m\']\n397.     m.info.name = \'m\'\n398.     m.info.format = \'{0}\'\n399.     m.info.description = \'d\'\n400.     m.info.meta = {\'a\': 1}\n401.     t = QTable([m])\n402.     for item in ([1, 3], np.array([0, 2]), slice(1, 3)):\n403.         t2 = t[item]\n404.         m2 = m[item]\n405.         assert_table_name_col_equal(t2, \'m\', m[item])\n406.         for attr in attrs:\n407.             assert getattr(t2[\'m\'].info, attr) == getattr(m.info, attr)\n408.             assert getattr(m2.info, attr) == getattr(m.info, attr)\n409. ', start_line_number=391, end_line_number=409), Context(relative_path='astropy/table/tests/test_mixin.py', content='271. def test_votable_mixin_write_fail(mixin_cols):\n272.     """\n273.     Test that table with mixin columns (excluding Quantity) cannot be written by\n274.     io.votable.\n275.     """\n276.     t = QTable(mixin_cols)\n277.     # Only do this test if there are unsupported column types (i.e. anything besides\n278.     # BaseColumn and Quantity class instances).\n279.     unsupported_cols = t.columns.not_isinstance((BaseColumn, u.Quantity))\n280. \n281.     if not unsupported_cols:\n282.         pytest.skip("no unsupported column types")\n283. \n284.     out = StringIO()\n285.     with pytest.raises(ValueError) as err:\n286.         t.write(out, format=\'votable\')\n287.     assert \'cannot write table with mixin column(s)\' in str(err.value)\n288. ', start_line_number=271, end_line_number=288)]
2025-10-04 06:56:53,681 - thread-139911184823872.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-10-04 06:56:53,681 - thread-139911184823872.app.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
astropy
â”œâ”€â”€ .circleci
|   â””â”€â”€ config.yml
â”œâ”€â”€ .github
|   â”œâ”€â”€ ISSUE_TEMPLATE
|   |   â”œâ”€â”€ bug_report.md
|   |   â””â”€â”€ feature_request.md
|   â”œâ”€â”€ PULL_REQUEST_TEMPLATE.md
|   â”œâ”€â”€ labeler.yml
|   â””â”€â”€ workflows
|       â”œâ”€â”€ check_changelog.yml
|       â”œâ”€â”€ ci_cron_daily.yml
|       â”œâ”€â”€ ci_cron_weekly.yml
|       â”œâ”€â”€ ci_workflows.yml
|       â”œâ”€â”€ codeql-analysis.yml
|       â”œâ”€â”€ open_actions.yml
|       â”œâ”€â”€ stalebot.yml
|       â””â”€â”€ update_iers.yml
â”œâ”€â”€ .pep8speaks.yml
â”œâ”€â”€ .pre-commit-config.yaml
â”œâ”€â”€ .pyinstaller
|   â”œâ”€â”€ hooks
|   |   â””â”€â”€ hook-skyfield.py
|   â””â”€â”€ run_astropy_tests.py
â”œâ”€â”€ .readthedocs.yml
â”œâ”€â”€ CHANGES.rst
â”œâ”€â”€ CODE_OF_CONDUCT.md
â”œâ”€â”€ CONTRIBUTING.md
â”œâ”€â”€ GOVERNANCE.md
â”œâ”€â”€ LICENSE.rst
â”œâ”€â”€ README.rst
â”œâ”€â”€ astropy
|   â”œâ”€â”€ __init__.py
|   â”œâ”€â”€ _dev
|   |   â”œâ”€â”€ __init__.py
|   |   â””â”€â”€ scm_version.py
|   â”œâ”€â”€ _erfa
|   |   â””â”€â”€ __init__.py
|   â”œâ”€â”€ config
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ affiliated.py
|   |   â”œâ”€â”€ configuration.py
|   |   â”œâ”€â”€ paths.py
|   |   â””â”€â”€ tests
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ data
|   |       â””â”€â”€ test_configs.py
|   â”œâ”€â”€ conftest.py
|   â”œâ”€â”€ constants
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ astropyconst13.py
|   |   â”œâ”€â”€ astropyconst20.py
|   |   â”œâ”€â”€ astropyconst40.py
|   |   â”œâ”€â”€ cgs.py
|   |   â”œâ”€â”€ codata2010.py
|   |   â”œâ”€â”€ codata2014.py
|   |   â”œâ”€â”€ codata2018.py
|   |   â”œâ”€â”€ config.py
|   |   â”œâ”€â”€ constant.py
|   |   â”œâ”€â”€ iau2012.py
|   |   â”œâ”€â”€ iau2015.py
|   |   â”œâ”€â”€ si.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ test_constant.py
|   |   |   â”œâ”€â”€ test_pickle.py
|   |   |   â”œâ”€â”€ test_prior_version.py
|   |   |   â””â”€â”€ test_sciencestate.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ convolution
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ convolve.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ kernels.py
|   |   â”œâ”€â”€ setup_package.py
|   |   â”œâ”€â”€ src
|   |   |   â””â”€â”€ convolve.c
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ test_convolve.py
|   |   |   â”œâ”€â”€ test_convolve_fft.py
|   |   |   â”œâ”€â”€ test_convolve_kernels.py
|   |   |   â”œâ”€â”€ test_convolve_models.py
|   |   |   â”œâ”€â”€ test_convolve_nddata.py
|   |   |   â”œâ”€â”€ test_convolve_speeds.py
|   |   |   â”œâ”€â”€ test_discretize.py
|   |   |   â”œâ”€â”€ test_kernel_class.py
|   |   |   â””â”€â”€ test_pickle.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ coordinates
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ angle_formats.py
|   |   â”œâ”€â”€ angle_lextab.py
|   |   â”œâ”€â”€ angle_parsetab.py
|   |   â”œâ”€â”€ angle_utilities.py
|   |   â”œâ”€â”€ angles.py
|   |   â”œâ”€â”€ attributes.py
|   |   â”œâ”€â”€ baseframe.py
|   |   â”œâ”€â”€ builtin_frames
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ altaz.py
|   |   |   â”œâ”€â”€ baseradec.py
|   |   |   â”œâ”€â”€ cirs.py
|   |   |   â”œâ”€â”€ cirs_observed_transforms.py
|   |   |   â”œâ”€â”€ ecliptic.py
|   |   |   â”œâ”€â”€ ecliptic_transforms.py
|   |   |   â”œâ”€â”€ equatorial.py
|   |   |   â”œâ”€â”€ fk4.py
|   |   |   â”œâ”€â”€ fk4_fk5_transforms.py
|   |   |   â”œâ”€â”€ fk5.py
|   |   |   â”œâ”€â”€ galactic.py
|   |   |   â”œâ”€â”€ galactic_transforms.py
|   |   |   â”œâ”€â”€ galactocentric.py
|   |   |   â”œâ”€â”€ gcrs.py
|   |   |   â”œâ”€â”€ hadec.py
|   |   |   â”œâ”€â”€ hcrs.py
|   |   |   â”œâ”€â”€ icrs.py
|   |   |   â”œâ”€â”€ icrs_cirs_transforms.py
|   |   |   â”œâ”€â”€ icrs_fk5_transforms.py
|   |   |   â”œâ”€â”€ icrs_observed_transforms.py
|   |   |   â”œâ”€â”€ intermediate_rotation_transforms.py
|   |   |   â”œâ”€â”€ itrs.py
|   |   |   â”œâ”€â”€ lsr.py
|   |   |   â”œâ”€â”€ skyoffset.py
|   |   |   â”œâ”€â”€ supergalactic.py
|   |   |   â”œâ”€â”€ supergalactic_transforms.py
|   |   |   â””â”€â”€ utils.py
|   |   â”œâ”€â”€ calculation.py
|   |   â”œâ”€â”€ data
|   |   â”œâ”€â”€ distances.py
|   |   â”œâ”€â”€ earth.py
|   |   â”œâ”€â”€ earth_orientation.py
|   |   â”œâ”€â”€ erfa_astrom.py
|   |   â”œâ”€â”€ errors.py
|   |   â”œâ”€â”€ funcs.py
|   |   â”œâ”€â”€ jparser.py
|   |   â”œâ”€â”€ matching.py
|   |   â”œâ”€â”€ matrix_utilities.py
|   |   â”œâ”€â”€ name_resolve.py
|   |   â”œâ”€â”€ orbital_elements.py
|   |   â”œâ”€â”€ representation.py
|   |   â”œâ”€â”€ sites.py
|   |   â”œâ”€â”€ sky_coordinate.py
|   |   â”œâ”€â”€ sky_coordinate_parsers.py
|   |   â”œâ”€â”€ solar_system.py
|   |   â”œâ”€â”€ spectral_coordinate.py
|   |   â”œâ”€â”€ spectral_quantity.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ accuracy
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ generate_ref_ast.py
|   |   |   |   â”œâ”€â”€ generate_spectralcoord_ref.py
|   |   |   |   â”œâ”€â”€ test_altaz_icrs.py
|   |   |   |   â”œâ”€â”€ test_ecliptic.py
|   |   |   |   â”œâ”€â”€ test_fk4_no_e_fk4.py
|   |   |   |   â”œâ”€â”€ test_fk4_no_e_fk5.py
|   |   |   |   â”œâ”€â”€ test_galactic_fk4.py
|   |   |   |   â””â”€â”€ test_icrs_fk5.py
|   |   |   â”œâ”€â”€ helper.py
|   |   |   â”œâ”€â”€ test_angle_generators.py
|   |   |   â”œâ”€â”€ test_angles.py
|   |   |   â”œâ”€â”€ test_angular_separation.py
|   |   |   â”œâ”€â”€ test_api_ape5.py
|   |   |   â”œâ”€â”€ test_arrays.py
|   |   |   â”œâ”€â”€ test_atc_replacements.py
|   |   |   â”œâ”€â”€ test_celestial_transformations.py
|   |   |   â”œâ”€â”€ test_distance.py
|   |   |   â”œâ”€â”€ test_earth.py
|   |   |   â”œâ”€â”€ test_erfa_astrom.py
|   |   |   â”œâ”€â”€ test_finite_difference_velocities.py
|   |   |   â”œâ”€â”€ test_formatting.py
|   |   |   â”œâ”€â”€ test_frames.py
|   |   |   â”œâ”€â”€ test_frames_with_velocity.py
|   |   |   â”œâ”€â”€ test_funcs.py
|   |   |   â”œâ”€â”€ test_geodetic_representations.py
|   |   |   â”œâ”€â”€ test_iau_fullstack.py
|   |   |   â”œâ”€â”€ test_icrs_observed_transformations.py
|   |   |   â”œâ”€â”€ test_intermediate_transformations.py
|   |   |   â”œâ”€â”€ test_matching.py
|   |   |   â”œâ”€â”€ test_matrix_utilities.py
|   |   |   â”œâ”€â”€ test_name_resolve.py
|   |   |   â”œâ”€â”€ test_pickle.py
|   |   |   â”œâ”€â”€ test_regression.py
|   |   |   â”œâ”€â”€ test_representation.py
|   |   |   â”œâ”€â”€ test_representation_arithmetic.py
|   |   |   â”œâ”€â”€ test_representation_methods.py
|   |   |   â”œâ”€â”€ test_shape_manipulation.py
|   |   |   â”œâ”€â”€ test_sites.py
|   |   |   â”œâ”€â”€ test_sky_coord.py
|   |   |   â”œâ”€â”€ test_sky_coord_velocities.py
|   |   |   â”œâ”€â”€ test_skyoffset_transformations.py
|   |   |   â”œâ”€â”€ test_solar_system.py
|   |   |   â”œâ”€â”€ test_spectral_coordinate.py
|   |   |   â”œâ”€â”€ test_spectral_quantity.py
|   |   |   â”œâ”€â”€ test_transformations.py
|   |   |   â”œâ”€â”€ test_unit_representation.py
|   |   |   â”œâ”€â”€ test_utils.py
|   |   |   â””â”€â”€ test_velocity_corrs.py
|   |   â””â”€â”€ transformations.py
|   â”œâ”€â”€ cosmology
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ connect.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ data
|   |   â”œâ”€â”€ flrw
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ base.py
|   |   |   â”œâ”€â”€ lambdacdm.py
|   |   |   â”œâ”€â”€ tests
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ conftest.py
|   |   |   |   â”œâ”€â”€ test_base.py
|   |   |   |   â”œâ”€â”€ test_init.py
|   |   |   |   â”œâ”€â”€ test_lambdacdm.py
|   |   |   |   â”œâ”€â”€ test_w0cdm.py
|   |   |   |   â”œâ”€â”€ test_w0wacdm.py
|   |   |   |   â”œâ”€â”€ test_w0wzcdm.py
|   |   |   |   â””â”€â”€ test_wpwazpcdm.py
|   |   |   â”œâ”€â”€ w0cdm.py
|   |   |   â”œâ”€â”€ w0wacdm.py
|   |   |   â”œâ”€â”€ w0wzcdm.py
|   |   |   â””â”€â”€ wpwazpcdm.py
|   |   â”œâ”€â”€ funcs.py
|   |   â”œâ”€â”€ io
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ cosmology.py
|   |   |   â”œâ”€â”€ ecsv.py
|   |   |   â”œâ”€â”€ mapping.py
|   |   |   â”œâ”€â”€ model.py
|   |   |   â”œâ”€â”€ row.py
|   |   |   â”œâ”€â”€ table.py
|   |   |   â”œâ”€â”€ tests
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ base.py
|   |   |   |   â”œâ”€â”€ test_.py
|   |   |   |   â”œâ”€â”€ test_cosmology.py
|   |   |   |   â”œâ”€â”€ test_ecsv.py
|   |   |   |   â”œâ”€â”€ test_json.py
|   |   |   |   â”œâ”€â”€ test_mapping.py
|   |   |   |   â”œâ”€â”€ test_model.py
|   |   |   |   â”œâ”€â”€ test_row.py
|   |   |   |   â”œâ”€â”€ test_table.py
|   |   |   |   â””â”€â”€ test_yaml.py
|   |   |   â”œâ”€â”€ utils.py
|   |   |   â””â”€â”€ yaml.py
|   |   â”œâ”€â”€ parameter.py
|   |   â”œâ”€â”€ parameters.py
|   |   â”œâ”€â”€ realizations.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ conftest.py
|   |   |   â”œâ”€â”€ helper.py
|   |   |   â”œâ”€â”€ test_connect.py
|   |   |   â”œâ”€â”€ test_core.py
|   |   |   â”œâ”€â”€ test_cosmology.py
|   |   |   â”œâ”€â”€ test_funcs.py
|   |   |   â”œâ”€â”€ test_parameter.py
|   |   |   â”œâ”€â”€ test_parameters.py
|   |   |   â”œâ”€â”€ test_realizations.py
|   |   |   â”œâ”€â”€ test_units.py
|   |   |   â””â”€â”€ test_utils.py
|   |   â”œâ”€â”€ units.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ extern
|   |   â”œâ”€â”€ README.rst
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ _strptime.py
|   |   â”œâ”€â”€ configobj
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ configobj.py
|   |   |   â””â”€â”€ validate.py
|   |   â”œâ”€â”€ jquery
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â””â”€â”€ data
|   |   |       â”œâ”€â”€ css
|   |   |       â”œâ”€â”€ images
|   |   |       â””â”€â”€ js
|   |   â””â”€â”€ ply
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ cpp.py
|   |       â”œâ”€â”€ ctokens.py
|   |       â”œâ”€â”€ lex.py
|   |       â”œâ”€â”€ yacc.py
|   |       â””â”€â”€ ygen.py
|   â”œâ”€â”€ io
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ ascii
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ basic.py
|   |   |   â”œâ”€â”€ cds.py
|   |   |   â”œâ”€â”€ connect.py
|   |   |   â”œâ”€â”€ core.py
|   |   |   â”œâ”€â”€ daophot.py
|   |   |   â”œâ”€â”€ docs.py
|   |   |   â”œâ”€â”€ ecsv.py
|   |   |   â”œâ”€â”€ fastbasic.py
|   |   |   â”œâ”€â”€ fixedwidth.py
|   |   |   â”œâ”€â”€ html.py
|   |   |   â”œâ”€â”€ ipac.py
|   |   |   â”œâ”€â”€ latex.py
|   |   |   â”œâ”€â”€ misc.py
|   |   |   â”œâ”€â”€ mrt.py
|   |   |   â”œâ”€â”€ qdp.py
|   |   |   â”œâ”€â”€ rst.py
|   |   |   â”œâ”€â”€ setup_package.py
|   |   |   â”œâ”€â”€ sextractor.py
|   |   |   â”œâ”€â”€ src
|   |   |   â”œâ”€â”€ tests
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ common.py
|   |   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ test_c_reader.py
|   |   |   |   â”œâ”€â”€ test_cds.py
|   |   |   |   â”œâ”€â”€ test_cds_header_from_readme.py
|   |   |   |   â”œâ”€â”€ test_compressed.py
|   |   |   |   â”œâ”€â”€ test_connect.py
|   |   |   |   â”œâ”€â”€ test_ecsv.py
|   |   |   |   â”œâ”€â”€ test_fixedwidth.py
|   |   |   |   â”œâ”€â”€ test_html.py
|   |   |   |   â”œâ”€â”€ test_ipac_definitions.py
|   |   |   |   â”œâ”€â”€ test_qdp.py
|   |   |   |   â”œâ”€â”€ test_read.py
|   |   |   |   â”œâ”€â”€ test_rst.py
|   |   |   |   â”œâ”€â”€ test_types.py
|   |   |   |   â””â”€â”€ test_write.py
|   |   |   â””â”€â”€ ui.py
|   |   â”œâ”€â”€ fits
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ card.py
|   |   |   â”œâ”€â”€ column.py
|   |   |   â”œâ”€â”€ connect.py
|   |   |   â”œâ”€â”€ convenience.py
|   |   |   â”œâ”€â”€ diff.py
|   |   |   â”œâ”€â”€ file.py
|   |   |   â”œâ”€â”€ fitsrec.py
|   |   |   â”œâ”€â”€ fitstime.py
|   |   |   â”œâ”€â”€ hdu
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ base.py
|   |   |   |   â”œâ”€â”€ compressed.py
|   |   |   |   â”œâ”€â”€ groups.py
|   |   |   |   â”œâ”€â”€ hdulist.py
|   |   |   |   â”œâ”€â”€ image.py
|   |   |   |   â”œâ”€â”€ nonstandard.py
|   |   |   |   â”œâ”€â”€ streaming.py
|   |   |   |   â””â”€â”€ table.py
|   |   |   â”œâ”€â”€ header.py
|   |   |   â”œâ”€â”€ scripts
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ fitscheck.py
|   |   |   |   â”œâ”€â”€ fitsdiff.py
|   |   |   |   â”œâ”€â”€ fitsheader.py
|   |   |   |   â””â”€â”€ fitsinfo.py
|   |   |   â”œâ”€â”€ setup_package.py
|   |   |   â”œâ”€â”€ src
|   |   |   â”œâ”€â”€ tests
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ test_checksum.py
|   |   |   |   â”œâ”€â”€ test_compression_failures.py
|   |   |   |   â”œâ”€â”€ test_connect.py
|   |   |   |   â”œâ”€â”€ test_convenience.py
|   |   |   |   â”œâ”€â”€ test_core.py
|   |   |   |   â”œâ”€â”€ test_diff.py
|   |   |   |   â”œâ”€â”€ test_division.py
|   |   |   |   â”œâ”€â”€ test_fitscheck.py
|   |   |   |   â”œâ”€â”€ test_fitsdiff.py
|   |   |   |   â”œâ”€â”€ test_fitsheader.py
|   |   |   |   â”œâ”€â”€ test_fitsinfo.py
|   |   |   |   â”œâ”€â”€ test_fitstime.py
|   |   |   |   â”œâ”€â”€ test_groups.py
|   |   |   |   â”œâ”€â”€ test_hdulist.py
|   |   |   |   â”œâ”€â”€ test_header.py
|   |   |   |   â”œâ”€â”€ test_image.py
|   |   |   |   â”œâ”€â”€ test_image_dask.py
|   |   |   |   â”œâ”€â”€ test_nonstandard.py
|   |   |   |   â”œâ”€â”€ test_structured.py
|   |   |   |   â”œâ”€â”€ test_table.py
|   |   |   |   â”œâ”€â”€ test_uint.py
|   |   |   |   â””â”€â”€ test_util.py
|   |   |   â”œâ”€â”€ util.py
|   |   |   â””â”€â”€ verify.py
|   |   â”œâ”€â”€ misc
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ asdf
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ conftest.py
|   |   |   |   â”œâ”€â”€ connect.py
|   |   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ deprecation.py
|   |   |   |   â”œâ”€â”€ extension.py
|   |   |   |   â”œâ”€â”€ tags
|   |   |   |   â”œâ”€â”€ tests
|   |   |   |   â””â”€â”€ types.py
|   |   |   â”œâ”€â”€ connect.py
|   |   |   â”œâ”€â”€ hdf5.py
|   |   |   â”œâ”€â”€ pandas
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â””â”€â”€ connect.py
|   |   |   â”œâ”€â”€ parquet.py
|   |   |   â”œâ”€â”€ pickle_helpers.py
|   |   |   â”œâ”€â”€ tests
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ test_hdf5.py
|   |   |   |   â”œâ”€â”€ test_pandas.py
|   |   |   |   â”œâ”€â”€ test_parquet.py
|   |   |   |   â”œâ”€â”€ test_pickle_helpers.py
|   |   |   |   â””â”€â”€ test_yaml.py
|   |   |   â””â”€â”€ yaml.py
|   |   â”œâ”€â”€ registry
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ base.py
|   |   |   â”œâ”€â”€ compat.py
|   |   |   â”œâ”€â”€ core.py
|   |   |   â”œâ”€â”€ interface.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â”œâ”€â”€ test_registries.py
|   |   |       â””â”€â”€ test_registry_help.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ mixin_columns.py
|   |   |   â””â”€â”€ safeio.py
|   |   â””â”€â”€ votable
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ connect.py
|   |       â”œâ”€â”€ converters.py
|   |       â”œâ”€â”€ data
|   |       |   â””â”€â”€ ucd1p-words.txt
|   |       â”œâ”€â”€ exceptions.py
|   |       â”œâ”€â”€ setup_package.py
|   |       â”œâ”€â”€ src
|   |       |   â””â”€â”€ tablewriter.c
|   |       â”œâ”€â”€ table.py
|   |       â”œâ”€â”€ tests
|   |       |   â”œâ”€â”€ __init__.py
|   |       |   â”œâ”€â”€ converter_test.py
|   |       |   â”œâ”€â”€ data
|   |       |   â”œâ”€â”€ exception_test.py
|   |       |   â”œâ”€â”€ resource_test.py
|   |       |   â”œâ”€â”€ table_test.py
|   |       |   â”œâ”€â”€ tree_test.py
|   |       |   â”œâ”€â”€ ucd_test.py
|   |       |   â”œâ”€â”€ util_test.py
|   |       |   â””â”€â”€ vo_test.py
|   |       â”œâ”€â”€ tree.py
|   |       â”œâ”€â”€ ucd.py
|   |       â”œâ”€â”€ util.py
|   |       â”œâ”€â”€ validator
|   |       |   â”œâ”€â”€ __init__.py
|   |       |   â”œâ”€â”€ data
|   |       |   â”œâ”€â”€ html.py
|   |       |   â”œâ”€â”€ main.py
|   |       |   â””â”€â”€ result.py
|   |       â”œâ”€â”€ volint.py
|   |       â””â”€â”€ xmlutil.py
|   â”œâ”€â”€ logger.py
|   â”œâ”€â”€ modeling
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ bounding_box.py
|   |   â”œâ”€â”€ convolution.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ fitting.py
|   |   â”œâ”€â”€ functional_models.py
|   |   â”œâ”€â”€ mappings.py
|   |   â”œâ”€â”€ math_functions.py
|   |   â”œâ”€â”€ models.py
|   |   â”œâ”€â”€ optimizers.py
|   |   â”œâ”€â”€ parameters.py
|   |   â”œâ”€â”€ physical_models.py
|   |   â”œâ”€â”€ polynomial.py
|   |   â”œâ”€â”€ powerlaws.py
|   |   â”œâ”€â”€ projections.py
|   |   â”œâ”€â”€ rotations.py
|   |   â”œâ”€â”€ separable.py
|   |   â”œâ”€â”€ spline.py
|   |   â”œâ”€â”€ statistic.py
|   |   â”œâ”€â”€ tabular.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â””â”€â”€ spec.txt
|   |   |   â”œâ”€â”€ example_models.py
|   |   |   â”œâ”€â”€ irafutil.py
|   |   |   â”œâ”€â”€ test_bounding_box.py
|   |   |   â”œâ”€â”€ test_compound.py
|   |   |   â”œâ”€â”€ test_constraints.py
|   |   |   â”œâ”€â”€ test_convolution.py
|   |   |   â”œâ”€â”€ test_core.py
|   |   |   â”œâ”€â”€ test_fitters.py
|   |   |   â”œâ”€â”€ test_functional_models.py
|   |   |   â”œâ”€â”€ test_input.py
|   |   |   â”œâ”€â”€ test_mappings.py
|   |   |   â”œâ”€â”€ test_math_func.py
|   |   |   â”œâ”€â”€ test_model_sets.py
|   |   |   â”œâ”€â”€ test_models.py
|   |   |   â”œâ”€â”€ test_models_quantities.py
|   |   |   â”œâ”€â”€ test_parameters.py
|   |   |   â”œâ”€â”€ test_physical_models.py
|   |   |   â”œâ”€â”€ test_polynomial.py
|   |   |   â”œâ”€â”€ test_projections.py
|   |   |   â”œâ”€â”€ test_quantities_evaluation.py
|   |   |   â”œâ”€â”€ test_quantities_fitting.py
|   |   |   â”œâ”€â”€ test_quantities_model.py
|   |   |   â”œâ”€â”€ test_quantities_parameters.py
|   |   |   â”œâ”€â”€ test_quantities_rotations.py
|   |   |   â”œâ”€â”€ test_rotations.py
|   |   |   â”œâ”€â”€ test_separable.py
|   |   |   â”œâ”€â”€ test_spline.py
|   |   |   â”œâ”€â”€ test_statistics.py
|   |   |   â”œâ”€â”€ test_units_mapping.py
|   |   |   â””â”€â”€ test_utils.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ nddata
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ _testing.py
|   |   â”œâ”€â”€ bitmask.py
|   |   â”œâ”€â”€ blocks.py
|   |   â”œâ”€â”€ ccddata.py
|   |   â”œâ”€â”€ compat.py
|   |   â”œâ”€â”€ decorators.py
|   |   â”œâ”€â”€ flag_collection.py
|   |   â”œâ”€â”€ mixins
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ ndarithmetic.py
|   |   |   â”œâ”€â”€ ndio.py
|   |   |   â”œâ”€â”€ ndslicing.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â”œâ”€â”€ test_ndarithmetic.py
|   |   |       â”œâ”€â”€ test_ndio.py
|   |   |       â””â”€â”€ test_ndslicing.py
|   |   â”œâ”€â”€ nddata.py
|   |   â”œâ”€â”€ nddata_base.py
|   |   â”œâ”€â”€ nddata_withmixins.py
|   |   â”œâ”€â”€ nduncertainty.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ data
|   |   |   â”œâ”€â”€ test_bitmask.py
|   |   |   â”œâ”€â”€ test_blocks.py
|   |   |   â”œâ”€â”€ test_ccddata.py
|   |   |   â”œâ”€â”€ test_compat.py
|   |   |   â”œâ”€â”€ test_decorators.py
|   |   |   â”œâ”€â”€ test_flag_collection.py
|   |   |   â”œâ”€â”€ test_nddata.py
|   |   |   â”œâ”€â”€ test_nddata_base.py
|   |   |   â”œâ”€â”€ test_nduncertainty.py
|   |   |   â””â”€â”€ test_utils.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ samp
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ client.py
|   |   â”œâ”€â”€ constants.py
|   |   â”œâ”€â”€ data
|   |   â”œâ”€â”€ errors.py
|   |   â”œâ”€â”€ hub.py
|   |   â”œâ”€â”€ hub_proxy.py
|   |   â”œâ”€â”€ hub_script.py
|   |   â”œâ”€â”€ integrated_client.py
|   |   â”œâ”€â”€ lockfile_helpers.py
|   |   â”œâ”€â”€ setup_package.py
|   |   â”œâ”€â”€ standard_profile.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ test_client.py
|   |   |   â”œâ”€â”€ test_errors.py
|   |   |   â”œâ”€â”€ test_helpers.py
|   |   |   â”œâ”€â”€ test_hub.py
|   |   |   â”œâ”€â”€ test_hub_proxy.py
|   |   |   â”œâ”€â”€ test_hub_script.py
|   |   |   â”œâ”€â”€ test_standard_profile.py
|   |   |   â”œâ”€â”€ test_web_profile.py
|   |   |   â””â”€â”€ web_profile_test_helpers.py
|   |   â”œâ”€â”€ utils.py
|   |   â””â”€â”€ web_profile.py
|   â”œâ”€â”€ stats
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ bayesian_blocks.py
|   |   â”œâ”€â”€ biweight.py
|   |   â”œâ”€â”€ bls
|   |   |   â””â”€â”€ __init__.py
|   |   â”œâ”€â”€ circstats.py
|   |   â”œâ”€â”€ funcs.py
|   |   â”œâ”€â”€ histogram.py
|   |   â”œâ”€â”€ info_theory.py
|   |   â”œâ”€â”€ jackknife.py
|   |   â”œâ”€â”€ lombscargle
|   |   |   â””â”€â”€ __init__.py
|   |   â”œâ”€â”€ setup_package.py
|   |   â”œâ”€â”€ sigma_clipping.py
|   |   â”œâ”€â”€ spatial.py
|   |   â”œâ”€â”€ src
|   |   |   â”œâ”€â”€ compute_bounds.c
|   |   |   â”œâ”€â”€ fast_sigma_clip.c
|   |   |   â””â”€â”€ wirth_select.c
|   |   â””â”€â”€ tests
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ test_bayesian_blocks.py
|   |       â”œâ”€â”€ test_biweight.py
|   |       â”œâ”€â”€ test_circstats.py
|   |       â”œâ”€â”€ test_funcs.py
|   |       â”œâ”€â”€ test_histogram.py
|   |       â”œâ”€â”€ test_info_theory.py
|   |       â”œâ”€â”€ test_jackknife.py
|   |       â”œâ”€â”€ test_sigma_clipping.py
|   |       â””â”€â”€ test_spatial.py
|   â”œâ”€â”€ table
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ bst.py
|   |   â”œâ”€â”€ column.py
|   |   â”œâ”€â”€ connect.py
|   |   â”œâ”€â”€ groups.py
|   |   â”œâ”€â”€ index.py
|   |   â”œâ”€â”€ info.py
|   |   â”œâ”€â”€ jsviewer.py
|   |   â”œâ”€â”€ meta.py
|   |   â”œâ”€â”€ mixins
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ dask.py
|   |   |   â”œâ”€â”€ registry.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â”œâ”€â”€ test_dask.py
|   |   |       â””â”€â”€ test_registry.py
|   |   â”œâ”€â”€ ndarray_mixin.py
|   |   â”œâ”€â”€ np_utils.py
|   |   â”œâ”€â”€ operations.py
|   |   â”œâ”€â”€ pandas.py
|   |   â”œâ”€â”€ pprint.py
|   |   â”œâ”€â”€ row.py
|   |   â”œâ”€â”€ scripts
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â””â”€â”€ showtable.py
|   |   â”œâ”€â”€ serialize.py
|   |   â”œâ”€â”€ setup_package.py
|   |   â”œâ”€â”€ soco.py
|   |   â”œâ”€â”€ sorted_array.py
|   |   â”œâ”€â”€ table.py
|   |   â”œâ”€â”€ table_helpers.py
|   |   â””â”€â”€ tests
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ conftest.py
|   |       â”œâ”€â”€ test_array.py
|   |       â”œâ”€â”€ test_bst.py
|   |       â”œâ”€â”€ test_column.py
|   |       â”œâ”€â”€ test_groups.py
|   |       â”œâ”€â”€ test_index.py
|   |       â”œâ”€â”€ test_info.py
|   |       â”œâ”€â”€ test_init_table.py
|   |       â”œâ”€â”€ test_item_access.py
|   |       â”œâ”€â”€ test_jsviewer.py
|   |       â”œâ”€â”€ test_masked.py
|   |       â”œâ”€â”€ test_mixin.py
|   |       â”œâ”€â”€ test_np_utils.py
|   |       â”œâ”€â”€ test_operations.py
|   |       â”œâ”€â”€ test_pickle.py
|   |       â”œâ”€â”€ test_pprint.py
|   |       â”œâ”€â”€ test_row.py
|   |       â”œâ”€â”€ test_showtable.py
|   |       â”œâ”€â”€ test_subclass.py
|   |       â””â”€â”€ test_table.py
|   â”œâ”€â”€ tests
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ command.py
|   |   â”œâ”€â”€ helper.py
|   |   â”œâ”€â”€ image_tests.py
|   |   â”œâ”€â”€ runner.py
|   |   â”œâ”€â”€ test_logger.py
|   |   â””â”€â”€ tests
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ test_imports.py
|   |       â”œâ”€â”€ test_quantity_helpers.py
|   |       â”œâ”€â”€ test_run_tests.py
|   |       â””â”€â”€ test_runner.py
|   â”œâ”€â”€ time
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ formats.py
|   |   â”œâ”€â”€ setup_package.py
|   |   â”œâ”€â”€ src
|   |   |   â””â”€â”€ parse_times.c
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ test_basic.py
|   |   |   â”œâ”€â”€ test_comparisons.py
|   |   |   â”œâ”€â”€ test_corrs.py
|   |   |   â”œâ”€â”€ test_custom_formats.py
|   |   |   â”œâ”€â”€ test_delta.py
|   |   |   â”œâ”€â”€ test_fast_parser.py
|   |   |   â”œâ”€â”€ test_functions.py
|   |   |   â”œâ”€â”€ test_guess.py
|   |   |   â”œâ”€â”€ test_mask.py
|   |   |   â”œâ”€â”€ test_methods.py
|   |   |   â”œâ”€â”€ test_pickle.py
|   |   |   â”œâ”€â”€ test_precision.py
|   |   |   â”œâ”€â”€ test_quantity_interaction.py
|   |   |   â”œâ”€â”€ test_sidereal.py
|   |   |   â”œâ”€â”€ test_update_leap_seconds.py
|   |   |   â””â”€â”€ test_ut1.py
|   |   â”œâ”€â”€ time_helper
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â””â”€â”€ function_helpers.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ timeseries
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ binned.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ downsample.py
|   |   â”œâ”€â”€ io
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ kepler.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â””â”€â”€ test_kepler.py
|   |   â”œâ”€â”€ periodograms
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ base.py
|   |   |   â”œâ”€â”€ bls
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ core.py
|   |   |   |   â”œâ”€â”€ methods.py
|   |   |   |   â”œâ”€â”€ setup_package.py
|   |   |   |   â””â”€â”€ tests
|   |   |   â””â”€â”€ lombscargle
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â”œâ”€â”€ _statistics.py
|   |   |       â”œâ”€â”€ core.py
|   |   |       â”œâ”€â”€ implementations
|   |   |       â”œâ”€â”€ tests
|   |   |       â””â”€â”€ utils.py
|   |   â”œâ”€â”€ sampled.py
|   |   â””â”€â”€ tests
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ data
|   |       â”œâ”€â”€ test_binned.py
|   |       â”œâ”€â”€ test_common.py
|   |       â”œâ”€â”€ test_downsample.py
|   |       â””â”€â”€ test_sampled.py
|   â”œâ”€â”€ uncertainty
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ distributions.py
|   |   â””â”€â”€ tests
|   |       â”œâ”€â”€ __init__.py
|   |       â””â”€â”€ test_distribution.py
|   â”œâ”€â”€ units
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ _typing.py
|   |   â”œâ”€â”€ astrophys.py
|   |   â”œâ”€â”€ cds.py
|   |   â”œâ”€â”€ cgs.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ decorators.py
|   |   â”œâ”€â”€ deprecated.py
|   |   â”œâ”€â”€ equivalencies.py
|   |   â”œâ”€â”€ format
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ base.py
|   |   |   â”œâ”€â”€ cds.py
|   |   |   â”œâ”€â”€ cds_lextab.py
|   |   |   â”œâ”€â”€ cds_parsetab.py
|   |   |   â”œâ”€â”€ console.py
|   |   |   â”œâ”€â”€ fits.py
|   |   |   â”œâ”€â”€ generic.py
|   |   |   â”œâ”€â”€ generic_lextab.py
|   |   |   â”œâ”€â”€ generic_parsetab.py
|   |   |   â”œâ”€â”€ latex.py
|   |   |   â”œâ”€â”€ ogip.py
|   |   |   â”œâ”€â”€ ogip_lextab.py
|   |   |   â”œâ”€â”€ ogip_parsetab.py
|   |   |   â”œâ”€â”€ unicode_format.py
|   |   |   â”œâ”€â”€ utils.py
|   |   |   â””â”€â”€ vounit.py
|   |   â”œâ”€â”€ function
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ core.py
|   |   |   â”œâ”€â”€ logarithmic.py
|   |   |   â”œâ”€â”€ mixin.py
|   |   |   â””â”€â”€ units.py
|   |   â”œâ”€â”€ imperial.py
|   |   â”œâ”€â”€ misc.py
|   |   â”œâ”€â”€ photometric.py
|   |   â”œâ”€â”€ physical.py
|   |   â”œâ”€â”€ quantity.py
|   |   â”œâ”€â”€ quantity_helper
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ converters.py
|   |   |   â”œâ”€â”€ erfa.py
|   |   |   â”œâ”€â”€ function_helpers.py
|   |   |   â”œâ”€â”€ helpers.py
|   |   |   â””â”€â”€ scipy_special.py
|   |   â”œâ”€â”€ required_by_vounit.py
|   |   â”œâ”€â”€ si.py
|   |   â”œâ”€â”€ structured.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ test_aliases.py
|   |   |   â”œâ”€â”€ test_deprecated.py
|   |   |   â”œâ”€â”€ test_equivalencies.py
|   |   |   â”œâ”€â”€ test_format.py
|   |   |   â”œâ”€â”€ test_logarithmic.py
|   |   |   â”œâ”€â”€ test_photometric.py
|   |   |   â”œâ”€â”€ test_physical.py
|   |   |   â”œâ”€â”€ test_quantity.py
|   |   |   â”œâ”€â”€ test_quantity_annotations.py
|   |   |   â”œâ”€â”€ test_quantity_array_methods.py
|   |   |   â”œâ”€â”€ test_quantity_decorator.py
|   |   |   â”œâ”€â”€ test_quantity_helpers.py
|   |   |   â”œâ”€â”€ test_quantity_non_ufuncs.py
|   |   |   â”œâ”€â”€ test_quantity_typing.py
|   |   |   â”œâ”€â”€ test_quantity_ufuncs.py
|   |   |   â”œâ”€â”€ test_structured.py
|   |   |   â”œâ”€â”€ test_structured_erfa_ufuncs.py
|   |   |   â”œâ”€â”€ test_units.py
|   |   |   â””â”€â”€ test_utils.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ utils
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ argparse.py
|   |   â”œâ”€â”€ codegen.py
|   |   â”œâ”€â”€ collections.py
|   |   â”œâ”€â”€ compat
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ misc.py
|   |   |   â”œâ”€â”€ numpycompat.py
|   |   |   â””â”€â”€ optional_deps.py
|   |   â”œâ”€â”€ console.py
|   |   â”œâ”€â”€ data.py
|   |   â”œâ”€â”€ data_info.py
|   |   â”œâ”€â”€ decorators.py
|   |   â”œâ”€â”€ diff.py
|   |   â”œâ”€â”€ exceptions.py
|   |   â”œâ”€â”€ iers
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ data
|   |   |   |   â””â”€â”€ update_builtin_iers.sh
|   |   |   â”œâ”€â”€ iers.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â”œâ”€â”€ data
|   |   |       â”œâ”€â”€ test_iers.py
|   |   |       â””â”€â”€ test_leap_second.py
|   |   â”œâ”€â”€ introspection.py
|   |   â”œâ”€â”€ masked
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ core.py
|   |   |   â”œâ”€â”€ function_helpers.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â”œâ”€â”€ test_containers.py
|   |   |       â”œâ”€â”€ test_function_helpers.py
|   |   |       â”œâ”€â”€ test_functions.py
|   |   |       â”œâ”€â”€ test_masked.py
|   |   |       â””â”€â”€ test_table.py
|   |   â”œâ”€â”€ metadata.py
|   |   â”œâ”€â”€ misc.py
|   |   â”œâ”€â”€ parsing.py
|   |   â”œâ”€â”€ setup_package.py
|   |   â”œâ”€â”€ shapes.py
|   |   â”œâ”€â”€ src
|   |   |   â””â”€â”€ compiler.c
|   |   â”œâ”€â”€ state.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ .hidden_file.txt
|   |   |   |   â”œâ”€â”€ dataurl
|   |   |   |   â”œâ”€â”€ dataurl_mirror
|   |   |   |   â”œâ”€â”€ test_package
|   |   |   |   â””â”€â”€ unicode.txt
|   |   |   â”œâ”€â”€ test_codegen.py
|   |   |   â”œâ”€â”€ test_collections.py
|   |   |   â”œâ”€â”€ test_console.py
|   |   |   â”œâ”€â”€ test_data.py
|   |   |   â”œâ”€â”€ test_data_info.py
|   |   |   â”œâ”€â”€ test_decorators.py
|   |   |   â”œâ”€â”€ test_diff.py
|   |   |   â”œâ”€â”€ test_introspection.py
|   |   |   â”œâ”€â”€ test_metadata.py
|   |   |   â”œâ”€â”€ test_misc.py
|   |   |   â”œâ”€â”€ test_parsing.py
|   |   |   â”œâ”€â”€ test_progress_bar_func.py
|   |   |   â”œâ”€â”€ test_shapes.py
|   |   |   â”œâ”€â”€ test_state.py
|   |   |   â””â”€â”€ test_xml.py
|   |   â””â”€â”€ xml
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ check.py
|   |       â”œâ”€â”€ iterparser.py
|   |       â”œâ”€â”€ setup_package.py
|   |       â”œâ”€â”€ src
|   |       |   â””â”€â”€ iterparse.c
|   |       â”œâ”€â”€ tests
|   |       |   â”œâ”€â”€ __init__.py
|   |       |   â””â”€â”€ test_iterparse.py
|   |       â”œâ”€â”€ unescaper.py
|   |       â”œâ”€â”€ validate.py
|   |       â””â”€â”€ writer.py
|   â”œâ”€â”€ version.py
|   â”œâ”€â”€ visualization
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ hist.py
|   |   â”œâ”€â”€ interval.py
|   |   â”œâ”€â”€ lupton_rgb.py
|   |   â”œâ”€â”€ mpl_normalize.py
|   |   â”œâ”€â”€ mpl_style.py
|   |   â”œâ”€â”€ scripts
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ fits2bitmap.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â””â”€â”€ test_fits2bitmap.py
|   |   â”œâ”€â”€ stretch.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ test_histogram.py
|   |   |   â”œâ”€â”€ test_interval.py
|   |   |   â”œâ”€â”€ test_lupton_rgb.py
|   |   |   â”œâ”€â”€ test_norm.py
|   |   |   â”œâ”€â”€ test_stretch.py
|   |   |   â”œâ”€â”€ test_time.py
|   |   |   â””â”€â”€ test_units.py
|   |   â”œâ”€â”€ time.py
|   |   â”œâ”€â”€ transform.py
|   |   â”œâ”€â”€ units.py
|   |   â””â”€â”€ wcsaxes
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ axislabels.py
|   |       â”œâ”€â”€ coordinate_helpers.py
|   |       â”œâ”€â”€ coordinate_range.py
|   |       â”œâ”€â”€ coordinates_map.py
|   |       â”œâ”€â”€ core.py
|   |       â”œâ”€â”€ formatter_locator.py
|   |       â”œâ”€â”€ frame.py
|   |       â”œâ”€â”€ grid_paths.py
|   |       â”œâ”€â”€ patches.py
|   |       â”œâ”€â”€ tests
|   |       |   â”œâ”€â”€ __init__.py
|   |       |   â”œâ”€â”€ data
|   |       |   â”œâ”€â”€ test_coordinate_helpers.py
|   |       |   â”œâ”€â”€ test_display_world_coordinates.py
|   |       |   â”œâ”€â”€ test_formatter_locator.py
|   |       |   â”œâ”€â”€ test_frame.py
|   |       |   â”œâ”€â”€ test_grid_paths.py
|   |       |   â”œâ”€â”€ test_images.py
|   |       |   â”œâ”€â”€ test_misc.py
|   |       |   â”œâ”€â”€ test_transform_coord_meta.py
|   |       |   â”œâ”€â”€ test_transforms.py
|   |       |   â”œâ”€â”€ test_utils.py
|   |       |   â””â”€â”€ test_wcsapi.py
|   |       â”œâ”€â”€ ticklabels.py
|   |       â”œâ”€â”€ ticks.py
|   |       â”œâ”€â”€ transforms.py
|   |       â”œâ”€â”€ utils.py
|   |       â””â”€â”€ wcsapi.py
|   â””â”€â”€ wcs
|       â”œâ”€â”€ __init__.py
|       â”œâ”€â”€ docstrings.py
|       â”œâ”€â”€ include
|       |   â”œâ”€â”€ astropy_wcs
|       |   â””â”€â”€ wcslib
|       â”œâ”€â”€ setup_package.py
|       â”œâ”€â”€ src
|       |   â”œâ”€â”€ astropy_wcs.c
|       |   â”œâ”€â”€ astropy_wcs_api.c
|       |   â”œâ”€â”€ distortion.c
|       |   â”œâ”€â”€ distortion_wrap.c
|       |   â”œâ”€â”€ pipeline.c
|       |   â”œâ”€â”€ pyutil.c
|       |   â”œâ”€â”€ sip.c
|       |   â”œâ”€â”€ sip_wrap.c
|       |   â”œâ”€â”€ str_list_proxy.c
|       |   â”œâ”€â”€ unit_list_proxy.c
|       |   â”œâ”€â”€ util.c
|       |   â”œâ”€â”€ wcslib_auxprm_wrap.c
|       |   â”œâ”€â”€ wcslib_celprm_wrap.c
|       |   â”œâ”€â”€ wcslib_prjprm_wrap.c
|       |   â”œâ”€â”€ wcslib_tabprm_wrap.c
|       |   â”œâ”€â”€ wcslib_wrap.c
|       |   â””â”€â”€ wcslib_wtbarr_wrap.c
|       â”œâ”€â”€ tests
|       |   â”œâ”€â”€ __init__.py
|       |   â”œâ”€â”€ conftest.py
|       |   â”œâ”€â”€ data
|       |   |   â”œâ”€â”€ maps
|       |   |   â”œâ”€â”€ spectra
|       |   |   â”œâ”€â”€ validate.5.0.txt
|       |   |   â”œâ”€â”€ validate.5.13.txt
|       |   |   â”œâ”€â”€ validate.6.txt
|       |   |   â”œâ”€â”€ validate.7.4.txt
|       |   |   â”œâ”€â”€ validate.7.6.txt
|       |   |   â””â”€â”€ validate.txt
|       |   â”œâ”€â”€ helper.py
|       |   â”œâ”€â”€ test_auxprm.py
|       |   â”œâ”€â”€ test_celprm.py
|       |   â”œâ”€â”€ test_pickle.py
|       |   â”œâ”€â”€ test_prjprm.py
|       |   â”œâ”€â”€ test_profiling.py
|       |   â”œâ”€â”€ test_tab.py
|       |   â”œâ”€â”€ test_tabprm.py
|       |   â”œâ”€â”€ test_utils.py
|       |   â”œâ”€â”€ test_wcs.py
|       |   â”œâ”€â”€ test_wcsprm.py
|       |   â””â”€â”€ test_wtbarr.py
|       â”œâ”€â”€ utils.py
|       â”œâ”€â”€ wcs.py
|       â”œâ”€â”€ wcsapi
|       |   â”œâ”€â”€ __init__.py
|       |   â”œâ”€â”€ conftest.py
|       |   â”œâ”€â”€ data
|       |   |   â””â”€â”€ ucds.txt
|       |   â”œâ”€â”€ fitswcs.py
|       |   â”œâ”€â”€ high_level_api.py
|       |   â”œâ”€â”€ high_level_wcs_wrapper.py
|       |   â”œâ”€â”€ low_level_api.py
|       |   â”œâ”€â”€ sliced_low_level_wcs.py
|       |   â”œâ”€â”€ tests
|       |   |   â”œâ”€â”€ __init__.py
|       |   |   â”œâ”€â”€ test_fitswcs.py
|       |   |   â”œâ”€â”€ test_high_level_api.py
|       |   |   â”œâ”€â”€ test_high_level_wcs_wrapper.py
|       |   |   â”œâ”€â”€ test_low_level_api.py
|       |   |   â””â”€â”€ test_utils.py
|       |   â”œâ”€â”€ utils.py
|       |   â””â”€â”€ wrappers
|       |       â”œâ”€â”€ __init__.py
|       |       â”œâ”€â”€ base.py
|       |       â”œâ”€â”€ sliced_wcs.py
|       |       â””â”€â”€ tests
|       â””â”€â”€ wcslint.py
â”œâ”€â”€ azure-pipelines.yml
â”œâ”€â”€ cextern
|   â”œâ”€â”€ README.rst
|   â”œâ”€â”€ cfitsio
|   |   â”œâ”€â”€ License.txt
|   |   â”œâ”€â”€ README.txt
|   |   â”œâ”€â”€ docs
|   |   |   â””â”€â”€ changes.txt
|   |   â”œâ”€â”€ lib
|   |   |   â”œâ”€â”€ buffers.c
|   |   |   â”œâ”€â”€ cfileio.c
|   |   |   â”œâ”€â”€ checksum.c
|   |   |   â”œâ”€â”€ drvrfile.c
|   |   |   â”œâ”€â”€ drvrmem.c
|   |   |   â”œâ”€â”€ drvrnet.c
|   |   |   â”œâ”€â”€ drvrsmem.c
|   |   |   â”œâ”€â”€ editcol.c
|   |   |   â”œâ”€â”€ edithdu.c
|   |   |   â”œâ”€â”€ eval_f.c
|   |   |   â”œâ”€â”€ eval_l.c
|   |   |   â”œâ”€â”€ eval_y.c
|   |   |   â”œâ”€â”€ fits_hcompress.c
|   |   |   â”œâ”€â”€ fits_hdecompress.c
|   |   |   â”œâ”€â”€ fitscore.c
|   |   |   â”œâ”€â”€ getcol.c
|   |   |   â”œâ”€â”€ getcolb.c
|   |   |   â”œâ”€â”€ getcold.c
|   |   |   â”œâ”€â”€ getcole.c
|   |   |   â”œâ”€â”€ getcoli.c
|   |   |   â”œâ”€â”€ getcolj.c
|   |   |   â”œâ”€â”€ getcolk.c
|   |   |   â”œâ”€â”€ getcoll.c
|   |   |   â”œâ”€â”€ getcols.c
|   |   |   â”œâ”€â”€ getcolsb.c
|   |   |   â”œâ”€â”€ getcolui.c
|   |   |   â”œâ”€â”€ getcoluj.c
|   |   |   â”œâ”€â”€ getcoluk.c
|   |   |   â”œâ”€â”€ getkey.c
|   |   |   â”œâ”€â”€ group.c
|   |   |   â”œâ”€â”€ grparser.c
|   |   |   â”œâ”€â”€ histo.c
|   |   |   â”œâ”€â”€ imcompress.c
|   |   |   â”œâ”€â”€ iraffits.c
|   |   |   â”œâ”€â”€ modkey.c
|   |   |   â”œâ”€â”€ pliocomp.c
|   |   |   â”œâ”€â”€ putcol.c
|   |   |   â”œâ”€â”€ putcolb.c
|   |   |   â”œâ”€â”€ putcold.c
|   |   |   â”œâ”€â”€ putcole.c
|   |   |   â”œâ”€â”€ putcoli.c
|   |   |   â”œâ”€â”€ putcolj.c
|   |   |   â”œâ”€â”€ putcolk.c
|   |   |   â”œâ”€â”€ putcoll.c
|   |   |   â”œâ”€â”€ putcols.c
|   |   |   â”œâ”€â”€ putcolsb.c
|   |   |   â”œâ”€â”€ putcolu.c
|   |   |   â”œâ”€â”€ putcolui.c
|   |   |   â”œâ”€â”€ putcoluj.c
|   |   |   â”œâ”€â”€ putcoluk.c
|   |   |   â”œâ”€â”€ putkey.c
|   |   |   â”œâ”€â”€ quantize.c
|   |   |   â”œâ”€â”€ region.c
|   |   |   â”œâ”€â”€ ricecomp.c
|   |   |   â”œâ”€â”€ scalnull.c
|   |   |   â”œâ”€â”€ simplerng.c
|   |   |   â”œâ”€â”€ swapproc.c
|   |   |   â”œâ”€â”€ wcssub.c
|   |   |   â”œâ”€â”€ wcsutil.c
|   |   |   â”œâ”€â”€ zcompress.c
|   |   |   â””â”€â”€ zuncompress.c
|   |   â””â”€â”€ zlib
|   |       â”œâ”€â”€ adler32.c
|   |       â”œâ”€â”€ crc32.c
|   |       â”œâ”€â”€ deflate.c
|   |       â”œâ”€â”€ infback.c
|   |       â”œâ”€â”€ inffast.c
|   |       â”œâ”€â”€ inflate.c
|   |       â”œâ”€â”€ inftrees.c
|   |       â”œâ”€â”€ trees.c
|   |       â”œâ”€â”€ uncompr.c
|   |       â””â”€â”€ zutil.c
|   â”œâ”€â”€ expat
|   |   â”œâ”€â”€ README.md
|   |   â”œâ”€â”€ README.txt
|   |   â””â”€â”€ lib
|   |       â”œâ”€â”€ xmlparse.c
|   |       â”œâ”€â”€ xmlrole.c
|   |       â”œâ”€â”€ xmltok.c
|   |       â”œâ”€â”€ xmltok_impl.c
|   |       â””â”€â”€ xmltok_ns.c
|   â”œâ”€â”€ trim_cfitsio.sh
|   â”œâ”€â”€ trim_expat.sh
|   â”œâ”€â”€ trim_wcslib.sh
|   â””â”€â”€ wcslib
|       â”œâ”€â”€ C
|       |   â”œâ”€â”€ cel.c
|       |   â”œâ”€â”€ dis.c
|       |   â”œâ”€â”€ flexed
|       |   |   â”œâ”€â”€ fitshdr.c
|       |   |   â”œâ”€â”€ wcsbth.c
|       |   |   â”œâ”€â”€ wcspih.c
|       |   |   â”œâ”€â”€ wcsulex.c
|       |   |   â””â”€â”€ wcsutrn.c
|       |   â”œâ”€â”€ getwcstab.c
|       |   â”œâ”€â”€ lin.c
|       |   â”œâ”€â”€ log.c
|       |   â”œâ”€â”€ prj.c
|       |   â”œâ”€â”€ spc.c
|       |   â”œâ”€â”€ sph.c
|       |   â”œâ”€â”€ spx.c
|       |   â”œâ”€â”€ tab.c
|       |   â”œâ”€â”€ wcs.c
|       |   â”œâ”€â”€ wcserr.c
|       |   â”œâ”€â”€ wcsfix.c
|       |   â”œâ”€â”€ wcshdr.c
|       |   â”œâ”€â”€ wcsprintf.c
|       |   â”œâ”€â”€ wcstrig.c
|       |   â”œâ”€â”€ wcsunits.c
|       |   â””â”€â”€ wcsutil.c
|       â””â”€â”€ config
â”œâ”€â”€ codecov.yml
â”œâ”€â”€ conftest.py
â”œâ”€â”€ docs
|   â”œâ”€â”€ _pkgtemplate.rst
|   â”œâ”€â”€ _static
|   â”œâ”€â”€ _templates
|   â”œâ”€â”€ changelog.rst
|   â”œâ”€â”€ changes
|   |   â”œâ”€â”€ README.rst
|   |   â”œâ”€â”€ config
|   |   â”œâ”€â”€ constants
|   |   â”œâ”€â”€ convolution
|   |   â”œâ”€â”€ coordinates
|   |   |   â”œâ”€â”€ 12541.feature.rst
|   |   |   â”œâ”€â”€ 12721.bugfix.rst
|   |   |   â”œâ”€â”€ 13056.feature.rst
|   |   |   â””â”€â”€ 13162.api.rst
|   |   â”œâ”€â”€ cosmology
|   |   |   â”œâ”€â”€ 12279.feature.rst
|   |   |   â”œâ”€â”€ 12313.feature.rst
|   |   |   â”œâ”€â”€ 12354.api.rst
|   |   |   â”œâ”€â”€ 12375.api.rst
|   |   |   â”œâ”€â”€ 12479.feature.rst
|   |   |   â”œâ”€â”€ 12590.feature.rst
|   |   |   â”œâ”€â”€ 12606.feature.rst
|   |   |   â”œâ”€â”€ 12612.api.rst
|   |   |   â”œâ”€â”€ 12624.api.rst
|   |   |   â”œâ”€â”€ 12710.feature.rst
|   |   |   â”œâ”€â”€ 12736.feature.rst
|   |   |   â”œâ”€â”€ 12740.feature.rst
|   |   |   â”œâ”€â”€ 12746.api.rst
|   |   |   â”œâ”€â”€ 12966.feature.rst
|   |   |   â”œâ”€â”€ 13072.api.rst
|   |   |   â”œâ”€â”€ 13076.feature.rst
|   |   |   â”œâ”€â”€ 13099.feature.rst
|   |   |   â””â”€â”€ 13129.feature.rst
|   |   â”œâ”€â”€ extern
|   |   â”œâ”€â”€ io.ascii
|   |   |   â”œâ”€â”€ 12631.bugfix.rst
|   |   |   â”œâ”€â”€ 12841.api.rst
|   |   |   â”œâ”€â”€ 12842.bugfix.rst
|   |   |   â”œâ”€â”€ 13073.feature.rst
|   |   |   â””â”€â”€ 13130.feature.rst
|   |   â”œâ”€â”€ io.fits
|   |   |   â”œâ”€â”€ 11843.feature.rst
|   |   |   â”œâ”€â”€ 12081.feature.rst
|   |   |   â”œâ”€â”€ 12110.feature.rst
|   |   |   â”œâ”€â”€ 12258.api.rst
|   |   |   â”œâ”€â”€ 12544.bugfix.rst
|   |   |   â”œâ”€â”€ 13102.bugfix.rst
|   |   |   â””â”€â”€ 13106.api.rst
|   |   â”œâ”€â”€ io.misc
|   |   |   â”œâ”€â”€ 10198.feature.rst
|   |   |   â”œâ”€â”€ 12279.feature.rst
|   |   |   â”œâ”€â”€ 12895.feature.rst
|   |   |   â”œâ”€â”€ 12897.feature.rst
|   |   |   â”œâ”€â”€ 12903.api.rst
|   |   |   â””â”€â”€ 12930.api.rst
|   |   â”œâ”€â”€ io.registry
|   |   |   â””â”€â”€ 13129.feature.rst
|   |   â”œâ”€â”€ io.votable
|   |   â”œâ”€â”€ modeling
|   |   |   â”œâ”€â”€ 12051.feature.rst
|   |   |   â”œâ”€â”€ 12384.feature.rst
|   |   |   â”œâ”€â”€ 12558.feature.rst
|   |   |   â”œâ”€â”€ 12585.api.rst
|   |   |   â”œâ”€â”€ 12811.feature.rst
|   |   |   â”œâ”€â”€ 13030.feature.rst
|   |   |   â”œâ”€â”€ 13032.bugfix.rst
|   |   |   â””â”€â”€ 13116.feature.rst
|   |   â”œâ”€â”€ nddata
|   |   |   â”œâ”€â”€ 12057.feature.rst
|   |   |   â”œâ”€â”€ 12962.feature.rst
|   |   |   â””â”€â”€ 13129.feature.rst
|   |   â”œâ”€â”€ samp
|   |   â”œâ”€â”€ stats
|   |   â”œâ”€â”€ table
|   |   |   â”œâ”€â”€ 12631.api.rst
|   |   |   â”œâ”€â”€ 12637.api.rst
|   |   |   â”œâ”€â”€ 12637.feature.rst
|   |   |   â”œâ”€â”€ 12644.feature.rst
|   |   |   â”œâ”€â”€ 12680.feature.rst
|   |   |   â”œâ”€â”€ 12716.bugfix.rst
|   |   |   â”œâ”€â”€ 12825.feature.rst
|   |   |   â”œâ”€â”€ 12842.bugfix.rst
|   |   |   â”œâ”€â”€ 13129.feature.rst
|   |   |   â””â”€â”€ 13233.bugfix.rst
|   |   â”œâ”€â”€ template.rst
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ 12633.api.1.rst
|   |   |   â”œâ”€â”€ 12633.api.2.rst
|   |   |   â”œâ”€â”€ 12633.api.3.rst
|   |   |   â””â”€â”€ 12633.api.4.rst
|   |   â”œâ”€â”€ time
|   |   |   â”œâ”€â”€ 12842.bugfix.rst
|   |   |   â”œâ”€â”€ 12888.api.rst
|   |   |   â””â”€â”€ 13132.feature.rst
|   |   â”œâ”€â”€ timeseries
|   |   â”œâ”€â”€ uncertainty
|   |   â”œâ”€â”€ units
|   |   |   â”œâ”€â”€ 12486.feature.rst
|   |   |   â”œâ”€â”€ 12566.feature.rst
|   |   |   â”œâ”€â”€ 12709.feature.rst
|   |   |   â”œâ”€â”€ 12891.feature.rst
|   |   |   â”œâ”€â”€ 12975.feature.rst
|   |   |   â””â”€â”€ 13056.feature.rst
|   |   â”œâ”€â”€ utils
|   |   |   â”œâ”€â”€ 12891.feature.rst
|   |   |   â”œâ”€â”€ 12978.bugfix.rst
|   |   |   â”œâ”€â”€ 13052.feature.rst
|   |   |   â””â”€â”€ 13066.bugfix.rst
|   |   â”œâ”€â”€ visualization
|   |   â””â”€â”€ wcs
|   |       â”œâ”€â”€ 11693.bugfix.rst
|   |       â”œâ”€â”€ 12514.feature.rst
|   |       â”œâ”€â”€ 13062.bugfix.rst
|   |       â”œâ”€â”€ 13063.bugfix.rst
|   |       â”œâ”€â”€ 13094.feature.rst
|   |       â”œâ”€â”€ 13171.bugfix.rst
|   |       â””â”€â”€ 13228.bugfix.rst
|   â”œâ”€â”€ common_links.txt
|   â”œâ”€â”€ conf.py
|   â”œâ”€â”€ config
|   |   â”œâ”€â”€ astropy_config.rst
|   |   â””â”€â”€ index.rst
|   â”œâ”€â”€ conftest.py
|   â”œâ”€â”€ constants
|   |   â”œâ”€â”€ index.rst
|   |   â””â”€â”€ performance.inc.rst
|   â”œâ”€â”€ convolution
|   |   â”œâ”€â”€ images
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ kernels.rst
|   |   â”œâ”€â”€ non_normalized_kernels.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â””â”€â”€ using.rst
|   â”œâ”€â”€ coordinates
|   |   â”œâ”€â”€ angles.rst
|   |   â”œâ”€â”€ apply_space_motion.rst
|   |   â”œâ”€â”€ common_errors.rst
|   |   â”œâ”€â”€ definitions.rst
|   |   â”œâ”€â”€ formatting.rst
|   |   â”œâ”€â”€ frames.rst
|   |   â”œâ”€â”€ galactocentric.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ inplace.rst
|   |   â”œâ”€â”€ matchsep.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â”œâ”€â”€ remote_methods.rst
|   |   â”œâ”€â”€ representations.rst
|   |   â”œâ”€â”€ satellites.rst
|   |   â”œâ”€â”€ skycoord.rst
|   |   â”œâ”€â”€ solarsystem.rst
|   |   â”œâ”€â”€ spectralcoord.rst
|   |   â”œâ”€â”€ transforming.rst
|   |   â””â”€â”€ velocities.rst
|   â”œâ”€â”€ cosmology
|   |   â”œâ”€â”€ dev.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ io.rst
|   |   â””â”€â”€ units.rst
|   â”œâ”€â”€ credits.rst
|   â”œâ”€â”€ development
|   |   â”œâ”€â”€ astropy-package-template.rst
|   |   â”œâ”€â”€ building.rst
|   |   â”œâ”€â”€ ccython.rst
|   |   â”œâ”€â”€ codeguide.rst
|   |   â”œâ”€â”€ codeguide_emacs.rst
|   |   â”œâ”€â”€ docguide.rst
|   |   â”œâ”€â”€ docrules.rst
|   |   â”œâ”€â”€ releasing.rst
|   |   â”œâ”€â”€ scripts.rst
|   |   â”œâ”€â”€ style-guide.rst
|   |   â”œâ”€â”€ testguide.rst
|   |   â”œâ”€â”€ vision.rst
|   |   â”œâ”€â”€ when_to_rebase.rst
|   |   â””â”€â”€ workflow
|   |       â”œâ”€â”€ additional_git_topics.rst
|   |       â”œâ”€â”€ development_workflow.rst
|   |       â”œâ”€â”€ get_devel_version.rst
|   |       â”œâ”€â”€ git_edit_workflow_examples.rst
|   |       â”œâ”€â”€ git_install.rst
|   |       â”œâ”€â”€ git_resources.rst
|   |       â”œâ”€â”€ maintainer_workflow.rst
|   |       â”œâ”€â”€ patches.rst
|   |       â””â”€â”€ virtual_pythons.rst
|   â”œâ”€â”€ getting_started.rst
|   â”œâ”€â”€ glossary.rst
|   â”œâ”€â”€ importing_astropy.rst
|   â”œâ”€â”€ index.rst
|   â”œâ”€â”€ install.rst
|   â”œâ”€â”€ io
|   |   â”œâ”€â”€ ascii
|   |   |   â”œâ”€â”€ base_classes.rst
|   |   |   â”œâ”€â”€ ecsv.rst
|   |   |   â”œâ”€â”€ extension_classes.rst
|   |   |   â”œâ”€â”€ fast_ascii_io.rst
|   |   |   â”œâ”€â”€ fixed_width_gallery.rst
|   |   |   â”œâ”€â”€ index.rst
|   |   |   â”œâ”€â”€ performance.inc.rst
|   |   |   â”œâ”€â”€ read.rst
|   |   |   â”œâ”€â”€ references.txt
|   |   |   â”œâ”€â”€ toc.txt
|   |   |   â””â”€â”€ write.rst
|   |   â”œâ”€â”€ asdf-schemas.rst
|   |   â”œâ”€â”€ fits
|   |   |   â”œâ”€â”€ api
|   |   |   |   â”œâ”€â”€ cards.rst
|   |   |   |   â”œâ”€â”€ diff.rst
|   |   |   |   â”œâ”€â”€ files.rst
|   |   |   |   â”œâ”€â”€ hdulists.rst
|   |   |   |   â”œâ”€â”€ hdus.rst
|   |   |   |   â”œâ”€â”€ headers.rst
|   |   |   |   â”œâ”€â”€ images.rst
|   |   |   |   â”œâ”€â”€ tables.rst
|   |   |   |   â””â”€â”€ verification.rst
|   |   |   â”œâ”€â”€ appendix
|   |   |   |   â”œâ”€â”€ faq.rst
|   |   |   |   â”œâ”€â”€ header_transition.rst
|   |   |   |   â””â”€â”€ history.rst
|   |   |   â”œâ”€â”€ index.rst
|   |   |   â”œâ”€â”€ performance.inc.rst
|   |   |   â””â”€â”€ usage
|   |   |       â”œâ”€â”€ headers.rst
|   |   |       â”œâ”€â”€ image.rst
|   |   |       â”œâ”€â”€ misc.rst
|   |   |       â”œâ”€â”€ scripts.rst
|   |   |       â”œâ”€â”€ table.rst
|   |   |       â”œâ”€â”€ unfamiliar.rst
|   |   |       â””â”€â”€ verification.rst
|   |   â”œâ”€â”€ misc.rst
|   |   â”œâ”€â”€ registry.rst
|   |   â”œâ”€â”€ unified.rst
|   |   â””â”€â”€ votable
|   |       â”œâ”€â”€ api_exceptions.rst
|   |       â”œâ”€â”€ index.rst
|   |       â”œâ”€â”€ performance.inc.rst
|   |       â””â”€â”€ references.txt
|   â”œâ”€â”€ known_issues.rst
|   â”œâ”€â”€ license.rst
|   â”œâ”€â”€ logging.rst
|   â”œâ”€â”€ lts_policy.rst
|   â”œâ”€â”€ modeling
|   |   â”œâ”€â”€ add-units.rst
|   |   â”œâ”€â”€ compound-models.rst
|   |   â”œâ”€â”€ example-fitting-constraints.rst
|   |   â”œâ”€â”€ example-fitting-line.rst
|   |   â”œâ”€â”€ example-fitting-model-sets.rst
|   |   â”œâ”€â”€ fitting.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ jointfitter.rst
|   |   â”œâ”€â”€ models.rst
|   |   â”œâ”€â”€ new-fitter.rst
|   |   â”œâ”€â”€ new-model.rst
|   |   â”œâ”€â”€ parameters.rst
|   |   â”œâ”€â”€ performance.rst
|   |   â”œâ”€â”€ physical_models.rst
|   |   â”œâ”€â”€ polynomial_models.rst
|   |   â”œâ”€â”€ powerlaw_models.rst
|   |   â”œâ”€â”€ predef_models1D.rst
|   |   â”œâ”€â”€ predef_models2D.rst
|   |   â”œâ”€â”€ reference_api.rst
|   |   â”œâ”€â”€ spline_models.rst
|   |   â””â”€â”€ units.rst
|   â”œâ”€â”€ nddata
|   |   â”œâ”€â”€ bitmask.rst
|   |   â”œâ”€â”€ ccddata.rst
|   |   â”œâ”€â”€ decorator.rst
|   |   â”œâ”€â”€ examples
|   |   |   â””â”€â”€ cutout2d_tofits.py
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ mixins
|   |   |   â”œâ”€â”€ index.rst
|   |   |   â”œâ”€â”€ ndarithmetic.rst
|   |   |   â”œâ”€â”€ ndio.rst
|   |   |   â””â”€â”€ ndslicing.rst
|   |   â”œâ”€â”€ nddata.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â”œâ”€â”€ subclassing.rst
|   |   â””â”€â”€ utils.rst
|   â”œâ”€â”€ overview.rst
|   â”œâ”€â”€ robots.txt
|   â”œâ”€â”€ samp
|   |   â”œâ”€â”€ advanced_embed_samp_hub.rst
|   |   â”œâ”€â”€ example_clients.rst
|   |   â”œâ”€â”€ example_hub.rst
|   |   â”œâ”€â”€ example_table_image.rst
|   |   â”œâ”€â”€ index.rst
|   |   â””â”€â”€ performance.inc.rst
|   â”œâ”€â”€ stats
|   |   â”œâ”€â”€ circ.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â”œâ”€â”€ ripley.rst
|   |   â””â”€â”€ robust.rst
|   â”œâ”€â”€ table
|   |   â”œâ”€â”€ access_table.rst
|   |   â”œâ”€â”€ construct_table.rst
|   |   â”œâ”€â”€ implementation_details.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ indexing.rst
|   |   â”œâ”€â”€ io.rst
|   |   â”œâ”€â”€ masking.rst
|   |   â”œâ”€â”€ mixin_columns.rst
|   |   â”œâ”€â”€ modify_table.rst
|   |   â”œâ”€â”€ operations.rst
|   |   â”œâ”€â”€ pandas.rst
|   |   â””â”€â”€ performance.inc.rst
|   â”œâ”€â”€ testhelpers.rst
|   â”œâ”€â”€ time
|   |   â”œâ”€â”€ index.rst
|   |   â””â”€â”€ performance.inc.rst
|   â”œâ”€â”€ timeseries
|   |   â”œâ”€â”€ analysis.rst
|   |   â”œâ”€â”€ bls.rst
|   |   â”œâ”€â”€ data_access.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ initializing.rst
|   |   â”œâ”€â”€ io.rst
|   |   â”œâ”€â”€ lombscargle.rst
|   |   â”œâ”€â”€ masking.rst
|   |   â”œâ”€â”€ pandas.rst
|   |   â””â”€â”€ times.rst
|   â”œâ”€â”€ uncertainty
|   |   â”œâ”€â”€ index.rst
|   |   â””â”€â”€ performance.inc.rst
|   â”œâ”€â”€ units
|   |   â”œâ”€â”€ combining_and_defining.rst
|   |   â”œâ”€â”€ constants_versions.rst
|   |   â”œâ”€â”€ conversion.rst
|   |   â”œâ”€â”€ decomposing_and_composing.rst
|   |   â”œâ”€â”€ equivalencies.rst
|   |   â”œâ”€â”€ format.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ logarithmic_units.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â”œâ”€â”€ physical_types.rst
|   |   â”œâ”€â”€ quantity.rst
|   |   â”œâ”€â”€ standard_units.rst
|   |   â”œâ”€â”€ structured_units.rst
|   |   â””â”€â”€ type_hints.rst
|   â”œâ”€â”€ utils
|   |   â”œâ”€â”€ data.rst
|   |   â”œâ”€â”€ iers.rst
|   |   â”œâ”€â”€ index.rst
|   |   â””â”€â”€ masked
|   |       â””â”€â”€ index.rst
|   â”œâ”€â”€ visualization
|   |   â”œâ”€â”€ histogram.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ matplotlib_integration.rst
|   |   â”œâ”€â”€ normalization.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â”œâ”€â”€ rgb.rst
|   |   â””â”€â”€ wcsaxes
|   |       â”œâ”€â”€ controlling_axes.rst
|   |       â”œâ”€â”€ custom_frames.rst
|   |       â”œâ”€â”€ generic_transforms.rst
|   |       â”œâ”€â”€ images_contours.rst
|   |       â”œâ”€â”€ index.rst
|   |       â”œâ”€â”€ initializing_axes.rst
|   |       â”œâ”€â”€ overlaying_coordinate_systems.rst
|   |       â”œâ”€â”€ overlays.rst
|   |       â”œâ”€â”€ slicing_datacubes.rst
|   |       â””â”€â”€ ticks_labels_grid.rst
|   â”œâ”€â”€ warnings.rst
|   â”œâ”€â”€ wcs
|   |   â”œâ”€â”€ example_create_imaging.rst
|   |   â”œâ”€â”€ example_cube_wcs.rst
|   |   â”œâ”€â”€ examples
|   |   |   â”œâ”€â”€ cube_wcs.py
|   |   |   â”œâ”€â”€ from_file.py
|   |   |   â””â”€â”€ programmatic.py
|   |   â”œâ”€â”€ history.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ legacy_interface.rst
|   |   â”œâ”€â”€ loading_from_fits.rst
|   |   â”œâ”€â”€ note_sip.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â”œâ”€â”€ reference_api.rst
|   |   â”œâ”€â”€ references.rst
|   |   â”œâ”€â”€ references.txt
|   |   â”œâ”€â”€ relax.rst
|   |   â”œâ”€â”€ supported_projections.rst
|   |   â”œâ”€â”€ validation.rst
|   |   â”œâ”€â”€ wcsapi.rst
|   |   â””â”€â”€ wcstools.rst
|   â””â”€â”€ whatsnew
|       â”œâ”€â”€ 0.1.rst
|       â”œâ”€â”€ 0.2.rst
|       â”œâ”€â”€ 0.3.rst
|       â”œâ”€â”€ 0.4.rst
|       â”œâ”€â”€ 1.0.rst
|       â”œâ”€â”€ 1.1.rst
|       â”œâ”€â”€ 1.2.rst
|       â”œâ”€â”€ 1.3.rst
|       â”œâ”€â”€ 2.0.rst
|       â”œâ”€â”€ 3.0.rst
|       â”œâ”€â”€ 3.1.rst
|       â”œâ”€â”€ 3.2.rst
|       â”œâ”€â”€ 4.0.rst
|       â”œâ”€â”€ 4.1.rst
|       â”œâ”€â”€ 4.2.rst
|       â”œâ”€â”€ 4.3.rst
|       â”œâ”€â”€ 5.0.rst
|       â”œâ”€â”€ 5.1.rst
|       â”œâ”€â”€ 5.2.rst
|       â””â”€â”€ index.rst
â”œâ”€â”€ examples
|   â”œâ”€â”€ README.rst
|   â”œâ”€â”€ coordinates
|   |   â”œâ”€â”€ README.txt
|   |   â”œâ”€â”€ plot_galactocentric-frame.py
|   |   â”œâ”€â”€ plot_obs-planning.py
|   |   â”œâ”€â”€ plot_sgr-coordinate-frame.py
|   |   â””â”€â”€ rv-to-gsr.py
|   â”œâ”€â”€ io
|   |   â”œâ”€â”€ README.txt
|   |   â”œâ”€â”€ create-mef.py
|   |   â”œâ”€â”€ fits-tables.py
|   |   â”œâ”€â”€ modify-fits-header.py
|   |   â”œâ”€â”€ plot_fits-image.py
|   |   â”œâ”€â”€ skip_create-large-fits.py
|   |   â””â”€â”€ split-jpeg-to-fits.py
|   â””â”€â”€ template
|       â””â”€â”€ example-template.py
â”œâ”€â”€ licenses
|   â”œâ”€â”€ AURA_LICENSE.rst
|   â”œâ”€â”€ CONFIGOBJ_LICENSE.rst
|   â”œâ”€â”€ DATATABLES_LICENSE.rst
|   â”œâ”€â”€ ERFA.rst
|   â”œâ”€â”€ EXPAT_LICENSE.rst
|   â”œâ”€â”€ JQUERY_LICENSE.rst
|   â”œâ”€â”€ NUMPY_LICENSE.rst
|   â”œâ”€â”€ PLY_LICENSE.rst
|   â”œâ”€â”€ PYFITS.rst
|   â”œâ”€â”€ PYTHON.rst
|   â”œâ”€â”€ README.rst
|   â””â”€â”€ WCSLIB_LICENSE.rst
â””â”€â”€ setup.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---
Issue title:
Consider removing auto-transform of structured column into NdarrayMixin

Issue description: 
<!-- This comments are hidden when you submit the issue,
so you do not need to remove them! -->

<!-- Please be sure to check out our contributing guidelines,
https://github.com/astropy/astropy/blob/main/CONTRIBUTING.md .
Please be sure to check out our code of conduct,
https://github.com/astropy/astropy/blob/main/CODE_OF_CONDUCT.md . -->

<!-- Please have a search on our GitHub repository to see if a similar
issue has already been posted.
If a similar issue is closed, have a quick look to see if you are satisfied
by the resolution.
If not please go ahead and open an issue! -->

### Description
<!-- Provide a general description of the feature you would like. -->
<!-- If you want to, you can suggest a draft design or API. -->
<!-- This way we have a deeper discussion on the feature. -->

Currently if you add a structured `np.array` to a Table, it gets turned into an `NdarrayMixin` (via the code below). While this mostly works, I am not sure this is necessary or desirable any more after #12644. Basically the original rational for `NdarrayMixin` was that structured dtype `Column` didn't quite work, in particular for serialization. So we pushed that out to a mixin class which would signal to unified I/O that it might not be supported.

```
        # Structured ndarray gets viewed as a mixin unless already a valid
        # mixin class
        if (not isinstance(data, Column) and not data_is_mixin
                and isinstance(data, np.ndarray) and len(data.dtype) > 1):
            data = data.view(NdarrayMixin)
            data_is_mixin = True
```

Proposal:
- Add a FutureWarning here telling the user to wrap `data` in `Column` and that in the future (5.2) the structured array will be added as a `Column`.
- Change the behavior in 5.2 by removing this clause.

This is not critical for 5.1 but if we have the opportunity due to other (critical) bugfixes it might be nice to save 6 months in the change process.

cc: @mhvk

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: astropy/table/tests/test_mixin.py
Line number range: 64 - 93
Content:
64. def check_mixin_type(table, table_col, in_col):
65.     # We check for QuantityInfo rather than just isinstance(col, u.Quantity)
66.     # since we want to treat EarthLocation as a mixin, even though it is
67.     # a Quantity subclass.
68.     if ((isinstance(in_col.info, u.QuantityInfo) and type(table) is not QTable)
69.             or isinstance(in_col, Column)):
70.         assert type(table_col) is table.ColumnClass
71.     else:
72.         assert type(table_col) is type(in_col)
73. 
74.     # Make sure in_col got copied and creating table did not touch it
75.     assert in_col.info.name is None
76. 
77. 
78. def test_make_table(table_types, mixin_cols):
79.     """
80.     Make a table with the columns in mixin_cols, which is an ordered dict of
81.     three cols: 'a' and 'b' are table_types.Column type, and 'm' is a mixin.
82.     """
83.     t = table_types.Table(mixin_cols)
84.     check_mixin_type(t, t['m'], mixin_cols['m'])
85. 
86.     cols = list(mixin_cols.values())
87.     t = table_types.Table(cols, names=('i', 'a', 'b', 'm'))
88.     check_mixin_type(t, t['m'], mixin_cols['m'])
89. 
90.     t = table_types.Table(cols)
91.     check_mixin_type(t, t['col3'], mixin_cols['m'])
92. 
93. 


File: astropy/table/tests/test_mixin.py
Line number range: 444 - 495
Content:
444. def test_add_column(mixin_cols):
445.     """
446.     Test that adding a column preserves values and attributes
447.     """
448.     attrs = ('name', 'unit', 'dtype', 'format', 'description', 'meta')
449.     m = mixin_cols['m']
450.     assert m.info.name is None
451. 
452.     # Make sure adding column in various ways doesn't touch
453.     t = QTable([m], names=['a'])
454.     assert m.info.name is None
455. 
456.     t['new'] = m
457.     assert m.info.name is None
458. 
459.     m.info.name = 'm'
460.     m.info.format = '{0}'
461.     m.info.description = 'd'
462.     m.info.meta = {'a': 1}
463.     t = QTable([m])
464. 
465.     # Add columns m2, m3, m4 by two different methods and test expected equality
466.     t['m2'] = m
467.     m.info.name = 'm3'
468.     t.add_columns([m], copy=True)
469.     m.info.name = 'm4'
470.     t.add_columns([m], copy=False)
471.     for name in ('m2', 'm3', 'm4'):
472.         assert_table_name_col_equal(t, name, m)
473.         for attr in attrs:
474.             if attr != 'name':
475.                 assert getattr(t['m'].info, attr) == getattr(t[name].info, attr)
476.     # Also check that one can set using a scalar.
477.     s = m[0]
478.     if type(s) is type(m) and 'info' in s.__dict__:
479.         # We're not going to worry about testing classes for which scalars
480.         # are a different class than the real array, or where info is not copied.
481.         t['s'] = m[0]
482.         assert_table_name_col_equal(t, 's', m[0])
483.         for attr in attrs:
484.             if attr != 'name':
485.                 assert getattr(t['m'].info, attr) == getattr(t['s'].info, attr)
486. 
487.     # While we're add it, also check a length-1 table.
488.     t = QTable([m[1:2]], names=['m'])
489.     if type(s) is type(m) and 'info' in s.__dict__:
490.         t['s'] = m[0]
491.         assert_table_name_col_equal(t, 's', m[0])
492.         for attr in attrs:
493.             if attr != 'name':
494.                 assert getattr(t['m'].info, attr) == getattr(t['s'].info, attr)
495. 


File: astropy/table/tests/test_mixin.py
Line number range: 411 - 442
Content:
411. def test_info_preserved_pickle_copy_init(mixin_cols):
412.     """
413.     Test copy, pickle, and init from class roundtrip preserve info.  This
414.     tests not only the mixin classes but a regular column as well.
415.     """
416.     def pickle_roundtrip(c):
417.         return pickle.loads(pickle.dumps(c))
418. 
419.     def init_from_class(c):
420.         return c.__class__(c)
421. 
422.     attrs = ('name', 'unit', 'dtype', 'format', 'description', 'meta')
423.     for colname in ('i', 'm'):
424.         m = mixin_cols[colname]
425.         m.info.name = colname
426.         m.info.format = '{0}'
427.         m.info.description = 'd'
428.         m.info.meta = {'a': 1}
429.         for func in (copy.copy, copy.deepcopy, pickle_roundtrip, init_from_class):
430.             m2 = func(m)
431.             for attr in attrs:
432.                 # non-native byteorder not preserved by last 2 func, _except_ for structured dtype
433.                 if (attr != 'dtype'
434.                         or getattr(m.info.dtype, 'isnative', True)
435.                         or m.info.dtype.name.startswith('void')
436.                         or func in (copy.copy, copy.deepcopy)):
437.                     original = getattr(m.info, attr)
438.                 else:
439.                     # func does not preserve byteorder, check against (native) type.
440.                     original = m.info.dtype.newbyteorder('=')
441.                 assert getattr(m2.info, attr) == original
442. 


File: astropy/table/tests/test_mixin.py
Line number range: 391 - 409
Content:
391. def test_get_items(mixin_cols):
392.     """
393.     Test that slicing / indexing table gives right values and col attrs inherit
394.     """
395.     attrs = ('name', 'unit', 'dtype', 'format', 'description', 'meta')
396.     m = mixin_cols['m']
397.     m.info.name = 'm'
398.     m.info.format = '{0}'
399.     m.info.description = 'd'
400.     m.info.meta = {'a': 1}
401.     t = QTable([m])
402.     for item in ([1, 3], np.array([0, 2]), slice(1, 3)):
403.         t2 = t[item]
404.         m2 = m[item]
405.         assert_table_name_col_equal(t2, 'm', m[item])
406.         for attr in attrs:
407.             assert getattr(t2['m'].info, attr) == getattr(m.info, attr)
408.             assert getattr(m2.info, attr) == getattr(m.info, attr)
409. 


File: astropy/table/tests/test_mixin.py
Line number range: 271 - 288
Content:
271. def test_votable_mixin_write_fail(mixin_cols):
272.     """
273.     Test that table with mixin columns (excluding Quantity) cannot be written by
274.     io.votable.
275.     """
276.     t = QTable(mixin_cols)
277.     # Only do this test if there are unsupported column types (i.e. anything besides
278.     # BaseColumn and Quantity class instances).
279.     unsupported_cols = t.columns.not_isinstance((BaseColumn, u.Quantity))
280. 
281.     if not unsupported_cols:
282.         pytest.skip("no unsupported column types")
283. 
284.     out = StringIO()
285.     with pytest.raises(ValueError) as err:
286.         t.write(out, format='votable')
287.     assert 'cannot write table with mixin column(s)' in str(err.value)
288. 

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

2025-10-04 06:57:32,946 - thread-139911184823872.app.lang_graph.nodes.context_refine_node - DEBUG - reasoning="1. The user wants 5 complete, self-contained test cases related to the auto-transformation of structured numpy arrays into `NdarrayMixin` columns within `astropy.table.Table`.\n2. The provided context contains snippets from `astropy/table/tests/test_mixin.py`, which appear relevant as they test the behavior of mixin columns.\n3. However, these snippets are incomplete. They lack the necessary `import` statements and the definitions of pytest fixtures (e.g., `mixin_cols`, `table_types`) that are used in the test functions.\n4. Without the fixture definitions, it's impossible to know what kind of data is being used for the tests and whether they cover the specific case of structured arrays being converted to `NdarrayMixin`.\n5. To provide complete and relevant test cases as requested, I need the full source of `astropy/table/tests/test_mixin.py` to get access to all imports, fixtures, and helper functions." refined_query='Please provide the full content of the file `astropy/table/tests/test_mixin.py`.'
2025-10-04 06:57:35,500 - thread-139911184823872.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "astropy/table/tests/test_mixin.py"}'}, '__gemini_function_call_thought_signatures__': {'2ae67b75-6f72-4762-a7a0-5ca96626a858': 'Cp4DAR/MhbaZy5G4nbC8U2d+vyGurQ9h96PxRymNx5FhCysqgSHflGz+KSWDXJCS+MR8XfgozpnGrRnhw5sV9V/6z2ZyzyJzK3VYDUe8pXoi631Aj+mK1jov6v93NXSOo/aZj791ev6ZiHxLdiIX5SoyVajPLnrZy/5RScFZniIA9T+t3DSDZJLug4yLDI2guay42udvgcv8SqecAFoOREnh7IMJI+TIUKh8ShLqoBJx7sIDPBlk1Mz2ob11Cz00ZZdJujjbFGW1RR7k2fmg/7uKAzzSXjjgMZrqRFwREeeOzV6Ngaf6QHXdHX26NfA4dbtBagsBlCRkXTbSj8+zate6jJLEOsQdkp3K24xBavPQoQCFJh7/GN4Rwv7mOxD5KRvlErnMPSCJgo8oxnb8NC9nF6TXHy9IDq7/votZOxdfdMcxzdKeQ0QMLa9+0bGy+xjY3Bhg5uqu/Y/9rolFlG9MXTfHY05o/DXHP475xXYYuk886c6j5Xvt9Zcam/lk3BfnFlnLm1rgvTzEXv03eGBtAze+xjPmXK+V3Y/qR4Yj'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 20359, 'candidates_token_count': 26, 'total_token_count': 20489, 'prompt_tokens_details': [{'modality': 1, 'token_count': 20359}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 26}], 'thoughts_token_count': 104, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.23552179336547852, 'model_name': 'gemini-2.5-pro'} id='run--cad2467b-6017-45cb-989e-156e6e46aa21-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'astropy/table/tests/test_mixin.py'}, 'id': '2ae67b75-6f72-4762-a7a0-5ca96626a858', 'type': 'tool_call'}] usage_metadata={'input_tokens': 20359, 'output_tokens': 26, 'total_tokens': 20489, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 104}}
2025-10-04 06:57:38,704 - thread-139911184823872.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"relative_path": "astropy/table/tests/test_mixin.py", "start_line": 1.0, "end_line": 1300.0}'}, '__gemini_function_call_thought_signatures__': {'1bdb1743-ded5-407e-b362-93204d506d9a': 'Co4EAR/MhbYpChRjEK+Ol8DAvEgqxDAa8kmtcwELkzdHS6AnpigHwLRgIif0gRRWByAYAPi4hVZc3oAYKhwr+1DFG8PdzYJaWh7f6sI3dUOUjI6h+/SgIXULeSGY/XhWFDlmUJxVA4WiOuU2tFghkFelJWJn8AsLJIuD7kZFAWMS62Nhun7CdMbw2P5DaO5hx6cOvWSERl5zGDW7Ave+bq29L1vvdu7u/XS1/aXnZ+41dXK+MpkeW0YysRTyKzesVB+MaxWc0VAmwf4R8N70RFuqWbLvdBLJaCJMjYT4Dezk0v1iDjvBiJIZDkzov8/+ZBVW0vNGD4lo1AS8ArIzEnVuqNEQEbHJzeCzCQF3wbLaRpsh/Va44/yKVJZqD05gS4c/f++HtlAYp0d/O7eqQk5VHFjveQWbUS/67l3p5fP3fb1++yHI0p3z8DnHoO/1J6EBqifS/UgItgRvjCkDG/YqDhULUBc1P/nOe7kkPmssmFhy2Irta21WRXkjJOk/7PKzYE0nGCqp3mhMKJs6YyjUgcynHPpykLt/oEO2Sx9BPRn0jVo4/6NqHXAtuQsQ1FqSqcnq0tr7zQMcRbmJvMflTU1BCyTxV99rp8BJvVbzmij/IowsLgRtXihRpfOv5o6+WVU3gFDoGc/V+WvUNe3rRQ0T5yYi2r1Ypb/1ucMSd76mRH+Dor9//yrZ5g00IQ=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 28650, 'candidates_token_count': 32, 'total_token_count': 28826, 'cached_content_token_count': 19623, 'prompt_tokens_details': [{'modality': 1, 'token_count': 28752}], 'cache_tokens_details': [{'modality': 1, 'token_count': 19623}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 32}], 'thoughts_token_count': 144}, 'finish_reason': 'STOP', 'avg_logprobs': -0.3252567648887634, 'model_name': 'gemini-2.5-pro'} id='run--903bcf0e-2085-4ce1-80b8-cc5401f3a14c-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'relative_path': 'astropy/table/tests/test_mixin.py', 'start_line': 1.0, 'end_line': 1300.0}, 'id': '1bdb1743-ded5-407e-b362-93204d506d9a', 'type': 'tool_call'}] usage_metadata={'input_tokens': 28650, 'output_tokens': 32, 'total_tokens': 28826, 'input_token_details': {'cache_read': 19623}, 'output_token_details': {'reasoning': 144}}
2025-10-04 06:57:42,165 - thread-139911184823872.app.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the full content of the file `astropy/table/tests/test_mixin.py`. The file contains a series of tests for the mixin functionality in `astropy.table`. These tests cover various aspects of mixin columns, including their creation, I/O operations, and interactions with table operations like joining and stacking.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 43302, 'candidates_token_count': 71, 'total_token_count': 43428, 'cached_content_token_count': 19576, 'prompt_tokens_details': [{'modality': 1, 'token_count': 43546}], 'cache_tokens_details': [{'modality': 1, 'token_count': 19576}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 71}], 'thoughts_token_count': 55}, 'finish_reason': 'STOP', 'avg_logprobs': -0.169372128768706, 'model_name': 'gemini-2.5-pro'} id='run--aa6711b6-2572-48b6-b9dc-6e569f291a9e-0' usage_metadata={'input_tokens': 43302, 'output_tokens': 71, 'total_tokens': 43428, 'input_token_details': {'cache_read': 19576}, 'output_token_details': {'reasoning': 55}}
2025-10-04 06:57:42,166 - thread-139911184823872.app.lang_graph.nodes.context_extraction_node - INFO - Starting context extraction process
2025-10-04 06:57:42,166 - thread-139911184823872.app.lang_graph.nodes.context_extraction_node - DEBUG - This is the original user query:

--- BEGIN ORIGINAL QUERY ---
Issue title:
Consider removing auto-transform of structured column into NdarrayMixin

Issue description: 
<!-- This comments are hidden when you submit the issue,
so you do not need to remove them! -->

<!-- Please be sure to check out our contributing guidelines,
https://github.com/astropy/astropy/blob/main/CONTRIBUTING.md .
Please be sure to check out our code of conduct,
https://github.com/astropy/astropy/blob/main/CODE_OF_CONDUCT.md . -->

<!-- Please have a search on our GitHub repository to see if a similar
issue has already been posted.
If a similar issue is closed, have a quick look to see if you are satisfied
by the resolution.
If not please go ahead and open an issue! -->

### Description
<!-- Provide a general description of the feature you would like. -->
<!-- If you want to, you can suggest a draft design or API. -->
<!-- This way we have a deeper discussion on the feature. -->

Currently if you add a structured `np.array` to a Table, it gets turned into an `NdarrayMixin` (via the code below). While this mostly works, I am not sure this is necessary or desirable any more after #12644. Basically the original rational for `NdarrayMixin` was that structured dtype `Column` didn't quite work, in particular for serialization. So we pushed that out to a mixin class which would signal to unified I/O that it might not be supported.

```
        # Structured ndarray gets viewed as a mixin unless already a valid
        # mixin class
        if (not isinstance(data, Column) and not data_is_mixin
                and isinstance(data, np.ndarray) and len(data.dtype) > 1):
            data = data.view(NdarrayMixin)
            data_is_mixin = True
```

Proposal:
- Add a FutureWarning here telling the user to wrap `data` in `Column` and that in the future (5.2) the structured array will be added as a `Column`.
- Change the behavior in 5.2 by removing this clause.

This is not critical for 5.1 but if we have the opportunity due to other (critical) bugfixes it might be nice to save 6 months in the change process.

cc: @mhvk

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

This is the refinement query. Please consider it together with the original query. It's really IMPORTANT!!!

--- BEGIN REFINEMENT QUERY ---
Please provide the full content of the file `astropy/table/tests/test_mixin.py`.
--- END REFINEMENT QUERY ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: astropy/table/tests/test_mixin.py
Line number range: 1 - 1300
Content:
1. # -*- coding: utf-8 -*-
2. # Licensed under a 3-clause BSD style license - see LICENSE.rst
3. 
4. 
5. import copy
6. import pickle
7. from io import StringIO
8. 
9. import pytest
10. import numpy as np
11. 
12. from astropy.table.serialize import represent_mixins_as_columns
13. from astropy.utils.data_info import ParentDtypeInfo
14. from astropy.table.table_helpers import ArrayWrapper
15. from astropy.coordinates import EarthLocation, SkyCoord
16. from astropy.table import Table, QTable, join, hstack, vstack, Column, NdarrayMixin
17. from astropy.table import serialize
18. from astropy import time
19. from astropy import coordinates
20. from astropy import units as u
21. from astropy.table.column import BaseColumn
22. from astropy.table import table_helpers
23. from astropy.utils.exceptions import AstropyUserWarning
24. from astropy.utils.metadata import MergeConflictWarning
25. from astropy.coordinates.tests.test_representation import representation_equal
26. from astropy.coordinates.tests.helper import skycoord_equal
27. 
28. from .conftest import MIXIN_COLS
29. 
30. 
31. def test_attributes(mixin_cols):
32.     """
33.     Required attributes for a column can be set.
34.     """
35.     m = mixin_cols['m']
36.     m.info.name = 'a'
37.     assert m.info.name == 'a'
38. 
39.     m.info.description = 'a'
40.     assert m.info.description == 'a'
41. 
42.     # Cannot set unit for these classes
43.     if isinstance(m, (u.Quantity, coordinates.SkyCoord, time.Time, time.TimeDelta,
44.                       coordinates.BaseRepresentationOrDifferential)):
45.         with pytest.raises(AttributeError):
46.             m.info.unit = u.m
47.     else:
48.         m.info.unit = u.m
49.         assert m.info.unit is u.m
50. 
51.     m.info.format = 'a'
52.     assert m.info.format == 'a'
53. 
54.     m.info.meta = {'a': 1}
55.     assert m.info.meta == {'a': 1}
56. 
57.     with pytest.raises(AttributeError):
58.         m.info.bad_attr = 1
59. 
60.     with pytest.raises(AttributeError):
61.         m.info.bad_attr
62. 
63. 
64. def check_mixin_type(table, table_col, in_col):
65.     # We check for QuantityInfo rather than just isinstance(col, u.Quantity)
66.     # since we want to treat EarthLocation as a mixin, even though it is
67.     # a Quantity subclass.
68.     if ((isinstance(in_col.info, u.QuantityInfo) and type(table) is not QTable)
69.             or isinstance(in_col, Column)):
70.         assert type(table_col) is table.ColumnClass
71.     else:
72.         assert type(table_col) is type(in_col)
73. 
74.     # Make sure in_col got copied and creating table did not touch it
75.     assert in_col.info.name is None
76. 
77. 
78. def test_make_table(table_types, mixin_cols):
79.     """
80.     Make a table with the columns in mixin_cols, which is an ordered dict of
81.     three cols: 'a' and 'b' are table_types.Column type, and 'm' is a mixin.
82.     """
83.     t = table_types.Table(mixin_cols)
84.     check_mixin_type(t, t['m'], mixin_cols['m'])
85. 
86.     cols = list(mixin_cols.values())
87.     t = table_types.Table(cols, names=('i', 'a', 'b', 'm'))
88.     check_mixin_type(t, t['m'], mixin_cols['m'])
89. 
90.     t = table_types.Table(cols)
91.     check_mixin_type(t, t['col3'], mixin_cols['m'])
92. 
93. 
94. def test_io_ascii_write():
95.     """
96.     Test that table with mixin column can be written by io.ascii for
97.     every pure Python writer.  No validation of the output is done,
98.     this just confirms no exceptions.
99.     """
100.     from astropy.io.ascii.connect import _get_connectors_table
101.     t = QTable(MIXIN_COLS)
102.     for fmt in _get_connectors_table():
103.         if fmt['Write'] and '.fast_' not in fmt['Format']:
104.             out = StringIO()
105.             t.write(out, format=fmt['Format'])
106. 
107. 
108. def test_votable_quantity_write(tmpdir):
109.     """
110.     Test that table with Quantity mixin column can be round-tripped by
111.     io.votable.  Note that FITS and HDF5 mixin support are tested (much more
112.     thoroughly) in their respective subpackage tests
113.     (io/fits/tests/test_connect.py and io/misc/tests/test_hdf5.py).
114.     """
115.     t = QTable()
116.     t['a'] = u.Quantity([1, 2, 4], unit='nm')
117. 
118.     filename = str(tmpdir.join('table-tmp'))
119.     t.write(filename, format='votable', overwrite=True)
120.     qt = QTable.read(filename, format='votable')
121.     assert isinstance(qt['a'], u.Quantity)
122.     assert qt['a'].unit == 'nm'
123. 
124. 
125. @pytest.mark.remote_data
126. @pytest.mark.parametrize('table_types', (Table, QTable))
127. def test_io_time_write_fits_standard(tmpdir, table_types):
128.     """
129.     Test that table with Time mixin columns can be written by io.fits.
130.     Validation of the output is done. Test that io.fits writes a table
131.     containing Time mixin columns that can be partially round-tripped
132.     (metadata scale, location).
133. 
134.     Note that we postpone checking the "local" scale, since that cannot
135.     be done with format 'cxcsec', as it requires an epoch.
136.     """
137.     t = table_types([[1, 2], ['string', 'column']])
138.     for scale in time.STANDARD_TIME_SCALES:
139.         t['a' + scale] = time.Time([[1, 2], [3, 4]], format='cxcsec',
140.                                    scale=scale, location=EarthLocation(
141.             -2446354, 4237210, 4077985, unit='m'))
142.         t['b' + scale] = time.Time(['1999-01-01T00:00:00.123456789',
143.                                     '2010-01-01T00:00:00'], scale=scale)
144.     t['c'] = [3., 4.]
145. 
146.     filename = str(tmpdir.join('table-tmp'))
147. 
148.     # Show that FITS format succeeds
149.     with pytest.warns(
150.             AstropyUserWarning,
151.             match='Time Column "btai" has no specified location, '
152.             'but global Time Position is present'):
153.         t.write(filename, format='fits', overwrite=True)
154.     with pytest.warns(
155.             AstropyUserWarning,
156.             match='Time column reference position "TRPOSn" is not specified'):
157.         tm = table_types.read(filename, format='fits', astropy_native=True)
158. 
159.     for scale in time.STANDARD_TIME_SCALES:
160.         for ab in ('a', 'b'):
161.             name = ab + scale
162. 
163.             # Assert that the time columns are read as Time
164.             assert isinstance(tm[name], time.Time)
165. 
166.             # Assert that the scales round-trip
167.             assert tm[name].scale == t[name].scale
168. 
169.             # Assert that the format is jd
170.             assert tm[name].format == 'jd'
171. 
172.             # Assert that the location round-trips
173.             assert tm[name].location == t[name].location
174. 
175.             # Finally assert that the column data round-trips
176.             assert (tm[name] == t[name]).all()
177. 
178.     for name in ('col0', 'col1', 'c'):
179.         # Assert that the non-time columns are read as Column
180.         assert isinstance(tm[name], Column)
181. 
182.         # Assert that the non-time columns' data round-trips
183.         assert (tm[name] == t[name]).all()
184. 
185.     # Test for conversion of time data to its value, as defined by its format
186.     for scale in time.STANDARD_TIME_SCALES:
187.         for ab in ('a', 'b'):
188.             name = ab + scale
189.             t[name].info.serialize_method['fits'] = 'formatted_value'
190. 
191.     t.write(filename, format='fits', overwrite=True)
192.     tm = table_types.read(filename, format='fits')
193. 
194.     for scale in time.STANDARD_TIME_SCALES:
195.         for ab in ('a', 'b'):
196.             name = ab + scale
197. 
198.             assert not isinstance(tm[name], time.Time)
199.             assert (tm[name] == t[name].value).all()
200. 
201. 
202. @pytest.mark.parametrize('table_types', (Table, QTable))
203. def test_io_time_write_fits_local(tmpdir, table_types):
204.     """
205.     Test that table with a Time mixin with scale local can also be written
206.     by io.fits. Like ``test_io_time_write_fits_standard`` above, but avoiding
207.     ``cxcsec`` format, which requires an epoch and thus cannot be used for a
208.     local time scale.
209.     """
210.     t = table_types([[1, 2], ['string', 'column']])
211.     t['a_local'] = time.Time([[50001, 50002], [50003, 50004]],
212.                              format='mjd', scale='local',
213.                              location=EarthLocation(-2446354, 4237210, 4077985,
214.                                                     unit='m'))
215.     t['b_local'] = time.Time(['1999-01-01T00:00:00.123456789',
216.                               '2010-01-01T00:00:00'], scale='local')
217.     t['c'] = [3., 4.]
218. 
219.     filename = str(tmpdir.join('table-tmp'))
220. 
221.     # Show that FITS format succeeds
222. 
223.     with pytest.warns(AstropyUserWarning,
224.                       match='Time Column "b_local" has no specified location'):
225.         t.write(filename, format='fits', overwrite=True)
226. 
227.     with pytest.warns(AstropyUserWarning,
228.                       match='Time column reference position "TRPOSn" is not specified.'):
229.         tm = table_types.read(filename, format='fits', astropy_native=True)
230. 
231.     for ab in ('a', 'b'):
232.         name = ab + '_local'
233. 
234.         # Assert that the time columns are read as Time
235.         assert isinstance(tm[name], time.Time)
236. 
237.         # Assert that the scales round-trip
238.         assert tm[name].scale == t[name].scale
239. 
240.         # Assert that the format is jd
241.         assert tm[name].format == 'jd'
242. 
243.         # Assert that the location round-trips
244.         assert tm[name].location == t[name].location
245. 
246.         # Finally assert that the column data round-trips
247.         assert (tm[name] == t[name]).all()
248. 
249.     for name in ('col0', 'col1', 'c'):
250.         # Assert that the non-time columns are read as Column
251.         assert isinstance(tm[name], Column)
252. 
253.         # Assert that the non-time columns' data round-trips
254.         assert (tm[name] == t[name]).all()
255. 
256.     # Test for conversion of time data to its value, as defined by its format.
257.     for ab in ('a', 'b'):
258.         name = ab + '_local'
259.         t[name].info.serialize_method['fits'] = 'formatted_value'
260. 
261.     t.write(filename, format='fits', overwrite=True)
262.     tm = table_types.read(filename, format='fits')
263. 
264.     for ab in ('a', 'b'):
265.         name = ab + '_local'
266. 
267.         assert not isinstance(tm[name], time.Time)
268.         assert (tm[name] == t[name].value).all()
269. 
270. 
271. def test_votable_mixin_write_fail(mixin_cols):
272.     """
273.     Test that table with mixin columns (excluding Quantity) cannot be written by
274.     io.votable.
275.     """
276.     t = QTable(mixin_cols)
277.     # Only do this test if there are unsupported column types (i.e. anything besides
278.     # BaseColumn and Quantity class instances).
279.     unsupported_cols = t.columns.not_isinstance((BaseColumn, u.Quantity))
280. 
281.     if not unsupported_cols:
282.         pytest.skip("no unsupported column types")
283. 
284.     out = StringIO()
285.     with pytest.raises(ValueError) as err:
286.         t.write(out, format='votable')
287.     assert 'cannot write table with mixin column(s)' in str(err.value)
288. 
289. 
290. def test_join(table_types):
291.     """
292.     Join tables with mixin cols.  Use column "i" as proxy for what the
293.     result should be for each mixin.
294.     """
295.     t1 = table_types.Table()
296.     t1['a'] = table_types.Column(['a', 'b', 'b', 'c'])
297.     t1['i'] = table_types.Column([0, 1, 2, 3])
298.     for name, col in MIXIN_COLS.items():
299.         t1[name] = col
300. 
301.     t2 = table_types.Table(t1)
302.     t2['a'] = ['b', 'c', 'a', 'd']
303. 
304.     for name, col in MIXIN_COLS.items():
305.         t1[name].info.description = name
306.         t2[name].info.description = name + '2'
307. 
308.     for join_type in ('inner', 'left'):
309.         t12 = join(t1, t2, keys='a', join_type=join_type)
310.         idx1 = t12['i_1']
311.         idx2 = t12['i_2']
312.         for name, col in MIXIN_COLS.items():
313.             name1 = name + '_1'
314.             name2 = name + '_2'
315.             assert_table_name_col_equal(t12, name1, col[idx1])
316.             assert_table_name_col_equal(t12, name2, col[idx2])
317.             assert t12[name1].info.description == name
318.             assert t12[name2].info.description == name + '2'
319. 
320.     for join_type in ('outer', 'right'):
321.         with pytest.raises(NotImplementedError) as exc:
322.             t12 = join(t1, t2, keys='a', join_type=join_type)
323.         assert 'join requires masking column' in str(exc.value)
324. 
325.     with pytest.raises(TypeError) as exc:
326.         t12 = join(t1, t2, keys=['a', 'skycoord'])
327.     assert 'one or more key columns are not sortable' in str(exc.value)
328. 
329.     # Join does work for a mixin which is a subclass of np.ndarray
330.     with pytest.warns(MergeConflictWarning,
331.                       match="In merged column 'quantity' the 'description' "
332.                             "attribute does not match"):
333.         t12 = join(t1, t2, keys=['quantity'])
334.     assert np.all(t12['a_1'] == t1['a'])
335. 
336. 
337. def test_hstack(table_types):
338.     """
339.     Hstack tables with mixin cols.  Use column "i" as proxy for what the
340.     result should be for each mixin.
341.     """
342.     t1 = table_types.Table()
343.     t1['i'] = table_types.Column([0, 1, 2, 3])
344.     for name, col in MIXIN_COLS.items():
345.         t1[name] = col
346.         t1[name].info.description = name
347.         t1[name].info.meta = {'a': 1}
348. 
349.     for join_type in ('inner', 'outer'):
350.         for chop in (True, False):
351.             t2 = table_types.Table(t1)
352.             if chop:
353.                 t2 = t2[:-1]
354.                 if join_type == 'outer':
355.                     with pytest.raises(NotImplementedError) as exc:
356.                         t12 = hstack([t1, t2], join_type=join_type)
357.                     assert 'hstack requires masking column' in str(exc.value)
358.                     continue
359. 
360.             t12 = hstack([t1, t2], join_type=join_type)
361.             idx1 = t12['i_1']
362.             idx2 = t12['i_2']
363.             for name, col in MIXIN_COLS.items():
364.                 name1 = name + '_1'
365.                 name2 = name + '_2'
366.                 assert_table_name_col_equal(t12, name1, col[idx1])
367.                 assert_table_name_col_equal(t12, name2, col[idx2])
368.                 for attr in ('description', 'meta'):
369.                     assert getattr(t1[name].info, attr) == getattr(t12[name1].info, attr)
370.                     assert getattr(t2[name].info, attr) == getattr(t12[name2].info, attr)
371. 
372. 
373. def assert_table_name_col_equal(t, name, col):
374.     """
375.     Assert all(t[name] == col), with special handling for known mixin cols.
376.     """
377.     if isinstance(col, coordinates.SkyCoord):
378.         assert np.all(t[name].ra == col.ra)
379.         assert np.all(t[name].dec == col.dec)
380.     elif isinstance(col, coordinates.BaseRepresentationOrDifferential):
381.         assert np.all(representation_equal(t[name], col))
382.     elif isinstance(col, u.Quantity):
383.         if type(t) is QTable:
384.             assert np.all(t[name] == col)
385.     elif isinstance(col, table_helpers.ArrayWrapper):
386.         assert np.all(t[name].data == col.data)
387.     else:
388.         assert np.all(t[name] == col)
389. 
390. 
391. def test_get_items(mixin_cols):
392.     """
393.     Test that slicing / indexing table gives right values and col attrs inherit
394.     """
395.     attrs = ('name', 'unit', 'dtype', 'format', 'description', 'meta')
396.     m = mixin_cols['m']
397.     m.info.name = 'm'
398.     m.info.format = '{0}'
399.     m.info.description = 'd'
400.     m.info.meta = {'a': 1}
401.     t = QTable([m])
402.     for item in ([1, 3], np.array([0, 2]), slice(1, 3)):
403.         t2 = t[item]
404.         m2 = m[item]
405.         assert_table_name_col_equal(t2, 'm', m[item])
406.         for attr in attrs:
407.             assert getattr(t2['m'].info, attr) == getattr(m.info, attr)
408.             assert getattr(m2.info, attr) == getattr(m.info, attr)
409. 
410. 
411. def test_info_preserved_pickle_copy_init(mixin_cols):
412.     """
413.     Test copy, pickle, and init from class roundtrip preserve info.  This
414.     tests not only the mixin classes but a regular column as well.
415.     """
416.     def pickle_roundtrip(c):
417.         return pickle.loads(pickle.dumps(c))
418. 
419.     def init_from_class(c):
420.         return c.__class__(c)
421. 
422.     attrs = ('name', 'unit', 'dtype', 'format', 'description', 'meta')
423.     for colname in ('i', 'm'):
424.         m = mixin_cols[colname]
425.         m.info.name = colname
426.         m.info.format = '{0}'
427.         m.info.description = 'd'
428.         m.info.meta = {'a': 1}
429.         for func in (copy.copy, copy.deepcopy, pickle_roundtrip, init_from_class):
430.             m2 = func(m)
431.             for attr in attrs:
432.                 # non-native byteorder not preserved by last 2 func, _except_ for structured dtype
433.                 if (attr != 'dtype'
434.                         or getattr(m.info.dtype, 'isnative', True)
435.                         or m.info.dtype.name.startswith('void')
436.                         or func in (copy.copy, copy.deepcopy)):
437.                     original = getattr(m.info, attr)
438.                 else:
439.                     # func does not preserve byteorder, check against (native) type.
440.                     original = m.info.dtype.newbyteorder('=')
441.                 assert getattr(m2.info, attr) == original
442. 
443. 
444. def test_add_column(mixin_cols):
445.     """
446.     Test that adding a column preserves values and attributes
447.     """
448.     attrs = ('name', 'unit', 'dtype', 'format', 'description', 'meta')
449.     m = mixin_cols['m']
450.     assert m.info.name is None
451. 
452.     # Make sure adding column in various ways doesn't touch
453.     t = QTable([m], names=['a'])
454.     assert m.info.name is None
455. 
456.     t['new'] = m
457.     assert m.info.name is None
458. 
459.     m.info.name = 'm'
460.     m.info.format = '{0}'
461.     m.info.description = 'd'
462.     m.info.meta = {'a': 1}
463.     t = QTable([m])
464. 
465.     # Add columns m2, m3, m4 by two different methods and test expected equality
466.     t['m2'] = m
467.     m.info.name = 'm3'
468.     t.add_columns([m], copy=True)
469.     m.info.name = 'm4'
470.     t.add_columns([m], copy=False)
471.     for name in ('m2', 'm3', 'm4'):
472.         assert_table_name_col_equal(t, name, m)
473.         for attr in attrs:
474.             if attr != 'name':
475.                 assert getattr(t['m'].info, attr) == getattr(t[name].info, attr)
476.     # Also check that one can set using a scalar.
477.     s = m[0]
478.     if type(s) is type(m) and 'info' in s.__dict__:
479.         # We're not going to worry about testing classes for which scalars
480.         # are a different class than the real array, or where info is not copied.
481.         t['s'] = m[0]
482.         assert_table_name_col_equal(t, 's', m[0])
483.         for attr in attrs:
484.             if attr != 'name':
485.                 assert getattr(t['m'].info, attr) == getattr(t['s'].info, attr)
486. 
487.     # While we're add it, also check a length-1 table.
488.     t = QTable([m[1:2]], names=['m'])
489.     if type(s) is type(m) and 'info' in s.__dict__:
490.         t['s'] = m[0]
491.         assert_table_name_col_equal(t, 's', m[0])
492.         for attr in attrs:
493.             if attr != 'name':
494.                 assert getattr(t['m'].info, attr) == getattr(t['s'].info, attr)
495. 
496. 
497. def test_vstack():
498.     """
499.     Vstack tables with mixin cols.
500.     """
501.     t1 = QTable(MIXIN_COLS)
502.     t2 = QTable(MIXIN_COLS)
503.     with pytest.raises(NotImplementedError):
504.         vstack([t1, t2])
505. 
506. 
507. def test_insert_row(mixin_cols):
508.     """
509.     Test inserting a row, which works for Column, Quantity, Time and SkyCoord.
510.     """
511.     t = QTable(mixin_cols)
512.     t0 = t.copy()
513.     t['m'].info.description = 'd'
514.     idxs = [0, -1, 1, 2, 3]
515.     if isinstance(t['m'], (u.Quantity, Column, time.Time, time.TimeDelta, coordinates.SkyCoord)):
516.         t.insert_row(1, t[-1])
517. 
518.         for name in t.colnames:
519.             col = t[name]
520.             if isinstance(col, coordinates.SkyCoord):
521.                 assert skycoord_equal(col, t0[name][idxs])
522.             else:
523.                 assert np.all(col == t0[name][idxs])
524. 
525.         assert t['m'].info.description == 'd'
526.     else:
527.         with pytest.raises(ValueError) as exc:
528.             t.insert_row(1, t[-1])
529.         assert "Unable to insert row" in str(exc.value)
530. 
531. 
532. def test_insert_row_bad_unit():
533.     """
534.     Insert a row into a QTable with the wrong unit
535.     """
536.     t = QTable([[1] * u.m])
537.     with pytest.raises(ValueError) as exc:
538.         t.insert_row(0, (2 * u.m / u.s,))
539.     assert "'m / s' (speed/velocity) and 'm' (length) are not convertible" in str(exc.value)
540. 
541. 
542. def test_convert_np_array(mixin_cols):
543.     """
544.     Test that converting to numpy array creates an object dtype and that
545.     each instance in the array has the expected type.
546.     """
547.     t = QTable(mixin_cols)
548.     ta = t.as_array()
549.     m = mixin_cols['m']
550.     dtype_kind = m.dtype.kind if hasattr(m, 'dtype') else 'O'
551.     assert ta['m'].dtype.kind == dtype_kind
552. 
553. 
554. def test_assignment_and_copy():
555.     """
556.     Test that assignment of an int, slice, and fancy index works.
557.     Along the way test that copying table works.
558.     """
559.     for name in ('quantity', 'arraywrap'):
560.         m = MIXIN_COLS[name]
561.         t0 = QTable([m], names=['m'])
562.         for i0, i1 in ((1, 2),
563.                        (slice(0, 2), slice(1, 3)),
564.                        (np.array([1, 2]), np.array([2, 3]))):
565.             t = t0.copy()
566.             t['m'][i0] = m[i1]
567.             if name == 'arraywrap':
568.                 assert np.all(t['m'].data[i0] == m.data[i1])
569.                 assert np.all(t0['m'].data[i0] == m.data[i0])
570.                 assert np.all(t0['m'].data[i0] != t['m'].data[i0])
571.             else:
572.                 assert np.all(t['m'][i0] == m[i1])
573.                 assert np.all(t0['m'][i0] == m[i0])
574.                 assert np.all(t0['m'][i0] != t['m'][i0])
575. 
576. 
577. def test_conversion_qtable_table():
578.     """
579.     Test that a table round trips from QTable => Table => QTable
580.     """
581.     qt = QTable(MIXIN_COLS)
582.     names = qt.colnames
583.     for name in names:
584.         qt[name].info.description = name
585. 
586.     t = Table(qt)
587.     for name in names:
588.         assert t[name].info.description == name
589.         if name == 'quantity':
590.             assert np.all(t['quantity'] == qt['quantity'].value)
591.             assert np.all(t['quantity'].unit is qt['quantity'].unit)
592.             assert isinstance(t['quantity'], t.ColumnClass)
593.         else:
594.             assert_table_name_col_equal(t, name, qt[name])
595. 
596.     qt2 = QTable(qt)
597.     for name in names:
598.         assert qt2[name].info.description == name
599.         assert_table_name_col_equal(qt2, name, qt[name])
600. 
601. 
602. def test_setitem_as_column_name():
603.     """
604.     Test for mixin-related regression described in #3321.
605.     """
606.     t = Table()
607.     t['a'] = ['x', 'y']
608.     t['b'] = 'b'  # Previously was failing with KeyError
609.     assert np.all(t['a'] == ['x', 'y'])
610.     assert np.all(t['b'] == ['b', 'b'])
611. 
612. 
613. def test_quantity_representation():
614.     """
615.     Test that table representation of quantities does not have unit
616.     """
617.     t = QTable([[1, 2] * u.m])
618.     assert t.pformat() == ['col0',
619.                            ' m  ',
620.                            '----',
621.                            ' 1.0',
622.                            ' 2.0']
623. 
624. 
625. def test_representation_representation():
626.     """
627.     Test that Representations are represented correctly.
628.     """
629.     # With no unit we get "None" in the unit row
630.     c = coordinates.CartesianRepresentation([0], [1], [0], unit=u.one)
631.     t = Table([c])
632.     assert t.pformat() == ['    col0    ',
633.                            '------------',
634.                            '(0., 1., 0.)']
635. 
636.     c = coordinates.CartesianRepresentation([0], [1], [0], unit='m')
637.     t = Table([c])
638.     assert t.pformat() == ['    col0    ',
639.                            '     m      ',
640.                            '------------',
641.                            '(0., 1., 0.)']
642. 
643.     c = coordinates.SphericalRepresentation([10]*u.deg, [20]*u.deg, [1]*u.pc)
644.     t = Table([c])
645.     assert t.pformat() == ['     col0     ',
646.                            ' deg, deg, pc ',
647.                            '--------------',
648.                            '(10., 20., 1.)']
649. 
650.     c = coordinates.UnitSphericalRepresentation([10]*u.deg, [20]*u.deg)
651.     t = Table([c])
652.     assert t.pformat() == ['   col0   ',
653.                            '   deg    ',
654.                            '----------',
655.                            '(10., 20.)']
656. 
657.     c = coordinates.SphericalCosLatDifferential(
658.         [10]*u.mas/u.yr, [2]*u.mas/u.yr, [10]*u.km/u.s)
659.     t = Table([c])
660.     assert t.pformat() == ['           col0           ',
661.                            'mas / yr, mas / yr, km / s',
662.                            '--------------------------',
663.                            '            (10., 2., 10.)']
664. 
665. 
666. def test_skycoord_representation():
667.     """
668.     Test that skycoord representation works, both in the way that the
669.     values are output and in changing the frame representation.
670.     """
671.     # With no unit we get "None" in the unit row
672.     c = coordinates.SkyCoord([0], [1], [0], representation_type='cartesian')
673.     t = Table([c])
674.     assert t.pformat() == ['     col0     ',
675.                            'None,None,None',
676.                            '--------------',
677.                            '   0.0,1.0,0.0']
678. 
679.     # Test that info works with a dynamically changed representation
680.     c = coordinates.SkyCoord([0], [1], [0], unit='m', representation_type='cartesian')
681.     t = Table([c])
682.     assert t.pformat() == ['    col0   ',
683.                            '   m,m,m   ',
684.                            '-----------',
685.                            '0.0,1.0,0.0']
686. 
687.     t['col0'].representation_type = 'unitspherical'
688.     assert t.pformat() == ['  col0  ',
689.                            'deg,deg ',
690.                            '--------',
691.                            '90.0,0.0']
692. 
693.     t['col0'].representation_type = 'cylindrical'
694.     assert t.pformat() == ['    col0    ',
695.                            '  m,deg,m   ',
696.                            '------------',
697.                            '1.0,90.0,0.0']
698. 
699. 
700. def test_ndarray_mixin():
701.     """
702.     Test directly adding a plain structured array into a table instead of the
703.     view as an NdarrayMixin.  Once added as an NdarrayMixin then all the previous
704.     tests apply.
705.     """
706.     a = np.array([(1, 'a'), (2, 'b'), (3, 'c'), (4, 'd')],
707.                  dtype='<i4,' + ('|U1'))
708.     b = np.array([(10, 'aa'), (20, 'bb'), (30, 'cc'), (40, 'dd')],
709.                  dtype=[('x', 'i4'), ('y', ('U2'))])
710.     c = np.rec.fromrecords([(100., 'raa'), (200., 'rbb'), (300., 'rcc'), (400., 'rdd')],
711.                            names=['rx', 'ry'])
712.     d = np.arange(8, dtype='i8').reshape(4, 2).view(NdarrayMixin)
713. 
714.     # Add one during initialization and the next as a new column.
715.     t = Table([a], names=['a'])
716.     t['b'] = b
717.     t['c'] = c
718.     t['d'] = d
719. 
720.     assert isinstance(t['a'], NdarrayMixin)
721. 
722.     assert t['a'][1][1] == a[1][1]
723.     assert t['a'][2][0] == a[2][0]
724. 
725.     assert t[1]['a'][1] == a[1][1]
726.     assert t[2]['a'][0] == a[2][0]
727. 
728.     assert isinstance(t['b'], NdarrayMixin)
729. 
730.     assert t['b'][1]['x'] == b[1]['x']
731.     assert t['b'][1]['y'] == b[1]['y']
732. 
733.     assert t[1]['b']['x'] == b[1]['x']
734.     assert t[1]['b']['y'] == b[1]['y']
735. 
736.     assert isinstance(t['c'], NdarrayMixin)
737. 
738.     assert t['c'][1]['rx'] == c[1]['rx']
739.     assert t['c'][1]['ry'] == c[1]['ry']
740. 
741.     assert t[1]['c']['rx'] == c[1]['rx']
742.     assert t[1]['c']['ry'] == c[1]['ry']
743. 
744.     assert isinstance(t['d'], NdarrayMixin)
745. 
746.     assert t['d'][1][0] == d[1][0]
747.     assert t['d'][1][1] == d[1][1]
748. 
749.     assert t[1]['d'][0] == d[1][0]
750.     assert t[1]['d'][1] == d[1][1]
751. 
752.     assert t.pformat(show_dtype=True) == [
753.         '  a [f0, f1]     b [x, y]      c [rx, ry]      d    ',
754.         '(int32, str1) (int32, str2) (float64, str3) int64[2]',
755.         '------------- ------------- --------------- --------',
756.         "     (1, 'a')    (10, 'aa')   (100., 'raa')   0 .. 1",
757.         "     (2, 'b')    (20, 'bb')   (200., 'rbb')   2 .. 3",
758.         "     (3, 'c')    (30, 'cc')   (300., 'rcc')   4 .. 5",
759.         "     (4, 'd')    (40, 'dd')   (400., 'rdd')   6 .. 7"]
760. 
761. 
762. def test_possible_string_format_functions():
763.     """
764.     The QuantityInfo info class for Quantity implements a
765.     possible_string_format_functions() method that overrides the
766.     standard pprint._possible_string_format_functions() function.
767.     Test this.
768.     """
769.     t = QTable([[1, 2] * u.m])
770.     t['col0'].info.format = '%.3f'
771.     assert t.pformat() == [' col0',
772.                            '  m  ',
773.                            '-----',
774.                            '1.000',
775.                            '2.000']
776. 
777.     t['col0'].info.format = 'hi {:.3f}'
778.     assert t.pformat() == ['  col0  ',
779.                            '   m    ',
780.                            '--------',
781.                            'hi 1.000',
782.                            'hi 2.000']
783. 
784.     t['col0'].info.format = '.4f'
785.     assert t.pformat() == [' col0 ',
786.                            '  m   ',
787.                            '------',
788.                            '1.0000',
789.                            '2.0000']
790. 
791. 
792. def test_rename_mixin_columns(mixin_cols):
793.     """
794.     Rename a mixin column.
795.     """
796.     t = QTable(mixin_cols)
797.     tc = t.copy()
798.     t.rename_column('m', 'mm')
799.     assert t.colnames == ['i', 'a', 'b', 'mm']
800.     if isinstance(t['mm'], table_helpers.ArrayWrapper):
801.         assert np.all(t['mm'].data == tc['m'].data)
802.     elif isinstance(t['mm'], coordinates.SkyCoord):
803.         assert np.all(t['mm'].ra == tc['m'].ra)
804.         assert np.all(t['mm'].dec == tc['m'].dec)
805.     elif isinstance(t['mm'], coordinates.BaseRepresentationOrDifferential):
806.         assert np.all(representation_equal(t['mm'], tc['m']))
807.     else:
808.         assert np.all(t['mm'] == tc['m'])
809. 
810. 
811. def test_represent_mixins_as_columns_unit_fix():
812.     """
813.     If the unit is invalid for a column that gets serialized this would
814.     cause an exception.  Fixed in #7481.
815.     """
816.     t = Table({'a': [1, 2]}, masked=True)
817.     t['a'].unit = 'not a valid unit'
818.     t['a'].mask[1] = True
819.     serialize.represent_mixins_as_columns(t)
820. 
821. 
822. def test_primary_data_column_gets_description():
823.     """
824.     If the mixin defines a primary data column, that should get the
825.     description, format, etc., so no __info__ should be needed.
826.     """
827.     t = QTable({'a': [1, 2] * u.m})
828.     t['a'].info.description = 'parrot'
829.     t['a'].info.format = '7.2f'
830.     tser = serialize.represent_mixins_as_columns(t)
831.     assert '__info__' not in tser.meta['__serialized_columns__']['a']
832.     assert tser['a'].format == '7.2f'
833.     assert tser['a'].description == 'parrot'
834. 
835. 
836. def test_skycoord_with_velocity():
837.     # Regression test for gh-6447
838.     sc = SkyCoord([1], [2], unit='deg', galcen_v_sun=None)
839.     t = Table([sc])
840.     s = StringIO()
841.     t.write(s, format='ascii.ecsv', overwrite=True)
842.     s.seek(0)
843.     t2 = Table.read(s.read(), format='ascii.ecsv')
844.     assert skycoord_equal(t2['col0'], sc)
845. 
846. 
847. @pytest.mark.parametrize('table_cls', [Table, QTable])
848. def test_ensure_input_info_is_unchanged(table_cls):
849.     """If a mixin input to a table has no info, it should stay that way.
850. 
851.     This since having 'info' slows down slicing, etc.
852.     See gh-11066.
853.     """
854.     q = [1, 2] * u.m
855.     assert 'info' not in q.__dict__
856.     t = table_cls([q], names=['q'])
857.     assert 'info' not in q.__dict__
858.     t = table_cls([q])
859.     assert 'info' not in q.__dict__
860.     t = table_cls({'q': q})
861.     assert 'info' not in q.__dict__
862.     t['q2'] = q
863.     assert 'info' not in q.__dict__
864.     sc = SkyCoord([1, 2], [2, 3], unit='deg')
865.     t['sc'] = sc
866.     assert 'info' not in sc.__dict__
867. 
868. 
869. def test_bad_info_class():
870.     """Make a mixin column class that does not trigger the machinery to generate
871.     a pure column representation"""
872.     class MyArrayWrapper(ArrayWrapper):
873.         info = ParentDtypeInfo()
874. 
875.     t = Table()
876.     t['tm'] = MyArrayWrapper([0, 1, 2])
877.     out = StringIO()
878.     match = r"failed to represent column 'tm' \(MyArrayWrapper\) as one or more Column subclasses"
879.     with pytest.raises(TypeError, match=match):
880.         represent_mixins_as_columns(t)


--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to a given query and the refinement query, and return your response in the specified format!
EVERY context object MUST include: reasoning, relative_path, start_line, and end_line.

2025-10-04 06:57:46,564 - thread-139911184823872.app.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="The user explicitly requested the full content of the file `astropy/table/tests/test_mixin.py`. This context block represents the entire file, from start to end, fulfilling the user's request.", relative_path='astropy/table/tests/test_mixin.py', start_line=1, end_line=880)]
2025-10-04 06:57:46,565 - thread-139911184823872.app.lang_graph.nodes.context_extraction_node - INFO - Context extraction complete, returning context [Context(relative_path='astropy/table/tests/test_mixin.py', content='1. # -*- coding: utf-8 -*-\n2. # Licensed under a 3-clause BSD style license - see LICENSE.rst\n3. \n4. \n5. import copy\n6. import pickle\n7. from io import StringIO\n8. \n9. import pytest\n10. import numpy as np\n11. \n12. from astropy.table.serialize import represent_mixins_as_columns\n13. from astropy.utils.data_info import ParentDtypeInfo\n14. from astropy.table.table_helpers import ArrayWrapper\n15. from astropy.coordinates import EarthLocation, SkyCoord\n16. from astropy.table import Table, QTable, join, hstack, vstack, Column, NdarrayMixin\n17. from astropy.table import serialize\n18. from astropy import time\n19. from astropy import coordinates\n20. from astropy import units as u\n21. from astropy.table.column import BaseColumn\n22. from astropy.table import table_helpers\n23. from astropy.utils.exceptions import AstropyUserWarning\n24. from astropy.utils.metadata import MergeConflictWarning\n25. from astropy.coordinates.tests.test_representation import representation_equal\n26. from astropy.coordinates.tests.helper import skycoord_equal\n27. \n28. from .conftest import MIXIN_COLS\n29. \n30. \n31. def test_attributes(mixin_cols):\n32.     """\n33.     Required attributes for a column can be set.\n34.     """\n35.     m = mixin_cols[\'m\']\n36.     m.info.name = \'a\'\n37.     assert m.info.name == \'a\'\n38. \n39.     m.info.description = \'a\'\n40.     assert m.info.description == \'a\'\n41. \n42.     # Cannot set unit for these classes\n43.     if isinstance(m, (u.Quantity, coordinates.SkyCoord, time.Time, time.TimeDelta,\n44.                       coordinates.BaseRepresentationOrDifferential)):\n45.         with pytest.raises(AttributeError):\n46.             m.info.unit = u.m\n47.     else:\n48.         m.info.unit = u.m\n49.         assert m.info.unit is u.m\n50. \n51.     m.info.format = \'a\'\n52.     assert m.info.format == \'a\'\n53. \n54.     m.info.meta = {\'a\': 1}\n55.     assert m.info.meta == {\'a\': 1}\n56. \n57.     with pytest.raises(AttributeError):\n58.         m.info.bad_attr = 1\n59. \n60.     with pytest.raises(AttributeError):\n61.         m.info.bad_attr\n62. \n63. \n64. def check_mixin_type(table, table_col, in_col):\n65.     # We check for QuantityInfo rather than just isinstance(col, u.Quantity)\n66.     # since we want to treat EarthLocation as a mixin, even though it is\n67.     # a Quantity subclass.\n68.     if ((isinstance(in_col.info, u.QuantityInfo) and type(table) is not QTable)\n69.             or isinstance(in_col, Column)):\n70.         assert type(table_col) is table.ColumnClass\n71.     else:\n72.         assert type(table_col) is type(in_col)\n73. \n74.     # Make sure in_col got copied and creating table did not touch it\n75.     assert in_col.info.name is None\n76. \n77. \n78. def test_make_table(table_types, mixin_cols):\n79.     """\n80.     Make a table with the columns in mixin_cols, which is an ordered dict of\n81.     three cols: \'a\' and \'b\' are table_types.Column type, and \'m\' is a mixin.\n82.     """\n83.     t = table_types.Table(mixin_cols)\n84.     check_mixin_type(t, t[\'m\'], mixin_cols[\'m\'])\n85. \n86.     cols = list(mixin_cols.values())\n87.     t = table_types.Table(cols, names=(\'i\', \'a\', \'b\', \'m\'))\n88.     check_mixin_type(t, t[\'m\'], mixin_cols[\'m\'])\n89. \n90.     t = table_types.Table(cols)\n91.     check_mixin_type(t, t[\'col3\'], mixin_cols[\'m\'])\n92. \n93. \n94. def test_io_ascii_write():\n95.     """\n96.     Test that table with mixin column can be written by io.ascii for\n97.     every pure Python writer.  No validation of the output is done,\n98.     this just confirms no exceptions.\n99.     """\n100.     from astropy.io.ascii.connect import _get_connectors_table\n101.     t = QTable(MIXIN_COLS)\n102.     for fmt in _get_connectors_table():\n103.         if fmt[\'Write\'] and \'.fast_\' not in fmt[\'Format\']:\n104.             out = StringIO()\n105.             t.write(out, format=fmt[\'Format\'])\n106. \n107. \n108. def test_votable_quantity_write(tmpdir):\n109.     """\n110.     Test that table with Quantity mixin column can be round-tripped by\n111.     io.votable.  Note that FITS and HDF5 mixin support are tested (much more\n112.     thoroughly) in their respective subpackage tests\n113.     (io/fits/tests/test_connect.py and io/misc/tests/test_hdf5.py).\n114.     """\n115.     t = QTable()\n116.     t[\'a\'] = u.Quantity([1, 2, 4], unit=\'nm\')\n117. \n118.     filename = str(tmpdir.join(\'table-tmp\'))\n119.     t.write(filename, format=\'votable\', overwrite=True)\n120.     qt = QTable.read(filename, format=\'votable\')\n121.     assert isinstance(qt[\'a\'], u.Quantity)\n122.     assert qt[\'a\'].unit == \'nm\'\n123. \n124. \n125. @pytest.mark.remote_data\n126. @pytest.mark.parametrize(\'table_types\', (Table, QTable))\n127. def test_io_time_write_fits_standard(tmpdir, table_types):\n128.     """\n129.     Test that table with Time mixin columns can be written by io.fits.\n130.     Validation of the output is done. Test that io.fits writes a table\n131.     containing Time mixin columns that can be partially round-tripped\n132.     (metadata scale, location).\n133. \n134.     Note that we postpone checking the "local" scale, since that cannot\n135.     be done with format \'cxcsec\', as it requires an epoch.\n136.     """\n137.     t = table_types([[1, 2], [\'string\', \'column\']])\n138.     for scale in time.STANDARD_TIME_SCALES:\n139.         t[\'a\' + scale] = time.Time([[1, 2], [3, 4]], format=\'cxcsec\',\n140.                                    scale=scale, location=EarthLocation(\n141.             -2446354, 4237210, 4077985, unit=\'m\'))\n142.         t[\'b\' + scale] = time.Time([\'1999-01-01T00:00:00.123456789\',\n143.                                     \'2010-01-01T00:00:00\'], scale=scale)\n144.     t[\'c\'] = [3., 4.]\n145. \n146.     filename = str(tmpdir.join(\'table-tmp\'))\n147. \n148.     # Show that FITS format succeeds\n149.     with pytest.warns(\n150.             AstropyUserWarning,\n151.             match=\'Time Column "btai" has no specified location, \'\n152.             \'but global Time Position is present\'):\n153.         t.write(filename, format=\'fits\', overwrite=True)\n154.     with pytest.warns(\n155.             AstropyUserWarning,\n156.             match=\'Time column reference position "TRPOSn" is not specified\'):\n157.         tm = table_types.read(filename, format=\'fits\', astropy_native=True)\n158. \n159.     for scale in time.STANDARD_TIME_SCALES:\n160.         for ab in (\'a\', \'b\'):\n161.             name = ab + scale\n162. \n163.             # Assert that the time columns are read as Time\n164.             assert isinstance(tm[name], time.Time)\n165. \n166.             # Assert that the scales round-trip\n167.             assert tm[name].scale == t[name].scale\n168. \n169.             # Assert that the format is jd\n170.             assert tm[name].format == \'jd\'\n171. \n172.             # Assert that the location round-trips\n173.             assert tm[name].location == t[name].location\n174. \n175.             # Finally assert that the column data round-trips\n176.             assert (tm[name] == t[name]).all()\n177. \n178.     for name in (\'col0\', \'col1\', \'c\'):\n179.         # Assert that the non-time columns are read as Column\n180.         assert isinstance(tm[name], Column)\n181. \n182.         # Assert that the non-time columns\' data round-trips\n183.         assert (tm[name] == t[name]).all()\n184. \n185.     # Test for conversion of time data to its value, as defined by its format\n186.     for scale in time.STANDARD_TIME_SCALES:\n187.         for ab in (\'a\', \'b\'):\n188.             name = ab + scale\n189.             t[name].info.serialize_method[\'fits\'] = \'formatted_value\'\n190. \n191.     t.write(filename, format=\'fits\', overwrite=True)\n192.     tm = table_types.read(filename, format=\'fits\')\n193. \n194.     for scale in time.STANDARD_TIME_SCALES:\n195.         for ab in (\'a\', \'b\'):\n196.             name = ab + scale\n197. \n198.             assert not isinstance(tm[name], time.Time)\n199.             assert (tm[name] == t[name].value).all()\n200. \n201. \n202. @pytest.mark.parametrize(\'table_types\', (Table, QTable))\n203. def test_io_time_write_fits_local(tmpdir, table_types):\n204.     """\n205.     Test that table with a Time mixin with scale local can also be written\n206.     by io.fits. Like ``test_io_time_write_fits_standard`` above, but avoiding\n207.     ``cxcsec`` format, which requires an epoch and thus cannot be used for a\n208.     local time scale.\n209.     """\n210.     t = table_types([[1, 2], [\'string\', \'column\']])\n211.     t[\'a_local\'] = time.Time([[50001, 50002], [50003, 50004]],\n212.                              format=\'mjd\', scale=\'local\',\n213.                              location=EarthLocation(-2446354, 4237210, 4077985,\n214.                                                     unit=\'m\'))\n215.     t[\'b_local\'] = time.Time([\'1999-01-01T00:00:00.123456789\',\n216.                               \'2010-01-01T00:00:00\'], scale=\'local\')\n217.     t[\'c\'] = [3., 4.]\n218. \n219.     filename = str(tmpdir.join(\'table-tmp\'))\n220. \n221.     # Show that FITS format succeeds\n222. \n223.     with pytest.warns(AstropyUserWarning,\n224.                       match=\'Time Column "b_local" has no specified location\'):\n225.         t.write(filename, format=\'fits\', overwrite=True)\n226. \n227.     with pytest.warns(AstropyUserWarning,\n228.                       match=\'Time column reference position "TRPOSn" is not specified.\'):\n229.         tm = table_types.read(filename, format=\'fits\', astropy_native=True)\n230. \n231.     for ab in (\'a\', \'b\'):\n232.         name = ab + \'_local\'\n233. \n234.         # Assert that the time columns are read as Time\n235.         assert isinstance(tm[name], time.Time)\n236. \n237.         # Assert that the scales round-trip\n238.         assert tm[name].scale == t[name].scale\n239. \n240.         # Assert that the format is jd\n241.         assert tm[name].format == \'jd\'\n242. \n243.         # Assert that the location round-trips\n244.         assert tm[name].location == t[name].location\n245. \n246.         # Finally assert that the column data round-trips\n247.         assert (tm[name] == t[name]).all()\n248. \n249.     for name in (\'col0\', \'col1\', \'c\'):\n250.         # Assert that the non-time columns are read as Column\n251.         assert isinstance(tm[name], Column)\n252. \n253.         # Assert that the non-time columns\' data round-trips\n254.         assert (tm[name] == t[name]).all()\n255. \n256.     # Test for conversion of time data to its value, as defined by its format.\n257.     for ab in (\'a\', \'b\'):\n258.         name = ab + \'_local\'\n259.         t[name].info.serialize_method[\'fits\'] = \'formatted_value\'\n260. \n261.     t.write(filename, format=\'fits\', overwrite=True)\n262.     tm = table_types.read(filename, format=\'fits\')\n263. \n264.     for ab in (\'a\', \'b\'):\n265.         name = ab + \'_local\'\n266. \n267.         assert not isinstance(tm[name], time.Time)\n268.         assert (tm[name] == t[name].value).all()\n269. \n270. \n271. def test_votable_mixin_write_fail(mixin_cols):\n272.     """\n273.     Test that table with mixin columns (excluding Quantity) cannot be written by\n274.     io.votable.\n275.     """\n276.     t = QTable(mixin_cols)\n277.     # Only do this test if there are unsupported column types (i.e. anything besides\n278.     # BaseColumn and Quantity class instances).\n279.     unsupported_cols = t.columns.not_isinstance((BaseColumn, u.Quantity))\n280. \n281.     if not unsupported_cols:\n282.         pytest.skip("no unsupported column types")\n283. \n284.     out = StringIO()\n285.     with pytest.raises(ValueError) as err:\n286.         t.write(out, format=\'votable\')\n287.     assert \'cannot write table with mixin column(s)\' in str(err.value)\n288. \n289. \n290. def test_join(table_types):\n291.     """\n292.     Join tables with mixin cols.  Use column "i" as proxy for what the\n293.     result should be for each mixin.\n294.     """\n295.     t1 = table_types.Table()\n296.     t1[\'a\'] = table_types.Column([\'a\', \'b\', \'b\', \'c\'])\n297.     t1[\'i\'] = table_types.Column([0, 1, 2, 3])\n298.     for name, col in MIXIN_COLS.items():\n299.         t1[name] = col\n300. \n301.     t2 = table_types.Table(t1)\n302.     t2[\'a\'] = [\'b\', \'c\', \'a\', \'d\']\n303. \n304.     for name, col in MIXIN_COLS.items():\n305.         t1[name].info.description = name\n306.         t2[name].info.description = name + \'2\'\n307. \n308.     for join_type in (\'inner\', \'left\'):\n309.         t12 = join(t1, t2, keys=\'a\', join_type=join_type)\n310.         idx1 = t12[\'i_1\']\n311.         idx2 = t12[\'i_2\']\n312.         for name, col in MIXIN_COLS.items():\n313.             name1 = name + \'_1\'\n314.             name2 = name + \'_2\'\n315.             assert_table_name_col_equal(t12, name1, col[idx1])\n316.             assert_table_name_col_equal(t12, name2, col[idx2])\n317.             assert t12[name1].info.description == name\n318.             assert t12[name2].info.description == name + \'2\'\n319. \n320.     for join_type in (\'outer\', \'right\'):\n321.         with pytest.raises(NotImplementedError) as exc:\n322.             t12 = join(t1, t2, keys=\'a\', join_type=join_type)\n323.         assert \'join requires masking column\' in str(exc.value)\n324. \n325.     with pytest.raises(TypeError) as exc:\n326.         t12 = join(t1, t2, keys=[\'a\', \'skycoord\'])\n327.     assert \'one or more key columns are not sortable\' in str(exc.value)\n328. \n329.     # Join does work for a mixin which is a subclass of np.ndarray\n330.     with pytest.warns(MergeConflictWarning,\n331.                       match="In merged column \'quantity\' the \'description\' "\n332.                             "attribute does not match"):\n333.         t12 = join(t1, t2, keys=[\'quantity\'])\n334.     assert np.all(t12[\'a_1\'] == t1[\'a\'])\n335. \n336. \n337. def test_hstack(table_types):\n338.     """\n339.     Hstack tables with mixin cols.  Use column "i" as proxy for what the\n340.     result should be for each mixin.\n341.     """\n342.     t1 = table_types.Table()\n343.     t1[\'i\'] = table_types.Column([0, 1, 2, 3])\n344.     for name, col in MIXIN_COLS.items():\n345.         t1[name] = col\n346.         t1[name].info.description = name\n347.         t1[name].info.meta = {\'a\': 1}\n348. \n349.     for join_type in (\'inner\', \'outer\'):\n350.         for chop in (True, False):\n351.             t2 = table_types.Table(t1)\n352.             if chop:\n353.                 t2 = t2[:-1]\n354.                 if join_type == \'outer\':\n355.                     with pytest.raises(NotImplementedError) as exc:\n356.                         t12 = hstack([t1, t2], join_type=join_type)\n357.                     assert \'hstack requires masking column\' in str(exc.value)\n358.                     continue\n359. \n360.             t12 = hstack([t1, t2], join_type=join_type)\n361.             idx1 = t12[\'i_1\']\n362.             idx2 = t12[\'i_2\']\n363.             for name, col in MIXIN_COLS.items():\n364.                 name1 = name + \'_1\'\n365.                 name2 = name + \'_2\'\n366.                 assert_table_name_col_equal(t12, name1, col[idx1])\n367.                 assert_table_name_col_equal(t12, name2, col[idx2])\n368.                 for attr in (\'description\', \'meta\'):\n369.                     assert getattr(t1[name].info, attr) == getattr(t12[name1].info, attr)\n370.                     assert getattr(t2[name].info, attr) == getattr(t12[name2].info, attr)\n371. \n372. \n373. def assert_table_name_col_equal(t, name, col):\n374.     """\n375.     Assert all(t[name] == col), with special handling for known mixin cols.\n376.     """\n377.     if isinstance(col, coordinates.SkyCoord):\n378.         assert np.all(t[name].ra == col.ra)\n379.         assert np.all(t[name].dec == col.dec)\n380.     elif isinstance(col, coordinates.BaseRepresentationOrDifferential):\n381.         assert np.all(representation_equal(t[name], col))\n382.     elif isinstance(col, u.Quantity):\n383.         if type(t) is QTable:\n384.             assert np.all(t[name] == col)\n385.     elif isinstance(col, table_helpers.ArrayWrapper):\n386.         assert np.all(t[name].data == col.data)\n387.     else:\n388.         assert np.all(t[name] == col)\n389. \n390. \n391. def test_get_items(mixin_cols):\n392.     """\n393.     Test that slicing / indexing table gives right values and col attrs inherit\n394.     """\n395.     attrs = (\'name\', \'unit\', \'dtype\', \'format\', \'description\', \'meta\')\n396.     m = mixin_cols[\'m\']\n397.     m.info.name = \'m\'\n398.     m.info.format = \'{0}\'\n399.     m.info.description = \'d\'\n400.     m.info.meta = {\'a\': 1}\n401.     t = QTable([m])\n402.     for item in ([1, 3], np.array([0, 2]), slice(1, 3)):\n403.         t2 = t[item]\n404.         m2 = m[item]\n405.         assert_table_name_col_equal(t2, \'m\', m[item])\n406.         for attr in attrs:\n407.             assert getattr(t2[\'m\'].info, attr) == getattr(m.info, attr)\n408.             assert getattr(m2.info, attr) == getattr(m.info, attr)\n409. \n410. \n411. def test_info_preserved_pickle_copy_init(mixin_cols):\n412.     """\n413.     Test copy, pickle, and init from class roundtrip preserve info.  This\n414.     tests not only the mixin classes but a regular column as well.\n415.     """\n416.     def pickle_roundtrip(c):\n417.         return pickle.loads(pickle.dumps(c))\n418. \n419.     def init_from_class(c):\n420.         return c.__class__(c)\n421. \n422.     attrs = (\'name\', \'unit\', \'dtype\', \'format\', \'description\', \'meta\')\n423.     for colname in (\'i\', \'m\'):\n424.         m = mixin_cols[colname]\n425.         m.info.name = colname\n426.         m.info.format = \'{0}\'\n427.         m.info.description = \'d\'\n428.         m.info.meta = {\'a\': 1}\n429.         for func in (copy.copy, copy.deepcopy, pickle_roundtrip, init_from_class):\n430.             m2 = func(m)\n431.             for attr in attrs:\n432.                 # non-native byteorder not preserved by last 2 func, _except_ for structured dtype\n433.                 if (attr != \'dtype\'\n434.                         or getattr(m.info.dtype, \'isnative\', True)\n435.                         or m.info.dtype.name.startswith(\'void\')\n436.                         or func in (copy.copy, copy.deepcopy)):\n437.                     original = getattr(m.info, attr)\n438.                 else:\n439.                     # func does not preserve byteorder, check against (native) type.\n440.                     original = m.info.dtype.newbyteorder(\'=\')\n441.                 assert getattr(m2.info, attr) == original\n442. \n443. \n444. def test_add_column(mixin_cols):\n445.     """\n446.     Test that adding a column preserves values and attributes\n447.     """\n448.     attrs = (\'name\', \'unit\', \'dtype\', \'format\', \'description\', \'meta\')\n449.     m = mixin_cols[\'m\']\n450.     assert m.info.name is None\n451. \n452.     # Make sure adding column in various ways doesn\'t touch\n453.     t = QTable([m], names=[\'a\'])\n454.     assert m.info.name is None\n455. \n456.     t[\'new\'] = m\n457.     assert m.info.name is None\n458. \n459.     m.info.name = \'m\'\n460.     m.info.format = \'{0}\'\n461.     m.info.description = \'d\'\n462.     m.info.meta = {\'a\': 1}\n463.     t = QTable([m])\n464. \n465.     # Add columns m2, m3, m4 by two different methods and test expected equality\n466.     t[\'m2\'] = m\n467.     m.info.name = \'m3\'\n468.     t.add_columns([m], copy=True)\n469.     m.info.name = \'m4\'\n470.     t.add_columns([m], copy=False)\n471.     for name in (\'m2\', \'m3\', \'m4\'):\n472.         assert_table_name_col_equal(t, name, m)\n473.         for attr in attrs:\n474.             if attr != \'name\':\n475.                 assert getattr(t[\'m\'].info, attr) == getattr(t[name].info, attr)\n476.     # Also check that one can set using a scalar.\n477.     s = m[0]\n478.     if type(s) is type(m) and \'info\' in s.__dict__:\n479.         # We\'re not going to worry about testing classes for which scalars\n480.         # are a different class than the real array, or where info is not copied.\n481.         t[\'s\'] = m[0]\n482.         assert_table_name_col_equal(t, \'s\', m[0])\n483.         for attr in attrs:\n484.             if attr != \'name\':\n485.                 assert getattr(t[\'m\'].info, attr) == getattr(t[\'s\'].info, attr)\n486. \n487.     # While we\'re add it, also check a length-1 table.\n488.     t = QTable([m[1:2]], names=[\'m\'])\n489.     if type(s) is type(m) and \'info\' in s.__dict__:\n490.         t[\'s\'] = m[0]\n491.         assert_table_name_col_equal(t, \'s\', m[0])\n492.         for attr in attrs:\n493.             if attr != \'name\':\n494.                 assert getattr(t[\'m\'].info, attr) == getattr(t[\'s\'].info, attr)\n495. \n496. \n497. def test_vstack():\n498.     """\n499.     Vstack tables with mixin cols.\n500.     """\n501.     t1 = QTable(MIXIN_COLS)\n502.     t2 = QTable(MIXIN_COLS)\n503.     with pytest.raises(NotImplementedError):\n504.         vstack([t1, t2])\n505. \n506. \n507. def test_insert_row(mixin_cols):\n508.     """\n509.     Test inserting a row, which works for Column, Quantity, Time and SkyCoord.\n510.     """\n511.     t = QTable(mixin_cols)\n512.     t0 = t.copy()\n513.     t[\'m\'].info.description = \'d\'\n514.     idxs = [0, -1, 1, 2, 3]\n515.     if isinstance(t[\'m\'], (u.Quantity, Column, time.Time, time.TimeDelta, coordinates.SkyCoord)):\n516.         t.insert_row(1, t[-1])\n517. \n518.         for name in t.colnames:\n519.             col = t[name]\n520.             if isinstance(col, coordinates.SkyCoord):\n521.                 assert skycoord_equal(col, t0[name][idxs])\n522.             else:\n523.                 assert np.all(col == t0[name][idxs])\n524. \n525.         assert t[\'m\'].info.description == \'d\'\n526.     else:\n527.         with pytest.raises(ValueError) as exc:\n528.             t.insert_row(1, t[-1])\n529.         assert "Unable to insert row" in str(exc.value)\n530. \n531. \n532. def test_insert_row_bad_unit():\n533.     """\n534.     Insert a row into a QTable with the wrong unit\n535.     """\n536.     t = QTable([[1] * u.m])\n537.     with pytest.raises(ValueError) as exc:\n538.         t.insert_row(0, (2 * u.m / u.s,))\n539.     assert "\'m / s\' (speed/velocity) and \'m\' (length) are not convertible" in str(exc.value)\n540. \n541. \n542. def test_convert_np_array(mixin_cols):\n543.     """\n544.     Test that converting to numpy array creates an object dtype and that\n545.     each instance in the array has the expected type.\n546.     """\n547.     t = QTable(mixin_cols)\n548.     ta = t.as_array()\n549.     m = mixin_cols[\'m\']\n550.     dtype_kind = m.dtype.kind if hasattr(m, \'dtype\') else \'O\'\n551.     assert ta[\'m\'].dtype.kind == dtype_kind\n552. \n553. \n554. def test_assignment_and_copy():\n555.     """\n556.     Test that assignment of an int, slice, and fancy index works.\n557.     Along the way test that copying table works.\n558.     """\n559.     for name in (\'quantity\', \'arraywrap\'):\n560.         m = MIXIN_COLS[name]\n561.         t0 = QTable([m], names=[\'m\'])\n562.         for i0, i1 in ((1, 2),\n563.                        (slice(0, 2), slice(1, 3)),\n564.                        (np.array([1, 2]), np.array([2, 3]))):\n565.             t = t0.copy()\n566.             t[\'m\'][i0] = m[i1]\n567.             if name == \'arraywrap\':\n568.                 assert np.all(t[\'m\'].data[i0] == m.data[i1])\n569.                 assert np.all(t0[\'m\'].data[i0] == m.data[i0])\n570.                 assert np.all(t0[\'m\'].data[i0] != t[\'m\'].data[i0])\n571.             else:\n572.                 assert np.all(t[\'m\'][i0] == m[i1])\n573.                 assert np.all(t0[\'m\'][i0] == m[i0])\n574.                 assert np.all(t0[\'m\'][i0] != t[\'m\'][i0])\n575. \n576. \n577. def test_conversion_qtable_table():\n578.     """\n579.     Test that a table round trips from QTable => Table => QTable\n580.     """\n581.     qt = QTable(MIXIN_COLS)\n582.     names = qt.colnames\n583.     for name in names:\n584.         qt[name].info.description = name\n585. \n586.     t = Table(qt)\n587.     for name in names:\n588.         assert t[name].info.description == name\n589.         if name == \'quantity\':\n590.             assert np.all(t[\'quantity\'] == qt[\'quantity\'].value)\n591.             assert np.all(t[\'quantity\'].unit is qt[\'quantity\'].unit)\n592.             assert isinstance(t[\'quantity\'], t.ColumnClass)\n593.         else:\n594.             assert_table_name_col_equal(t, name, qt[name])\n595. \n596.     qt2 = QTable(qt)\n597.     for name in names:\n598.         assert qt2[name].info.description == name\n599.         assert_table_name_col_equal(qt2, name, qt[name])\n600. \n601. \n602. def test_setitem_as_column_name():\n603.     """\n604.     Test for mixin-related regression described in #3321.\n605.     """\n606.     t = Table()\n607.     t[\'a\'] = [\'x\', \'y\']\n608.     t[\'b\'] = \'b\'  # Previously was failing with KeyError\n609.     assert np.all(t[\'a\'] == [\'x\', \'y\'])\n610.     assert np.all(t[\'b\'] == [\'b\', \'b\'])\n611. \n612. \n613. def test_quantity_representation():\n614.     """\n615.     Test that table representation of quantities does not have unit\n616.     """\n617.     t = QTable([[1, 2] * u.m])\n618.     assert t.pformat() == [\'col0\',\n619.                            \' m  \',\n620.                            \'----\',\n621.                            \' 1.0\',\n622.                            \' 2.0\']\n623. \n624. \n625. def test_representation_representation():\n626.     """\n627.     Test that Representations are represented correctly.\n628.     """\n629.     # With no unit we get "None" in the unit row\n630.     c = coordinates.CartesianRepresentation([0], [1], [0], unit=u.one)\n631.     t = Table([c])\n632.     assert t.pformat() == [\'    col0    \',\n633.                            \'------------\',\n634.                            \'(0., 1., 0.)\']\n635. \n636.     c = coordinates.CartesianRepresentation([0], [1], [0], unit=\'m\')\n637.     t = Table([c])\n638.     assert t.pformat() == [\'    col0    \',\n639.                            \'     m      \',\n640.                            \'------------\',\n641.                            \'(0., 1., 0.)\']\n642. \n643.     c = coordinates.SphericalRepresentation([10]*u.deg, [20]*u.deg, [1]*u.pc)\n644.     t = Table([c])\n645.     assert t.pformat() == [\'     col0     \',\n646.                            \' deg, deg, pc \',\n647.                            \'--------------\',\n648.                            \'(10., 20., 1.)\']\n649. \n650.     c = coordinates.UnitSphericalRepresentation([10]*u.deg, [20]*u.deg)\n651.     t = Table([c])\n652.     assert t.pformat() == [\'   col0   \',\n653.                            \'   deg    \',\n654.                            \'----------\',\n655.                            \'(10., 20.)\']\n656. \n657.     c = coordinates.SphericalCosLatDifferential(\n658.         [10]*u.mas/u.yr, [2]*u.mas/u.yr, [10]*u.km/u.s)\n659.     t = Table([c])\n660.     assert t.pformat() == [\'           col0           \',\n661.                            \'mas / yr, mas / yr, km / s\',\n662.                            \'--------------------------\',\n663.                            \'            (10., 2., 10.)\']\n664. \n665. \n666. def test_skycoord_representation():\n667.     """\n668.     Test that skycoord representation works, both in the way that the\n669.     values are output and in changing the frame representation.\n670.     """\n671.     # With no unit we get "None" in the unit row\n672.     c = coordinates.SkyCoord([0], [1], [0], representation_type=\'cartesian\')\n673.     t = Table([c])\n674.     assert t.pformat() == [\'     col0     \',\n675.                            \'None,None,None\',\n676.                            \'--------------\',\n677.                            \'   0.0,1.0,0.0\']\n678. \n679.     # Test that info works with a dynamically changed representation\n680.     c = coordinates.SkyCoord([0], [1], [0], unit=\'m\', representation_type=\'cartesian\')\n681.     t = Table([c])\n682.     assert t.pformat() == [\'    col0   \',\n683.                            \'   m,m,m   \',\n684.                            \'-----------\',\n685.                            \'0.0,1.0,0.0\']\n686. \n687.     t[\'col0\'].representation_type = \'unitspherical\'\n688.     assert t.pformat() == [\'  col0  \',\n689.                            \'deg,deg \',\n690.                            \'--------\',\n691.                            \'90.0,0.0\']\n692. \n693.     t[\'col0\'].representation_type = \'cylindrical\'\n694.     assert t.pformat() == [\'    col0    \',\n695.                            \'  m,deg,m   \',\n696.                            \'------------\',\n697.                            \'1.0,90.0,0.0\']\n698. \n699. \n700. def test_ndarray_mixin():\n701.     """\n702.     Test directly adding a plain structured array into a table instead of the\n703.     view as an NdarrayMixin.  Once added as an NdarrayMixin then all the previous\n704.     tests apply.\n705.     """\n706.     a = np.array([(1, \'a\'), (2, \'b\'), (3, \'c\'), (4, \'d\')],\n707.                  dtype=\'<i4,\' + (\'|U1\'))\n708.     b = np.array([(10, \'aa\'), (20, \'bb\'), (30, \'cc\'), (40, \'dd\')],\n709.                  dtype=[(\'x\', \'i4\'), (\'y\', (\'U2\'))])\n710.     c = np.rec.fromrecords([(100., \'raa\'), (200., \'rbb\'), (300., \'rcc\'), (400., \'rdd\')],\n711.                            names=[\'rx\', \'ry\'])\n712.     d = np.arange(8, dtype=\'i8\').reshape(4, 2).view(NdarrayMixin)\n713. \n714.     # Add one during initialization and the next as a new column.\n715.     t = Table([a], names=[\'a\'])\n716.     t[\'b\'] = b\n717.     t[\'c\'] = c\n718.     t[\'d\'] = d\n719. \n720.     assert isinstance(t[\'a\'], NdarrayMixin)\n721. \n722.     assert t[\'a\'][1][1] == a[1][1]\n723.     assert t[\'a\'][2][0] == a[2][0]\n724. \n725.     assert t[1][\'a\'][1] == a[1][1]\n726.     assert t[2][\'a\'][0] == a[2][0]\n727. \n728.     assert isinstance(t[\'b\'], NdarrayMixin)\n729. \n730.     assert t[\'b\'][1][\'x\'] == b[1][\'x\']\n731.     assert t[\'b\'][1][\'y\'] == b[1][\'y\']\n732. \n733.     assert t[1][\'b\'][\'x\'] == b[1][\'x\']\n734.     assert t[1][\'b\'][\'y\'] == b[1][\'y\']\n735. \n736.     assert isinstance(t[\'c\'], NdarrayMixin)\n737. \n738.     assert t[\'c\'][1][\'rx\'] == c[1][\'rx\']\n739.     assert t[\'c\'][1][\'ry\'] == c[1][\'ry\']\n740. \n741.     assert t[1][\'c\'][\'rx\'] == c[1][\'rx\']\n742.     assert t[1][\'c\'][\'ry\'] == c[1][\'ry\']\n743. \n744.     assert isinstance(t[\'d\'], NdarrayMixin)\n745. \n746.     assert t[\'d\'][1][0] == d[1][0]\n747.     assert t[\'d\'][1][1] == d[1][1]\n748. \n749.     assert t[1][\'d\'][0] == d[1][0]\n750.     assert t[1][\'d\'][1] == d[1][1]\n751. \n752.     assert t.pformat(show_dtype=True) == [\n753.         \'  a [f0, f1]     b [x, y]      c [rx, ry]      d    \',\n754.         \'(int32, str1) (int32, str2) (float64, str3) int64[2]\',\n755.         \'------------- ------------- --------------- --------\',\n756.         "     (1, \'a\')    (10, \'aa\')   (100., \'raa\')   0 .. 1",\n757.         "     (2, \'b\')    (20, \'bb\')   (200., \'rbb\')   2 .. 3",\n758.         "     (3, \'c\')    (30, \'cc\')   (300., \'rcc\')   4 .. 5",\n759.         "     (4, \'d\')    (40, \'dd\')   (400., \'rdd\')   6 .. 7"]\n760. \n761. \n762. def test_possible_string_format_functions():\n763.     """\n764.     The QuantityInfo info class for Quantity implements a\n765.     possible_string_format_functions() method that overrides the\n766.     standard pprint._possible_string_format_functions() function.\n767.     Test this.\n768.     """\n769.     t = QTable([[1, 2] * u.m])\n770.     t[\'col0\'].info.format = \'%.3f\'\n771.     assert t.pformat() == [\' col0\',\n772.                            \'  m  \',\n773.                            \'-----\',\n774.                            \'1.000\',\n775.                            \'2.000\']\n776. \n777.     t[\'col0\'].info.format = \'hi {:.3f}\'\n778.     assert t.pformat() == [\'  col0  \',\n779.                            \'   m    \',\n780.                            \'--------\',\n781.                            \'hi 1.000\',\n782.                            \'hi 2.000\']\n783. \n784.     t[\'col0\'].info.format = \'.4f\'\n785.     assert t.pformat() == [\' col0 \',\n786.                            \'  m   \',\n787.                            \'------\',\n788.                            \'1.0000\',\n789.                            \'2.0000\']\n790. \n791. \n792. def test_rename_mixin_columns(mixin_cols):\n793.     """\n794.     Rename a mixin column.\n795.     """\n796.     t = QTable(mixin_cols)\n797.     tc = t.copy()\n798.     t.rename_column(\'m\', \'mm\')\n799.     assert t.colnames == [\'i\', \'a\', \'b\', \'mm\']\n800.     if isinstance(t[\'mm\'], table_helpers.ArrayWrapper):\n801.         assert np.all(t[\'mm\'].data == tc[\'m\'].data)\n802.     elif isinstance(t[\'mm\'], coordinates.SkyCoord):\n803.         assert np.all(t[\'mm\'].ra == tc[\'m\'].ra)\n804.         assert np.all(t[\'mm\'].dec == tc[\'m\'].dec)\n805.     elif isinstance(t[\'mm\'], coordinates.BaseRepresentationOrDifferential):\n806.         assert np.all(representation_equal(t[\'mm\'], tc[\'m\']))\n807.     else:\n808.         assert np.all(t[\'mm\'] == tc[\'m\'])\n809. \n810. \n811. def test_represent_mixins_as_columns_unit_fix():\n812.     """\n813.     If the unit is invalid for a column that gets serialized this would\n814.     cause an exception.  Fixed in #7481.\n815.     """\n816.     t = Table({\'a\': [1, 2]}, masked=True)\n817.     t[\'a\'].unit = \'not a valid unit\'\n818.     t[\'a\'].mask[1] = True\n819.     serialize.represent_mixins_as_columns(t)\n820. \n821. \n822. def test_primary_data_column_gets_description():\n823.     """\n824.     If the mixin defines a primary data column, that should get the\n825.     description, format, etc., so no __info__ should be needed.\n826.     """\n827.     t = QTable({\'a\': [1, 2] * u.m})\n828.     t[\'a\'].info.description = \'parrot\'\n829.     t[\'a\'].info.format = \'7.2f\'\n830.     tser = serialize.represent_mixins_as_columns(t)\n831.     assert \'__info__\' not in tser.meta[\'__serialized_columns__\'][\'a\']\n832.     assert tser[\'a\'].format == \'7.2f\'\n833.     assert tser[\'a\'].description == \'parrot\'\n834. \n835. \n836. def test_skycoord_with_velocity():\n837.     # Regression test for gh-6447\n838.     sc = SkyCoord([1], [2], unit=\'deg\', galcen_v_sun=None)\n839.     t = Table([sc])\n840.     s = StringIO()\n841.     t.write(s, format=\'ascii.ecsv\', overwrite=True)\n842.     s.seek(0)\n843.     t2 = Table.read(s.read(), format=\'ascii.ecsv\')\n844.     assert skycoord_equal(t2[\'col0\'], sc)\n845. \n846. \n847. @pytest.mark.parametrize(\'table_cls\', [Table, QTable])\n848. def test_ensure_input_info_is_unchanged(table_cls):\n849.     """If a mixin input to a table has no info, it should stay that way.\n850. \n851.     This since having \'info\' slows down slicing, etc.\n852.     See gh-11066.\n853.     """\n854.     q = [1, 2] * u.m\n855.     assert \'info\' not in q.__dict__\n856.     t = table_cls([q], names=[\'q\'])\n857.     assert \'info\' not in q.__dict__\n858.     t = table_cls([q])\n859.     assert \'info\' not in q.__dict__\n860.     t = table_cls({\'q\': q})\n861.     assert \'info\' not in q.__dict__\n862.     t[\'q2\'] = q\n863.     assert \'info\' not in q.__dict__\n864.     sc = SkyCoord([1, 2], [2, 3], unit=\'deg\')\n865.     t[\'sc\'] = sc\n866.     assert \'info\' not in sc.__dict__\n867. \n868. \n869. def test_bad_info_class():\n870.     """Make a mixin column class that does not trigger the machinery to generate\n871.     a pure column representation"""\n872.     class MyArrayWrapper(ArrayWrapper):\n873.         info = ParentDtypeInfo()\n874. \n875.     t = Table()\n876.     t[\'tm\'] = MyArrayWrapper([0, 1, 2])\n877.     out = StringIO()\n878.     match = r"failed to represent column \'tm\' \\(MyArrayWrapper\\) as one or more Column subclasses"\n879.     with pytest.raises(TypeError, match=match):\n880.         represent_mixins_as_columns(t)', start_line_number=1, end_line_number=880)]
2025-10-04 06:57:46,565 - thread-139911184823872.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-10-04 06:57:46,566 - thread-139911184823872.app.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
astropy
â”œâ”€â”€ .circleci
|   â””â”€â”€ config.yml
â”œâ”€â”€ .github
|   â”œâ”€â”€ ISSUE_TEMPLATE
|   |   â”œâ”€â”€ bug_report.md
|   |   â””â”€â”€ feature_request.md
|   â”œâ”€â”€ PULL_REQUEST_TEMPLATE.md
|   â”œâ”€â”€ labeler.yml
|   â””â”€â”€ workflows
|       â”œâ”€â”€ check_changelog.yml
|       â”œâ”€â”€ ci_cron_daily.yml
|       â”œâ”€â”€ ci_cron_weekly.yml
|       â”œâ”€â”€ ci_workflows.yml
|       â”œâ”€â”€ codeql-analysis.yml
|       â”œâ”€â”€ open_actions.yml
|       â”œâ”€â”€ stalebot.yml
|       â””â”€â”€ update_iers.yml
â”œâ”€â”€ .pep8speaks.yml
â”œâ”€â”€ .pre-commit-config.yaml
â”œâ”€â”€ .pyinstaller
|   â”œâ”€â”€ hooks
|   |   â””â”€â”€ hook-skyfield.py
|   â””â”€â”€ run_astropy_tests.py
â”œâ”€â”€ .readthedocs.yml
â”œâ”€â”€ CHANGES.rst
â”œâ”€â”€ CODE_OF_CONDUCT.md
â”œâ”€â”€ CONTRIBUTING.md
â”œâ”€â”€ GOVERNANCE.md
â”œâ”€â”€ LICENSE.rst
â”œâ”€â”€ README.rst
â”œâ”€â”€ astropy
|   â”œâ”€â”€ __init__.py
|   â”œâ”€â”€ _dev
|   |   â”œâ”€â”€ __init__.py
|   |   â””â”€â”€ scm_version.py
|   â”œâ”€â”€ _erfa
|   |   â””â”€â”€ __init__.py
|   â”œâ”€â”€ config
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ affiliated.py
|   |   â”œâ”€â”€ configuration.py
|   |   â”œâ”€â”€ paths.py
|   |   â””â”€â”€ tests
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ data
|   |       â””â”€â”€ test_configs.py
|   â”œâ”€â”€ conftest.py
|   â”œâ”€â”€ constants
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ astropyconst13.py
|   |   â”œâ”€â”€ astropyconst20.py
|   |   â”œâ”€â”€ astropyconst40.py
|   |   â”œâ”€â”€ cgs.py
|   |   â”œâ”€â”€ codata2010.py
|   |   â”œâ”€â”€ codata2014.py
|   |   â”œâ”€â”€ codata2018.py
|   |   â”œâ”€â”€ config.py
|   |   â”œâ”€â”€ constant.py
|   |   â”œâ”€â”€ iau2012.py
|   |   â”œâ”€â”€ iau2015.py
|   |   â”œâ”€â”€ si.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ test_constant.py
|   |   |   â”œâ”€â”€ test_pickle.py
|   |   |   â”œâ”€â”€ test_prior_version.py
|   |   |   â””â”€â”€ test_sciencestate.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ convolution
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ convolve.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ kernels.py
|   |   â”œâ”€â”€ setup_package.py
|   |   â”œâ”€â”€ src
|   |   |   â””â”€â”€ convolve.c
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ test_convolve.py
|   |   |   â”œâ”€â”€ test_convolve_fft.py
|   |   |   â”œâ”€â”€ test_convolve_kernels.py
|   |   |   â”œâ”€â”€ test_convolve_models.py
|   |   |   â”œâ”€â”€ test_convolve_nddata.py
|   |   |   â”œâ”€â”€ test_convolve_speeds.py
|   |   |   â”œâ”€â”€ test_discretize.py
|   |   |   â”œâ”€â”€ test_kernel_class.py
|   |   |   â””â”€â”€ test_pickle.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ coordinates
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ angle_formats.py
|   |   â”œâ”€â”€ angle_lextab.py
|   |   â”œâ”€â”€ angle_parsetab.py
|   |   â”œâ”€â”€ angle_utilities.py
|   |   â”œâ”€â”€ angles.py
|   |   â”œâ”€â”€ attributes.py
|   |   â”œâ”€â”€ baseframe.py
|   |   â”œâ”€â”€ builtin_frames
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ altaz.py
|   |   |   â”œâ”€â”€ baseradec.py
|   |   |   â”œâ”€â”€ cirs.py
|   |   |   â”œâ”€â”€ cirs_observed_transforms.py
|   |   |   â”œâ”€â”€ ecliptic.py
|   |   |   â”œâ”€â”€ ecliptic_transforms.py
|   |   |   â”œâ”€â”€ equatorial.py
|   |   |   â”œâ”€â”€ fk4.py
|   |   |   â”œâ”€â”€ fk4_fk5_transforms.py
|   |   |   â”œâ”€â”€ fk5.py
|   |   |   â”œâ”€â”€ galactic.py
|   |   |   â”œâ”€â”€ galactic_transforms.py
|   |   |   â”œâ”€â”€ galactocentric.py
|   |   |   â”œâ”€â”€ gcrs.py
|   |   |   â”œâ”€â”€ hadec.py
|   |   |   â”œâ”€â”€ hcrs.py
|   |   |   â”œâ”€â”€ icrs.py
|   |   |   â”œâ”€â”€ icrs_cirs_transforms.py
|   |   |   â”œâ”€â”€ icrs_fk5_transforms.py
|   |   |   â”œâ”€â”€ icrs_observed_transforms.py
|   |   |   â”œâ”€â”€ intermediate_rotation_transforms.py
|   |   |   â”œâ”€â”€ itrs.py
|   |   |   â”œâ”€â”€ lsr.py
|   |   |   â”œâ”€â”€ skyoffset.py
|   |   |   â”œâ”€â”€ supergalactic.py
|   |   |   â”œâ”€â”€ supergalactic_transforms.py
|   |   |   â””â”€â”€ utils.py
|   |   â”œâ”€â”€ calculation.py
|   |   â”œâ”€â”€ data
|   |   â”œâ”€â”€ distances.py
|   |   â”œâ”€â”€ earth.py
|   |   â”œâ”€â”€ earth_orientation.py
|   |   â”œâ”€â”€ erfa_astrom.py
|   |   â”œâ”€â”€ errors.py
|   |   â”œâ”€â”€ funcs.py
|   |   â”œâ”€â”€ jparser.py
|   |   â”œâ”€â”€ matching.py
|   |   â”œâ”€â”€ matrix_utilities.py
|   |   â”œâ”€â”€ name_resolve.py
|   |   â”œâ”€â”€ orbital_elements.py
|   |   â”œâ”€â”€ representation.py
|   |   â”œâ”€â”€ sites.py
|   |   â”œâ”€â”€ sky_coordinate.py
|   |   â”œâ”€â”€ sky_coordinate_parsers.py
|   |   â”œâ”€â”€ solar_system.py
|   |   â”œâ”€â”€ spectral_coordinate.py
|   |   â”œâ”€â”€ spectral_quantity.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ accuracy
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ generate_ref_ast.py
|   |   |   |   â”œâ”€â”€ generate_spectralcoord_ref.py
|   |   |   |   â”œâ”€â”€ test_altaz_icrs.py
|   |   |   |   â”œâ”€â”€ test_ecliptic.py
|   |   |   |   â”œâ”€â”€ test_fk4_no_e_fk4.py
|   |   |   |   â”œâ”€â”€ test_fk4_no_e_fk5.py
|   |   |   |   â”œâ”€â”€ test_galactic_fk4.py
|   |   |   |   â””â”€â”€ test_icrs_fk5.py
|   |   |   â”œâ”€â”€ helper.py
|   |   |   â”œâ”€â”€ test_angle_generators.py
|   |   |   â”œâ”€â”€ test_angles.py
|   |   |   â”œâ”€â”€ test_angular_separation.py
|   |   |   â”œâ”€â”€ test_api_ape5.py
|   |   |   â”œâ”€â”€ test_arrays.py
|   |   |   â”œâ”€â”€ test_atc_replacements.py
|   |   |   â”œâ”€â”€ test_celestial_transformations.py
|   |   |   â”œâ”€â”€ test_distance.py
|   |   |   â”œâ”€â”€ test_earth.py
|   |   |   â”œâ”€â”€ test_erfa_astrom.py
|   |   |   â”œâ”€â”€ test_finite_difference_velocities.py
|   |   |   â”œâ”€â”€ test_formatting.py
|   |   |   â”œâ”€â”€ test_frames.py
|   |   |   â”œâ”€â”€ test_frames_with_velocity.py
|   |   |   â”œâ”€â”€ test_funcs.py
|   |   |   â”œâ”€â”€ test_geodetic_representations.py
|   |   |   â”œâ”€â”€ test_iau_fullstack.py
|   |   |   â”œâ”€â”€ test_icrs_observed_transformations.py
|   |   |   â”œâ”€â”€ test_intermediate_transformations.py
|   |   |   â”œâ”€â”€ test_matching.py
|   |   |   â”œâ”€â”€ test_matrix_utilities.py
|   |   |   â”œâ”€â”€ test_name_resolve.py
|   |   |   â”œâ”€â”€ test_pickle.py
|   |   |   â”œâ”€â”€ test_regression.py
|   |   |   â”œâ”€â”€ test_representation.py
|   |   |   â”œâ”€â”€ test_representation_arithmetic.py
|   |   |   â”œâ”€â”€ test_representation_methods.py
|   |   |   â”œâ”€â”€ test_shape_manipulation.py
|   |   |   â”œâ”€â”€ test_sites.py
|   |   |   â”œâ”€â”€ test_sky_coord.py
|   |   |   â”œâ”€â”€ test_sky_coord_velocities.py
|   |   |   â”œâ”€â”€ test_skyoffset_transformations.py
|   |   |   â”œâ”€â”€ test_solar_system.py
|   |   |   â”œâ”€â”€ test_spectral_coordinate.py
|   |   |   â”œâ”€â”€ test_spectral_quantity.py
|   |   |   â”œâ”€â”€ test_transformations.py
|   |   |   â”œâ”€â”€ test_unit_representation.py
|   |   |   â”œâ”€â”€ test_utils.py
|   |   |   â””â”€â”€ test_velocity_corrs.py
|   |   â””â”€â”€ transformations.py
|   â”œâ”€â”€ cosmology
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ connect.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ data
|   |   â”œâ”€â”€ flrw
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ base.py
|   |   |   â”œâ”€â”€ lambdacdm.py
|   |   |   â”œâ”€â”€ tests
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ conftest.py
|   |   |   |   â”œâ”€â”€ test_base.py
|   |   |   |   â”œâ”€â”€ test_init.py
|   |   |   |   â”œâ”€â”€ test_lambdacdm.py
|   |   |   |   â”œâ”€â”€ test_w0cdm.py
|   |   |   |   â”œâ”€â”€ test_w0wacdm.py
|   |   |   |   â”œâ”€â”€ test_w0wzcdm.py
|   |   |   |   â””â”€â”€ test_wpwazpcdm.py
|   |   |   â”œâ”€â”€ w0cdm.py
|   |   |   â”œâ”€â”€ w0wacdm.py
|   |   |   â”œâ”€â”€ w0wzcdm.py
|   |   |   â””â”€â”€ wpwazpcdm.py
|   |   â”œâ”€â”€ funcs.py
|   |   â”œâ”€â”€ io
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ cosmology.py
|   |   |   â”œâ”€â”€ ecsv.py
|   |   |   â”œâ”€â”€ mapping.py
|   |   |   â”œâ”€â”€ model.py
|   |   |   â”œâ”€â”€ row.py
|   |   |   â”œâ”€â”€ table.py
|   |   |   â”œâ”€â”€ tests
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ base.py
|   |   |   |   â”œâ”€â”€ test_.py
|   |   |   |   â”œâ”€â”€ test_cosmology.py
|   |   |   |   â”œâ”€â”€ test_ecsv.py
|   |   |   |   â”œâ”€â”€ test_json.py
|   |   |   |   â”œâ”€â”€ test_mapping.py
|   |   |   |   â”œâ”€â”€ test_model.py
|   |   |   |   â”œâ”€â”€ test_row.py
|   |   |   |   â”œâ”€â”€ test_table.py
|   |   |   |   â””â”€â”€ test_yaml.py
|   |   |   â”œâ”€â”€ utils.py
|   |   |   â””â”€â”€ yaml.py
|   |   â”œâ”€â”€ parameter.py
|   |   â”œâ”€â”€ parameters.py
|   |   â”œâ”€â”€ realizations.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ conftest.py
|   |   |   â”œâ”€â”€ helper.py
|   |   |   â”œâ”€â”€ test_connect.py
|   |   |   â”œâ”€â”€ test_core.py
|   |   |   â”œâ”€â”€ test_cosmology.py
|   |   |   â”œâ”€â”€ test_funcs.py
|   |   |   â”œâ”€â”€ test_parameter.py
|   |   |   â”œâ”€â”€ test_parameters.py
|   |   |   â”œâ”€â”€ test_realizations.py
|   |   |   â”œâ”€â”€ test_units.py
|   |   |   â””â”€â”€ test_utils.py
|   |   â”œâ”€â”€ units.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ extern
|   |   â”œâ”€â”€ README.rst
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ _strptime.py
|   |   â”œâ”€â”€ configobj
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ configobj.py
|   |   |   â””â”€â”€ validate.py
|   |   â”œâ”€â”€ jquery
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â””â”€â”€ data
|   |   |       â”œâ”€â”€ css
|   |   |       â”œâ”€â”€ images
|   |   |       â””â”€â”€ js
|   |   â””â”€â”€ ply
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ cpp.py
|   |       â”œâ”€â”€ ctokens.py
|   |       â”œâ”€â”€ lex.py
|   |       â”œâ”€â”€ yacc.py
|   |       â””â”€â”€ ygen.py
|   â”œâ”€â”€ io
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ ascii
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ basic.py
|   |   |   â”œâ”€â”€ cds.py
|   |   |   â”œâ”€â”€ connect.py
|   |   |   â”œâ”€â”€ core.py
|   |   |   â”œâ”€â”€ daophot.py
|   |   |   â”œâ”€â”€ docs.py
|   |   |   â”œâ”€â”€ ecsv.py
|   |   |   â”œâ”€â”€ fastbasic.py
|   |   |   â”œâ”€â”€ fixedwidth.py
|   |   |   â”œâ”€â”€ html.py
|   |   |   â”œâ”€â”€ ipac.py
|   |   |   â”œâ”€â”€ latex.py
|   |   |   â”œâ”€â”€ misc.py
|   |   |   â”œâ”€â”€ mrt.py
|   |   |   â”œâ”€â”€ qdp.py
|   |   |   â”œâ”€â”€ rst.py
|   |   |   â”œâ”€â”€ setup_package.py
|   |   |   â”œâ”€â”€ sextractor.py
|   |   |   â”œâ”€â”€ src
|   |   |   â”œâ”€â”€ tests
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ common.py
|   |   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ test_c_reader.py
|   |   |   |   â”œâ”€â”€ test_cds.py
|   |   |   |   â”œâ”€â”€ test_cds_header_from_readme.py
|   |   |   |   â”œâ”€â”€ test_compressed.py
|   |   |   |   â”œâ”€â”€ test_connect.py
|   |   |   |   â”œâ”€â”€ test_ecsv.py
|   |   |   |   â”œâ”€â”€ test_fixedwidth.py
|   |   |   |   â”œâ”€â”€ test_html.py
|   |   |   |   â”œâ”€â”€ test_ipac_definitions.py
|   |   |   |   â”œâ”€â”€ test_qdp.py
|   |   |   |   â”œâ”€â”€ test_read.py
|   |   |   |   â”œâ”€â”€ test_rst.py
|   |   |   |   â”œâ”€â”€ test_types.py
|   |   |   |   â””â”€â”€ test_write.py
|   |   |   â””â”€â”€ ui.py
|   |   â”œâ”€â”€ fits
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ card.py
|   |   |   â”œâ”€â”€ column.py
|   |   |   â”œâ”€â”€ connect.py
|   |   |   â”œâ”€â”€ convenience.py
|   |   |   â”œâ”€â”€ diff.py
|   |   |   â”œâ”€â”€ file.py
|   |   |   â”œâ”€â”€ fitsrec.py
|   |   |   â”œâ”€â”€ fitstime.py
|   |   |   â”œâ”€â”€ hdu
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ base.py
|   |   |   |   â”œâ”€â”€ compressed.py
|   |   |   |   â”œâ”€â”€ groups.py
|   |   |   |   â”œâ”€â”€ hdulist.py
|   |   |   |   â”œâ”€â”€ image.py
|   |   |   |   â”œâ”€â”€ nonstandard.py
|   |   |   |   â”œâ”€â”€ streaming.py
|   |   |   |   â””â”€â”€ table.py
|   |   |   â”œâ”€â”€ header.py
|   |   |   â”œâ”€â”€ scripts
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ fitscheck.py
|   |   |   |   â”œâ”€â”€ fitsdiff.py
|   |   |   |   â”œâ”€â”€ fitsheader.py
|   |   |   |   â””â”€â”€ fitsinfo.py
|   |   |   â”œâ”€â”€ setup_package.py
|   |   |   â”œâ”€â”€ src
|   |   |   â”œâ”€â”€ tests
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ test_checksum.py
|   |   |   |   â”œâ”€â”€ test_compression_failures.py
|   |   |   |   â”œâ”€â”€ test_connect.py
|   |   |   |   â”œâ”€â”€ test_convenience.py
|   |   |   |   â”œâ”€â”€ test_core.py
|   |   |   |   â”œâ”€â”€ test_diff.py
|   |   |   |   â”œâ”€â”€ test_division.py
|   |   |   |   â”œâ”€â”€ test_fitscheck.py
|   |   |   |   â”œâ”€â”€ test_fitsdiff.py
|   |   |   |   â”œâ”€â”€ test_fitsheader.py
|   |   |   |   â”œâ”€â”€ test_fitsinfo.py
|   |   |   |   â”œâ”€â”€ test_fitstime.py
|   |   |   |   â”œâ”€â”€ test_groups.py
|   |   |   |   â”œâ”€â”€ test_hdulist.py
|   |   |   |   â”œâ”€â”€ test_header.py
|   |   |   |   â”œâ”€â”€ test_image.py
|   |   |   |   â”œâ”€â”€ test_image_dask.py
|   |   |   |   â”œâ”€â”€ test_nonstandard.py
|   |   |   |   â”œâ”€â”€ test_structured.py
|   |   |   |   â”œâ”€â”€ test_table.py
|   |   |   |   â”œâ”€â”€ test_uint.py
|   |   |   |   â””â”€â”€ test_util.py
|   |   |   â”œâ”€â”€ util.py
|   |   |   â””â”€â”€ verify.py
|   |   â”œâ”€â”€ misc
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ asdf
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ conftest.py
|   |   |   |   â”œâ”€â”€ connect.py
|   |   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ deprecation.py
|   |   |   |   â”œâ”€â”€ extension.py
|   |   |   |   â”œâ”€â”€ tags
|   |   |   |   â”œâ”€â”€ tests
|   |   |   |   â””â”€â”€ types.py
|   |   |   â”œâ”€â”€ connect.py
|   |   |   â”œâ”€â”€ hdf5.py
|   |   |   â”œâ”€â”€ pandas
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â””â”€â”€ connect.py
|   |   |   â”œâ”€â”€ parquet.py
|   |   |   â”œâ”€â”€ pickle_helpers.py
|   |   |   â”œâ”€â”€ tests
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ test_hdf5.py
|   |   |   |   â”œâ”€â”€ test_pandas.py
|   |   |   |   â”œâ”€â”€ test_parquet.py
|   |   |   |   â”œâ”€â”€ test_pickle_helpers.py
|   |   |   |   â””â”€â”€ test_yaml.py
|   |   |   â””â”€â”€ yaml.py
|   |   â”œâ”€â”€ registry
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ base.py
|   |   |   â”œâ”€â”€ compat.py
|   |   |   â”œâ”€â”€ core.py
|   |   |   â”œâ”€â”€ interface.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â”œâ”€â”€ test_registries.py
|   |   |       â””â”€â”€ test_registry_help.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ mixin_columns.py
|   |   |   â””â”€â”€ safeio.py
|   |   â””â”€â”€ votable
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ connect.py
|   |       â”œâ”€â”€ converters.py
|   |       â”œâ”€â”€ data
|   |       |   â””â”€â”€ ucd1p-words.txt
|   |       â”œâ”€â”€ exceptions.py
|   |       â”œâ”€â”€ setup_package.py
|   |       â”œâ”€â”€ src
|   |       |   â””â”€â”€ tablewriter.c
|   |       â”œâ”€â”€ table.py
|   |       â”œâ”€â”€ tests
|   |       |   â”œâ”€â”€ __init__.py
|   |       |   â”œâ”€â”€ converter_test.py
|   |       |   â”œâ”€â”€ data
|   |       |   â”œâ”€â”€ exception_test.py
|   |       |   â”œâ”€â”€ resource_test.py
|   |       |   â”œâ”€â”€ table_test.py
|   |       |   â”œâ”€â”€ tree_test.py
|   |       |   â”œâ”€â”€ ucd_test.py
|   |       |   â”œâ”€â”€ util_test.py
|   |       |   â””â”€â”€ vo_test.py
|   |       â”œâ”€â”€ tree.py
|   |       â”œâ”€â”€ ucd.py
|   |       â”œâ”€â”€ util.py
|   |       â”œâ”€â”€ validator
|   |       |   â”œâ”€â”€ __init__.py
|   |       |   â”œâ”€â”€ data
|   |       |   â”œâ”€â”€ html.py
|   |       |   â”œâ”€â”€ main.py
|   |       |   â””â”€â”€ result.py
|   |       â”œâ”€â”€ volint.py
|   |       â””â”€â”€ xmlutil.py
|   â”œâ”€â”€ logger.py
|   â”œâ”€â”€ modeling
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ bounding_box.py
|   |   â”œâ”€â”€ convolution.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ fitting.py
|   |   â”œâ”€â”€ functional_models.py
|   |   â”œâ”€â”€ mappings.py
|   |   â”œâ”€â”€ math_functions.py
|   |   â”œâ”€â”€ models.py
|   |   â”œâ”€â”€ optimizers.py
|   |   â”œâ”€â”€ parameters.py
|   |   â”œâ”€â”€ physical_models.py
|   |   â”œâ”€â”€ polynomial.py
|   |   â”œâ”€â”€ powerlaws.py
|   |   â”œâ”€â”€ projections.py
|   |   â”œâ”€â”€ rotations.py
|   |   â”œâ”€â”€ separable.py
|   |   â”œâ”€â”€ spline.py
|   |   â”œâ”€â”€ statistic.py
|   |   â”œâ”€â”€ tabular.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â””â”€â”€ spec.txt
|   |   |   â”œâ”€â”€ example_models.py
|   |   |   â”œâ”€â”€ irafutil.py
|   |   |   â”œâ”€â”€ test_bounding_box.py
|   |   |   â”œâ”€â”€ test_compound.py
|   |   |   â”œâ”€â”€ test_constraints.py
|   |   |   â”œâ”€â”€ test_convolution.py
|   |   |   â”œâ”€â”€ test_core.py
|   |   |   â”œâ”€â”€ test_fitters.py
|   |   |   â”œâ”€â”€ test_functional_models.py
|   |   |   â”œâ”€â”€ test_input.py
|   |   |   â”œâ”€â”€ test_mappings.py
|   |   |   â”œâ”€â”€ test_math_func.py
|   |   |   â”œâ”€â”€ test_model_sets.py
|   |   |   â”œâ”€â”€ test_models.py
|   |   |   â”œâ”€â”€ test_models_quantities.py
|   |   |   â”œâ”€â”€ test_parameters.py
|   |   |   â”œâ”€â”€ test_physical_models.py
|   |   |   â”œâ”€â”€ test_polynomial.py
|   |   |   â”œâ”€â”€ test_projections.py
|   |   |   â”œâ”€â”€ test_quantities_evaluation.py
|   |   |   â”œâ”€â”€ test_quantities_fitting.py
|   |   |   â”œâ”€â”€ test_quantities_model.py
|   |   |   â”œâ”€â”€ test_quantities_parameters.py
|   |   |   â”œâ”€â”€ test_quantities_rotations.py
|   |   |   â”œâ”€â”€ test_rotations.py
|   |   |   â”œâ”€â”€ test_separable.py
|   |   |   â”œâ”€â”€ test_spline.py
|   |   |   â”œâ”€â”€ test_statistics.py
|   |   |   â”œâ”€â”€ test_units_mapping.py
|   |   |   â””â”€â”€ test_utils.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ nddata
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ _testing.py
|   |   â”œâ”€â”€ bitmask.py
|   |   â”œâ”€â”€ blocks.py
|   |   â”œâ”€â”€ ccddata.py
|   |   â”œâ”€â”€ compat.py
|   |   â”œâ”€â”€ decorators.py
|   |   â”œâ”€â”€ flag_collection.py
|   |   â”œâ”€â”€ mixins
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ ndarithmetic.py
|   |   |   â”œâ”€â”€ ndio.py
|   |   |   â”œâ”€â”€ ndslicing.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â”œâ”€â”€ test_ndarithmetic.py
|   |   |       â”œâ”€â”€ test_ndio.py
|   |   |       â””â”€â”€ test_ndslicing.py
|   |   â”œâ”€â”€ nddata.py
|   |   â”œâ”€â”€ nddata_base.py
|   |   â”œâ”€â”€ nddata_withmixins.py
|   |   â”œâ”€â”€ nduncertainty.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ data
|   |   |   â”œâ”€â”€ test_bitmask.py
|   |   |   â”œâ”€â”€ test_blocks.py
|   |   |   â”œâ”€â”€ test_ccddata.py
|   |   |   â”œâ”€â”€ test_compat.py
|   |   |   â”œâ”€â”€ test_decorators.py
|   |   |   â”œâ”€â”€ test_flag_collection.py
|   |   |   â”œâ”€â”€ test_nddata.py
|   |   |   â”œâ”€â”€ test_nddata_base.py
|   |   |   â”œâ”€â”€ test_nduncertainty.py
|   |   |   â””â”€â”€ test_utils.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ samp
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ client.py
|   |   â”œâ”€â”€ constants.py
|   |   â”œâ”€â”€ data
|   |   â”œâ”€â”€ errors.py
|   |   â”œâ”€â”€ hub.py
|   |   â”œâ”€â”€ hub_proxy.py
|   |   â”œâ”€â”€ hub_script.py
|   |   â”œâ”€â”€ integrated_client.py
|   |   â”œâ”€â”€ lockfile_helpers.py
|   |   â”œâ”€â”€ setup_package.py
|   |   â”œâ”€â”€ standard_profile.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ test_client.py
|   |   |   â”œâ”€â”€ test_errors.py
|   |   |   â”œâ”€â”€ test_helpers.py
|   |   |   â”œâ”€â”€ test_hub.py
|   |   |   â”œâ”€â”€ test_hub_proxy.py
|   |   |   â”œâ”€â”€ test_hub_script.py
|   |   |   â”œâ”€â”€ test_standard_profile.py
|   |   |   â”œâ”€â”€ test_web_profile.py
|   |   |   â””â”€â”€ web_profile_test_helpers.py
|   |   â”œâ”€â”€ utils.py
|   |   â””â”€â”€ web_profile.py
|   â”œâ”€â”€ stats
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ bayesian_blocks.py
|   |   â”œâ”€â”€ biweight.py
|   |   â”œâ”€â”€ bls
|   |   |   â””â”€â”€ __init__.py
|   |   â”œâ”€â”€ circstats.py
|   |   â”œâ”€â”€ funcs.py
|   |   â”œâ”€â”€ histogram.py
|   |   â”œâ”€â”€ info_theory.py
|   |   â”œâ”€â”€ jackknife.py
|   |   â”œâ”€â”€ lombscargle
|   |   |   â””â”€â”€ __init__.py
|   |   â”œâ”€â”€ setup_package.py
|   |   â”œâ”€â”€ sigma_clipping.py
|   |   â”œâ”€â”€ spatial.py
|   |   â”œâ”€â”€ src
|   |   |   â”œâ”€â”€ compute_bounds.c
|   |   |   â”œâ”€â”€ fast_sigma_clip.c
|   |   |   â””â”€â”€ wirth_select.c
|   |   â””â”€â”€ tests
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ test_bayesian_blocks.py
|   |       â”œâ”€â”€ test_biweight.py
|   |       â”œâ”€â”€ test_circstats.py
|   |       â”œâ”€â”€ test_funcs.py
|   |       â”œâ”€â”€ test_histogram.py
|   |       â”œâ”€â”€ test_info_theory.py
|   |       â”œâ”€â”€ test_jackknife.py
|   |       â”œâ”€â”€ test_sigma_clipping.py
|   |       â””â”€â”€ test_spatial.py
|   â”œâ”€â”€ table
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ bst.py
|   |   â”œâ”€â”€ column.py
|   |   â”œâ”€â”€ connect.py
|   |   â”œâ”€â”€ groups.py
|   |   â”œâ”€â”€ index.py
|   |   â”œâ”€â”€ info.py
|   |   â”œâ”€â”€ jsviewer.py
|   |   â”œâ”€â”€ meta.py
|   |   â”œâ”€â”€ mixins
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ dask.py
|   |   |   â”œâ”€â”€ registry.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â”œâ”€â”€ test_dask.py
|   |   |       â””â”€â”€ test_registry.py
|   |   â”œâ”€â”€ ndarray_mixin.py
|   |   â”œâ”€â”€ np_utils.py
|   |   â”œâ”€â”€ operations.py
|   |   â”œâ”€â”€ pandas.py
|   |   â”œâ”€â”€ pprint.py
|   |   â”œâ”€â”€ row.py
|   |   â”œâ”€â”€ scripts
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â””â”€â”€ showtable.py
|   |   â”œâ”€â”€ serialize.py
|   |   â”œâ”€â”€ setup_package.py
|   |   â”œâ”€â”€ soco.py
|   |   â”œâ”€â”€ sorted_array.py
|   |   â”œâ”€â”€ table.py
|   |   â”œâ”€â”€ table_helpers.py
|   |   â””â”€â”€ tests
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ conftest.py
|   |       â”œâ”€â”€ test_array.py
|   |       â”œâ”€â”€ test_bst.py
|   |       â”œâ”€â”€ test_column.py
|   |       â”œâ”€â”€ test_groups.py
|   |       â”œâ”€â”€ test_index.py
|   |       â”œâ”€â”€ test_info.py
|   |       â”œâ”€â”€ test_init_table.py
|   |       â”œâ”€â”€ test_item_access.py
|   |       â”œâ”€â”€ test_jsviewer.py
|   |       â”œâ”€â”€ test_masked.py
|   |       â”œâ”€â”€ test_mixin.py
|   |       â”œâ”€â”€ test_np_utils.py
|   |       â”œâ”€â”€ test_operations.py
|   |       â”œâ”€â”€ test_pickle.py
|   |       â”œâ”€â”€ test_pprint.py
|   |       â”œâ”€â”€ test_row.py
|   |       â”œâ”€â”€ test_showtable.py
|   |       â”œâ”€â”€ test_subclass.py
|   |       â””â”€â”€ test_table.py
|   â”œâ”€â”€ tests
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ command.py
|   |   â”œâ”€â”€ helper.py
|   |   â”œâ”€â”€ image_tests.py
|   |   â”œâ”€â”€ runner.py
|   |   â”œâ”€â”€ test_logger.py
|   |   â””â”€â”€ tests
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ test_imports.py
|   |       â”œâ”€â”€ test_quantity_helpers.py
|   |       â”œâ”€â”€ test_run_tests.py
|   |       â””â”€â”€ test_runner.py
|   â”œâ”€â”€ time
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ formats.py
|   |   â”œâ”€â”€ setup_package.py
|   |   â”œâ”€â”€ src
|   |   |   â””â”€â”€ parse_times.c
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ test_basic.py
|   |   |   â”œâ”€â”€ test_comparisons.py
|   |   |   â”œâ”€â”€ test_corrs.py
|   |   |   â”œâ”€â”€ test_custom_formats.py
|   |   |   â”œâ”€â”€ test_delta.py
|   |   |   â”œâ”€â”€ test_fast_parser.py
|   |   |   â”œâ”€â”€ test_functions.py
|   |   |   â”œâ”€â”€ test_guess.py
|   |   |   â”œâ”€â”€ test_mask.py
|   |   |   â”œâ”€â”€ test_methods.py
|   |   |   â”œâ”€â”€ test_pickle.py
|   |   |   â”œâ”€â”€ test_precision.py
|   |   |   â”œâ”€â”€ test_quantity_interaction.py
|   |   |   â”œâ”€â”€ test_sidereal.py
|   |   |   â”œâ”€â”€ test_update_leap_seconds.py
|   |   |   â””â”€â”€ test_ut1.py
|   |   â”œâ”€â”€ time_helper
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â””â”€â”€ function_helpers.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ timeseries
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ binned.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ downsample.py
|   |   â”œâ”€â”€ io
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ kepler.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â””â”€â”€ test_kepler.py
|   |   â”œâ”€â”€ periodograms
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ base.py
|   |   |   â”œâ”€â”€ bls
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ core.py
|   |   |   |   â”œâ”€â”€ methods.py
|   |   |   |   â”œâ”€â”€ setup_package.py
|   |   |   |   â””â”€â”€ tests
|   |   |   â””â”€â”€ lombscargle
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â”œâ”€â”€ _statistics.py
|   |   |       â”œâ”€â”€ core.py
|   |   |       â”œâ”€â”€ implementations
|   |   |       â”œâ”€â”€ tests
|   |   |       â””â”€â”€ utils.py
|   |   â”œâ”€â”€ sampled.py
|   |   â””â”€â”€ tests
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ data
|   |       â”œâ”€â”€ test_binned.py
|   |       â”œâ”€â”€ test_common.py
|   |       â”œâ”€â”€ test_downsample.py
|   |       â””â”€â”€ test_sampled.py
|   â”œâ”€â”€ uncertainty
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ distributions.py
|   |   â””â”€â”€ tests
|   |       â”œâ”€â”€ __init__.py
|   |       â””â”€â”€ test_distribution.py
|   â”œâ”€â”€ units
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ _typing.py
|   |   â”œâ”€â”€ astrophys.py
|   |   â”œâ”€â”€ cds.py
|   |   â”œâ”€â”€ cgs.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ decorators.py
|   |   â”œâ”€â”€ deprecated.py
|   |   â”œâ”€â”€ equivalencies.py
|   |   â”œâ”€â”€ format
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ base.py
|   |   |   â”œâ”€â”€ cds.py
|   |   |   â”œâ”€â”€ cds_lextab.py
|   |   |   â”œâ”€â”€ cds_parsetab.py
|   |   |   â”œâ”€â”€ console.py
|   |   |   â”œâ”€â”€ fits.py
|   |   |   â”œâ”€â”€ generic.py
|   |   |   â”œâ”€â”€ generic_lextab.py
|   |   |   â”œâ”€â”€ generic_parsetab.py
|   |   |   â”œâ”€â”€ latex.py
|   |   |   â”œâ”€â”€ ogip.py
|   |   |   â”œâ”€â”€ ogip_lextab.py
|   |   |   â”œâ”€â”€ ogip_parsetab.py
|   |   |   â”œâ”€â”€ unicode_format.py
|   |   |   â”œâ”€â”€ utils.py
|   |   |   â””â”€â”€ vounit.py
|   |   â”œâ”€â”€ function
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ core.py
|   |   |   â”œâ”€â”€ logarithmic.py
|   |   |   â”œâ”€â”€ mixin.py
|   |   |   â””â”€â”€ units.py
|   |   â”œâ”€â”€ imperial.py
|   |   â”œâ”€â”€ misc.py
|   |   â”œâ”€â”€ photometric.py
|   |   â”œâ”€â”€ physical.py
|   |   â”œâ”€â”€ quantity.py
|   |   â”œâ”€â”€ quantity_helper
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ converters.py
|   |   |   â”œâ”€â”€ erfa.py
|   |   |   â”œâ”€â”€ function_helpers.py
|   |   |   â”œâ”€â”€ helpers.py
|   |   |   â””â”€â”€ scipy_special.py
|   |   â”œâ”€â”€ required_by_vounit.py
|   |   â”œâ”€â”€ si.py
|   |   â”œâ”€â”€ structured.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ test_aliases.py
|   |   |   â”œâ”€â”€ test_deprecated.py
|   |   |   â”œâ”€â”€ test_equivalencies.py
|   |   |   â”œâ”€â”€ test_format.py
|   |   |   â”œâ”€â”€ test_logarithmic.py
|   |   |   â”œâ”€â”€ test_photometric.py
|   |   |   â”œâ”€â”€ test_physical.py
|   |   |   â”œâ”€â”€ test_quantity.py
|   |   |   â”œâ”€â”€ test_quantity_annotations.py
|   |   |   â”œâ”€â”€ test_quantity_array_methods.py
|   |   |   â”œâ”€â”€ test_quantity_decorator.py
|   |   |   â”œâ”€â”€ test_quantity_helpers.py
|   |   |   â”œâ”€â”€ test_quantity_non_ufuncs.py
|   |   |   â”œâ”€â”€ test_quantity_typing.py
|   |   |   â”œâ”€â”€ test_quantity_ufuncs.py
|   |   |   â”œâ”€â”€ test_structured.py
|   |   |   â”œâ”€â”€ test_structured_erfa_ufuncs.py
|   |   |   â”œâ”€â”€ test_units.py
|   |   |   â””â”€â”€ test_utils.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ utils
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ argparse.py
|   |   â”œâ”€â”€ codegen.py
|   |   â”œâ”€â”€ collections.py
|   |   â”œâ”€â”€ compat
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ misc.py
|   |   |   â”œâ”€â”€ numpycompat.py
|   |   |   â””â”€â”€ optional_deps.py
|   |   â”œâ”€â”€ console.py
|   |   â”œâ”€â”€ data.py
|   |   â”œâ”€â”€ data_info.py
|   |   â”œâ”€â”€ decorators.py
|   |   â”œâ”€â”€ diff.py
|   |   â”œâ”€â”€ exceptions.py
|   |   â”œâ”€â”€ iers
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ data
|   |   |   |   â””â”€â”€ update_builtin_iers.sh
|   |   |   â”œâ”€â”€ iers.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â”œâ”€â”€ data
|   |   |       â”œâ”€â”€ test_iers.py
|   |   |       â””â”€â”€ test_leap_second.py
|   |   â”œâ”€â”€ introspection.py
|   |   â”œâ”€â”€ masked
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ core.py
|   |   |   â”œâ”€â”€ function_helpers.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â”œâ”€â”€ test_containers.py
|   |   |       â”œâ”€â”€ test_function_helpers.py
|   |   |       â”œâ”€â”€ test_functions.py
|   |   |       â”œâ”€â”€ test_masked.py
|   |   |       â””â”€â”€ test_table.py
|   |   â”œâ”€â”€ metadata.py
|   |   â”œâ”€â”€ misc.py
|   |   â”œâ”€â”€ parsing.py
|   |   â”œâ”€â”€ setup_package.py
|   |   â”œâ”€â”€ shapes.py
|   |   â”œâ”€â”€ src
|   |   |   â””â”€â”€ compiler.c
|   |   â”œâ”€â”€ state.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ .hidden_file.txt
|   |   |   |   â”œâ”€â”€ dataurl
|   |   |   |   â”œâ”€â”€ dataurl_mirror
|   |   |   |   â”œâ”€â”€ test_package
|   |   |   |   â””â”€â”€ unicode.txt
|   |   |   â”œâ”€â”€ test_codegen.py
|   |   |   â”œâ”€â”€ test_collections.py
|   |   |   â”œâ”€â”€ test_console.py
|   |   |   â”œâ”€â”€ test_data.py
|   |   |   â”œâ”€â”€ test_data_info.py
|   |   |   â”œâ”€â”€ test_decorators.py
|   |   |   â”œâ”€â”€ test_diff.py
|   |   |   â”œâ”€â”€ test_introspection.py
|   |   |   â”œâ”€â”€ test_metadata.py
|   |   |   â”œâ”€â”€ test_misc.py
|   |   |   â”œâ”€â”€ test_parsing.py
|   |   |   â”œâ”€â”€ test_progress_bar_func.py
|   |   |   â”œâ”€â”€ test_shapes.py
|   |   |   â”œâ”€â”€ test_state.py
|   |   |   â””â”€â”€ test_xml.py
|   |   â””â”€â”€ xml
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ check.py
|   |       â”œâ”€â”€ iterparser.py
|   |       â”œâ”€â”€ setup_package.py
|   |       â”œâ”€â”€ src
|   |       |   â””â”€â”€ iterparse.c
|   |       â”œâ”€â”€ tests
|   |       |   â”œâ”€â”€ __init__.py
|   |       |   â””â”€â”€ test_iterparse.py
|   |       â”œâ”€â”€ unescaper.py
|   |       â”œâ”€â”€ validate.py
|   |       â””â”€â”€ writer.py
|   â”œâ”€â”€ version.py
|   â”œâ”€â”€ visualization
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ hist.py
|   |   â”œâ”€â”€ interval.py
|   |   â”œâ”€â”€ lupton_rgb.py
|   |   â”œâ”€â”€ mpl_normalize.py
|   |   â”œâ”€â”€ mpl_style.py
|   |   â”œâ”€â”€ scripts
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ fits2bitmap.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â””â”€â”€ test_fits2bitmap.py
|   |   â”œâ”€â”€ stretch.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ test_histogram.py
|   |   |   â”œâ”€â”€ test_interval.py
|   |   |   â”œâ”€â”€ test_lupton_rgb.py
|   |   |   â”œâ”€â”€ test_norm.py
|   |   |   â”œâ”€â”€ test_stretch.py
|   |   |   â”œâ”€â”€ test_time.py
|   |   |   â””â”€â”€ test_units.py
|   |   â”œâ”€â”€ time.py
|   |   â”œâ”€â”€ transform.py
|   |   â”œâ”€â”€ units.py
|   |   â””â”€â”€ wcsaxes
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ axislabels.py
|   |       â”œâ”€â”€ coordinate_helpers.py
|   |       â”œâ”€â”€ coordinate_range.py
|   |       â”œâ”€â”€ coordinates_map.py
|   |       â”œâ”€â”€ core.py
|   |       â”œâ”€â”€ formatter_locator.py
|   |       â”œâ”€â”€ frame.py
|   |       â”œâ”€â”€ grid_paths.py
|   |       â”œâ”€â”€ patches.py
|   |       â”œâ”€â”€ tests
|   |       |   â”œâ”€â”€ __init__.py
|   |       |   â”œâ”€â”€ data
|   |       |   â”œâ”€â”€ test_coordinate_helpers.py
|   |       |   â”œâ”€â”€ test_display_world_coordinates.py
|   |       |   â”œâ”€â”€ test_formatter_locator.py
|   |       |   â”œâ”€â”€ test_frame.py
|   |       |   â”œâ”€â”€ test_grid_paths.py
|   |       |   â”œâ”€â”€ test_images.py
|   |       |   â”œâ”€â”€ test_misc.py
|   |       |   â”œâ”€â”€ test_transform_coord_meta.py
|   |       |   â”œâ”€â”€ test_transforms.py
|   |       |   â”œâ”€â”€ test_utils.py
|   |       |   â””â”€â”€ test_wcsapi.py
|   |       â”œâ”€â”€ ticklabels.py
|   |       â”œâ”€â”€ ticks.py
|   |       â”œâ”€â”€ transforms.py
|   |       â”œâ”€â”€ utils.py
|   |       â””â”€â”€ wcsapi.py
|   â””â”€â”€ wcs
|       â”œâ”€â”€ __init__.py
|       â”œâ”€â”€ docstrings.py
|       â”œâ”€â”€ include
|       |   â”œâ”€â”€ astropy_wcs
|       |   â””â”€â”€ wcslib
|       â”œâ”€â”€ setup_package.py
|       â”œâ”€â”€ src
|       |   â”œâ”€â”€ astropy_wcs.c
|       |   â”œâ”€â”€ astropy_wcs_api.c
|       |   â”œâ”€â”€ distortion.c
|       |   â”œâ”€â”€ distortion_wrap.c
|       |   â”œâ”€â”€ pipeline.c
|       |   â”œâ”€â”€ pyutil.c
|       |   â”œâ”€â”€ sip.c
|       |   â”œâ”€â”€ sip_wrap.c
|       |   â”œâ”€â”€ str_list_proxy.c
|       |   â”œâ”€â”€ unit_list_proxy.c
|       |   â”œâ”€â”€ util.c
|       |   â”œâ”€â”€ wcslib_auxprm_wrap.c
|       |   â”œâ”€â”€ wcslib_celprm_wrap.c
|       |   â”œâ”€â”€ wcslib_prjprm_wrap.c
|       |   â”œâ”€â”€ wcslib_tabprm_wrap.c
|       |   â”œâ”€â”€ wcslib_wrap.c
|       |   â””â”€â”€ wcslib_wtbarr_wrap.c
|       â”œâ”€â”€ tests
|       |   â”œâ”€â”€ __init__.py
|       |   â”œâ”€â”€ conftest.py
|       |   â”œâ”€â”€ data
|       |   |   â”œâ”€â”€ maps
|       |   |   â”œâ”€â”€ spectra
|       |   |   â”œâ”€â”€ validate.5.0.txt
|       |   |   â”œâ”€â”€ validate.5.13.txt
|       |   |   â”œâ”€â”€ validate.6.txt
|       |   |   â”œâ”€â”€ validate.7.4.txt
|       |   |   â”œâ”€â”€ validate.7.6.txt
|       |   |   â””â”€â”€ validate.txt
|       |   â”œâ”€â”€ helper.py
|       |   â”œâ”€â”€ test_auxprm.py
|       |   â”œâ”€â”€ test_celprm.py
|       |   â”œâ”€â”€ test_pickle.py
|       |   â”œâ”€â”€ test_prjprm.py
|       |   â”œâ”€â”€ test_profiling.py
|       |   â”œâ”€â”€ test_tab.py
|       |   â”œâ”€â”€ test_tabprm.py
|       |   â”œâ”€â”€ test_utils.py
|       |   â”œâ”€â”€ test_wcs.py
|       |   â”œâ”€â”€ test_wcsprm.py
|       |   â””â”€â”€ test_wtbarr.py
|       â”œâ”€â”€ utils.py
|       â”œâ”€â”€ wcs.py
|       â”œâ”€â”€ wcsapi
|       |   â”œâ”€â”€ __init__.py
|       |   â”œâ”€â”€ conftest.py
|       |   â”œâ”€â”€ data
|       |   |   â””â”€â”€ ucds.txt
|       |   â”œâ”€â”€ fitswcs.py
|       |   â”œâ”€â”€ high_level_api.py
|       |   â”œâ”€â”€ high_level_wcs_wrapper.py
|       |   â”œâ”€â”€ low_level_api.py
|       |   â”œâ”€â”€ sliced_low_level_wcs.py
|       |   â”œâ”€â”€ tests
|       |   |   â”œâ”€â”€ __init__.py
|       |   |   â”œâ”€â”€ test_fitswcs.py
|       |   |   â”œâ”€â”€ test_high_level_api.py
|       |   |   â”œâ”€â”€ test_high_level_wcs_wrapper.py
|       |   |   â”œâ”€â”€ test_low_level_api.py
|       |   |   â””â”€â”€ test_utils.py
|       |   â”œâ”€â”€ utils.py
|       |   â””â”€â”€ wrappers
|       |       â”œâ”€â”€ __init__.py
|       |       â”œâ”€â”€ base.py
|       |       â”œâ”€â”€ sliced_wcs.py
|       |       â””â”€â”€ tests
|       â””â”€â”€ wcslint.py
â”œâ”€â”€ azure-pipelines.yml
â”œâ”€â”€ cextern
|   â”œâ”€â”€ README.rst
|   â”œâ”€â”€ cfitsio
|   |   â”œâ”€â”€ License.txt
|   |   â”œâ”€â”€ README.txt
|   |   â”œâ”€â”€ docs
|   |   |   â””â”€â”€ changes.txt
|   |   â”œâ”€â”€ lib
|   |   |   â”œâ”€â”€ buffers.c
|   |   |   â”œâ”€â”€ cfileio.c
|   |   |   â”œâ”€â”€ checksum.c
|   |   |   â”œâ”€â”€ drvrfile.c
|   |   |   â”œâ”€â”€ drvrmem.c
|   |   |   â”œâ”€â”€ drvrnet.c
|   |   |   â”œâ”€â”€ drvrsmem.c
|   |   |   â”œâ”€â”€ editcol.c
|   |   |   â”œâ”€â”€ edithdu.c
|   |   |   â”œâ”€â”€ eval_f.c
|   |   |   â”œâ”€â”€ eval_l.c
|   |   |   â”œâ”€â”€ eval_y.c
|   |   |   â”œâ”€â”€ fits_hcompress.c
|   |   |   â”œâ”€â”€ fits_hdecompress.c
|   |   |   â”œâ”€â”€ fitscore.c
|   |   |   â”œâ”€â”€ getcol.c
|   |   |   â”œâ”€â”€ getcolb.c
|   |   |   â”œâ”€â”€ getcold.c
|   |   |   â”œâ”€â”€ getcole.c
|   |   |   â”œâ”€â”€ getcoli.c
|   |   |   â”œâ”€â”€ getcolj.c
|   |   |   â”œâ”€â”€ getcolk.c
|   |   |   â”œâ”€â”€ getcoll.c
|   |   |   â”œâ”€â”€ getcols.c
|   |   |   â”œâ”€â”€ getcolsb.c
|   |   |   â”œâ”€â”€ getcolui.c
|   |   |   â”œâ”€â”€ getcoluj.c
|   |   |   â”œâ”€â”€ getcoluk.c
|   |   |   â”œâ”€â”€ getkey.c
|   |   |   â”œâ”€â”€ group.c
|   |   |   â”œâ”€â”€ grparser.c
|   |   |   â”œâ”€â”€ histo.c
|   |   |   â”œâ”€â”€ imcompress.c
|   |   |   â”œâ”€â”€ iraffits.c
|   |   |   â”œâ”€â”€ modkey.c
|   |   |   â”œâ”€â”€ pliocomp.c
|   |   |   â”œâ”€â”€ putcol.c
|   |   |   â”œâ”€â”€ putcolb.c
|   |   |   â”œâ”€â”€ putcold.c
|   |   |   â”œâ”€â”€ putcole.c
|   |   |   â”œâ”€â”€ putcoli.c
|   |   |   â”œâ”€â”€ putcolj.c
|   |   |   â”œâ”€â”€ putcolk.c
|   |   |   â”œâ”€â”€ putcoll.c
|   |   |   â”œâ”€â”€ putcols.c
|   |   |   â”œâ”€â”€ putcolsb.c
|   |   |   â”œâ”€â”€ putcolu.c
|   |   |   â”œâ”€â”€ putcolui.c
|   |   |   â”œâ”€â”€ putcoluj.c
|   |   |   â”œâ”€â”€ putcoluk.c
|   |   |   â”œâ”€â”€ putkey.c
|   |   |   â”œâ”€â”€ quantize.c
|   |   |   â”œâ”€â”€ region.c
|   |   |   â”œâ”€â”€ ricecomp.c
|   |   |   â”œâ”€â”€ scalnull.c
|   |   |   â”œâ”€â”€ simplerng.c
|   |   |   â”œâ”€â”€ swapproc.c
|   |   |   â”œâ”€â”€ wcssub.c
|   |   |   â”œâ”€â”€ wcsutil.c
|   |   |   â”œâ”€â”€ zcompress.c
|   |   |   â””â”€â”€ zuncompress.c
|   |   â””â”€â”€ zlib
|   |       â”œâ”€â”€ adler32.c
|   |       â”œâ”€â”€ crc32.c
|   |       â”œâ”€â”€ deflate.c
|   |       â”œâ”€â”€ infback.c
|   |       â”œâ”€â”€ inffast.c
|   |       â”œâ”€â”€ inflate.c
|   |       â”œâ”€â”€ inftrees.c
|   |       â”œâ”€â”€ trees.c
|   |       â”œâ”€â”€ uncompr.c
|   |       â””â”€â”€ zutil.c
|   â”œâ”€â”€ expat
|   |   â”œâ”€â”€ README.md
|   |   â”œâ”€â”€ README.txt
|   |   â””â”€â”€ lib
|   |       â”œâ”€â”€ xmlparse.c
|   |       â”œâ”€â”€ xmlrole.c
|   |       â”œâ”€â”€ xmltok.c
|   |       â”œâ”€â”€ xmltok_impl.c
|   |       â””â”€â”€ xmltok_ns.c
|   â”œâ”€â”€ trim_cfitsio.sh
|   â”œâ”€â”€ trim_expat.sh
|   â”œâ”€â”€ trim_wcslib.sh
|   â””â”€â”€ wcslib
|       â”œâ”€â”€ C
|       |   â”œâ”€â”€ cel.c
|       |   â”œâ”€â”€ dis.c
|       |   â”œâ”€â”€ flexed
|       |   |   â”œâ”€â”€ fitshdr.c
|       |   |   â”œâ”€â”€ wcsbth.c
|       |   |   â”œâ”€â”€ wcspih.c
|       |   |   â”œâ”€â”€ wcsulex.c
|       |   |   â””â”€â”€ wcsutrn.c
|       |   â”œâ”€â”€ getwcstab.c
|       |   â”œâ”€â”€ lin.c
|       |   â”œâ”€â”€ log.c
|       |   â”œâ”€â”€ prj.c
|       |   â”œâ”€â”€ spc.c
|       |   â”œâ”€â”€ sph.c
|       |   â”œâ”€â”€ spx.c
|       |   â”œâ”€â”€ tab.c
|       |   â”œâ”€â”€ wcs.c
|       |   â”œâ”€â”€ wcserr.c
|       |   â”œâ”€â”€ wcsfix.c
|       |   â”œâ”€â”€ wcshdr.c
|       |   â”œâ”€â”€ wcsprintf.c
|       |   â”œâ”€â”€ wcstrig.c
|       |   â”œâ”€â”€ wcsunits.c
|       |   â””â”€â”€ wcsutil.c
|       â””â”€â”€ config
â”œâ”€â”€ codecov.yml
â”œâ”€â”€ conftest.py
â”œâ”€â”€ docs
|   â”œâ”€â”€ _pkgtemplate.rst
|   â”œâ”€â”€ _static
|   â”œâ”€â”€ _templates
|   â”œâ”€â”€ changelog.rst
|   â”œâ”€â”€ changes
|   |   â”œâ”€â”€ README.rst
|   |   â”œâ”€â”€ config
|   |   â”œâ”€â”€ constants
|   |   â”œâ”€â”€ convolution
|   |   â”œâ”€â”€ coordinates
|   |   |   â”œâ”€â”€ 12541.feature.rst
|   |   |   â”œâ”€â”€ 12721.bugfix.rst
|   |   |   â”œâ”€â”€ 13056.feature.rst
|   |   |   â””â”€â”€ 13162.api.rst
|   |   â”œâ”€â”€ cosmology
|   |   |   â”œâ”€â”€ 12279.feature.rst
|   |   |   â”œâ”€â”€ 12313.feature.rst
|   |   |   â”œâ”€â”€ 12354.api.rst
|   |   |   â”œâ”€â”€ 12375.api.rst
|   |   |   â”œâ”€â”€ 12479.feature.rst
|   |   |   â”œâ”€â”€ 12590.feature.rst
|   |   |   â”œâ”€â”€ 12606.feature.rst
|   |   |   â”œâ”€â”€ 12612.api.rst
|   |   |   â”œâ”€â”€ 12624.api.rst
|   |   |   â”œâ”€â”€ 12710.feature.rst
|   |   |   â”œâ”€â”€ 12736.feature.rst
|   |   |   â”œâ”€â”€ 12740.feature.rst
|   |   |   â”œâ”€â”€ 12746.api.rst
|   |   |   â”œâ”€â”€ 12966.feature.rst
|   |   |   â”œâ”€â”€ 13072.api.rst
|   |   |   â”œâ”€â”€ 13076.feature.rst
|   |   |   â”œâ”€â”€ 13099.feature.rst
|   |   |   â””â”€â”€ 13129.feature.rst
|   |   â”œâ”€â”€ extern
|   |   â”œâ”€â”€ io.ascii
|   |   |   â”œâ”€â”€ 12631.bugfix.rst
|   |   |   â”œâ”€â”€ 12841.api.rst
|   |   |   â”œâ”€â”€ 12842.bugfix.rst
|   |   |   â”œâ”€â”€ 13073.feature.rst
|   |   |   â””â”€â”€ 13130.feature.rst
|   |   â”œâ”€â”€ io.fits
|   |   |   â”œâ”€â”€ 11843.feature.rst
|   |   |   â”œâ”€â”€ 12081.feature.rst
|   |   |   â”œâ”€â”€ 12110.feature.rst
|   |   |   â”œâ”€â”€ 12258.api.rst
|   |   |   â”œâ”€â”€ 12544.bugfix.rst
|   |   |   â”œâ”€â”€ 13102.bugfix.rst
|   |   |   â””â”€â”€ 13106.api.rst
|   |   â”œâ”€â”€ io.misc
|   |   |   â”œâ”€â”€ 10198.feature.rst
|   |   |   â”œâ”€â”€ 12279.feature.rst
|   |   |   â”œâ”€â”€ 12895.feature.rst
|   |   |   â”œâ”€â”€ 12897.feature.rst
|   |   |   â”œâ”€â”€ 12903.api.rst
|   |   |   â””â”€â”€ 12930.api.rst
|   |   â”œâ”€â”€ io.registry
|   |   |   â””â”€â”€ 13129.feature.rst
|   |   â”œâ”€â”€ io.votable
|   |   â”œâ”€â”€ modeling
|   |   |   â”œâ”€â”€ 12051.feature.rst
|   |   |   â”œâ”€â”€ 12384.feature.rst
|   |   |   â”œâ”€â”€ 12558.feature.rst
|   |   |   â”œâ”€â”€ 12585.api.rst
|   |   |   â”œâ”€â”€ 12811.feature.rst
|   |   |   â”œâ”€â”€ 13030.feature.rst
|   |   |   â”œâ”€â”€ 13032.bugfix.rst
|   |   |   â””â”€â”€ 13116.feature.rst
|   |   â”œâ”€â”€ nddata
|   |   |   â”œâ”€â”€ 12057.feature.rst
|   |   |   â”œâ”€â”€ 12962.feature.rst
|   |   |   â””â”€â”€ 13129.feature.rst
|   |   â”œâ”€â”€ samp
|   |   â”œâ”€â”€ stats
|   |   â”œâ”€â”€ table
|   |   |   â”œâ”€â”€ 12631.api.rst
|   |   |   â”œâ”€â”€ 12637.api.rst
|   |   |   â”œâ”€â”€ 12637.feature.rst
|   |   |   â”œâ”€â”€ 12644.feature.rst
|   |   |   â”œâ”€â”€ 12680.feature.rst
|   |   |   â”œâ”€â”€ 12716.bugfix.rst
|   |   |   â”œâ”€â”€ 12825.feature.rst
|   |   |   â”œâ”€â”€ 12842.bugfix.rst
|   |   |   â”œâ”€â”€ 13129.feature.rst
|   |   |   â””â”€â”€ 13233.bugfix.rst
|   |   â”œâ”€â”€ template.rst
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ 12633.api.1.rst
|   |   |   â”œâ”€â”€ 12633.api.2.rst
|   |   |   â”œâ”€â”€ 12633.api.3.rst
|   |   |   â””â”€â”€ 12633.api.4.rst
|   |   â”œâ”€â”€ time
|   |   |   â”œâ”€â”€ 12842.bugfix.rst
|   |   |   â”œâ”€â”€ 12888.api.rst
|   |   |   â””â”€â”€ 13132.feature.rst
|   |   â”œâ”€â”€ timeseries
|   |   â”œâ”€â”€ uncertainty
|   |   â”œâ”€â”€ units
|   |   |   â”œâ”€â”€ 12486.feature.rst
|   |   |   â”œâ”€â”€ 12566.feature.rst
|   |   |   â”œâ”€â”€ 12709.feature.rst
|   |   |   â”œâ”€â”€ 12891.feature.rst
|   |   |   â”œâ”€â”€ 12975.feature.rst
|   |   |   â””â”€â”€ 13056.feature.rst
|   |   â”œâ”€â”€ utils
|   |   |   â”œâ”€â”€ 12891.feature.rst
|   |   |   â”œâ”€â”€ 12978.bugfix.rst
|   |   |   â”œâ”€â”€ 13052.feature.rst
|   |   |   â””â”€â”€ 13066.bugfix.rst
|   |   â”œâ”€â”€ visualization
|   |   â””â”€â”€ wcs
|   |       â”œâ”€â”€ 11693.bugfix.rst
|   |       â”œâ”€â”€ 12514.feature.rst
|   |       â”œâ”€â”€ 13062.bugfix.rst
|   |       â”œâ”€â”€ 13063.bugfix.rst
|   |       â”œâ”€â”€ 13094.feature.rst
|   |       â”œâ”€â”€ 13171.bugfix.rst
|   |       â””â”€â”€ 13228.bugfix.rst
|   â”œâ”€â”€ common_links.txt
|   â”œâ”€â”€ conf.py
|   â”œâ”€â”€ config
|   |   â”œâ”€â”€ astropy_config.rst
|   |   â””â”€â”€ index.rst
|   â”œâ”€â”€ conftest.py
|   â”œâ”€â”€ constants
|   |   â”œâ”€â”€ index.rst
|   |   â””â”€â”€ performance.inc.rst
|   â”œâ”€â”€ convolution
|   |   â”œâ”€â”€ images
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ kernels.rst
|   |   â”œâ”€â”€ non_normalized_kernels.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â””â”€â”€ using.rst
|   â”œâ”€â”€ coordinates
|   |   â”œâ”€â”€ angles.rst
|   |   â”œâ”€â”€ apply_space_motion.rst
|   |   â”œâ”€â”€ common_errors.rst
|   |   â”œâ”€â”€ definitions.rst
|   |   â”œâ”€â”€ formatting.rst
|   |   â”œâ”€â”€ frames.rst
|   |   â”œâ”€â”€ galactocentric.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ inplace.rst
|   |   â”œâ”€â”€ matchsep.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â”œâ”€â”€ remote_methods.rst
|   |   â”œâ”€â”€ representations.rst
|   |   â”œâ”€â”€ satellites.rst
|   |   â”œâ”€â”€ skycoord.rst
|   |   â”œâ”€â”€ solarsystem.rst
|   |   â”œâ”€â”€ spectralcoord.rst
|   |   â”œâ”€â”€ transforming.rst
|   |   â””â”€â”€ velocities.rst
|   â”œâ”€â”€ cosmology
|   |   â”œâ”€â”€ dev.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ io.rst
|   |   â””â”€â”€ units.rst
|   â”œâ”€â”€ credits.rst
|   â”œâ”€â”€ development
|   |   â”œâ”€â”€ astropy-package-template.rst
|   |   â”œâ”€â”€ building.rst
|   |   â”œâ”€â”€ ccython.rst
|   |   â”œâ”€â”€ codeguide.rst
|   |   â”œâ”€â”€ codeguide_emacs.rst
|   |   â”œâ”€â”€ docguide.rst
|   |   â”œâ”€â”€ docrules.rst
|   |   â”œâ”€â”€ releasing.rst
|   |   â”œâ”€â”€ scripts.rst
|   |   â”œâ”€â”€ style-guide.rst
|   |   â”œâ”€â”€ testguide.rst
|   |   â”œâ”€â”€ vision.rst
|   |   â”œâ”€â”€ when_to_rebase.rst
|   |   â””â”€â”€ workflow
|   |       â”œâ”€â”€ additional_git_topics.rst
|   |       â”œâ”€â”€ development_workflow.rst
|   |       â”œâ”€â”€ get_devel_version.rst
|   |       â”œâ”€â”€ git_edit_workflow_examples.rst
|   |       â”œâ”€â”€ git_install.rst
|   |       â”œâ”€â”€ git_resources.rst
|   |       â”œâ”€â”€ maintainer_workflow.rst
|   |       â”œâ”€â”€ patches.rst
|   |       â””â”€â”€ virtual_pythons.rst
|   â”œâ”€â”€ getting_started.rst
|   â”œâ”€â”€ glossary.rst
|   â”œâ”€â”€ importing_astropy.rst
|   â”œâ”€â”€ index.rst
|   â”œâ”€â”€ install.rst
|   â”œâ”€â”€ io
|   |   â”œâ”€â”€ ascii
|   |   |   â”œâ”€â”€ base_classes.rst
|   |   |   â”œâ”€â”€ ecsv.rst
|   |   |   â”œâ”€â”€ extension_classes.rst
|   |   |   â”œâ”€â”€ fast_ascii_io.rst
|   |   |   â”œâ”€â”€ fixed_width_gallery.rst
|   |   |   â”œâ”€â”€ index.rst
|   |   |   â”œâ”€â”€ performance.inc.rst
|   |   |   â”œâ”€â”€ read.rst
|   |   |   â”œâ”€â”€ references.txt
|   |   |   â”œâ”€â”€ toc.txt
|   |   |   â””â”€â”€ write.rst
|   |   â”œâ”€â”€ asdf-schemas.rst
|   |   â”œâ”€â”€ fits
|   |   |   â”œâ”€â”€ api
|   |   |   |   â”œâ”€â”€ cards.rst
|   |   |   |   â”œâ”€â”€ diff.rst
|   |   |   |   â”œâ”€â”€ files.rst
|   |   |   |   â”œâ”€â”€ hdulists.rst
|   |   |   |   â”œâ”€â”€ hdus.rst
|   |   |   |   â”œâ”€â”€ headers.rst
|   |   |   |   â”œâ”€â”€ images.rst
|   |   |   |   â”œâ”€â”€ tables.rst
|   |   |   |   â””â”€â”€ verification.rst
|   |   |   â”œâ”€â”€ appendix
|   |   |   |   â”œâ”€â”€ faq.rst
|   |   |   |   â”œâ”€â”€ header_transition.rst
|   |   |   |   â””â”€â”€ history.rst
|   |   |   â”œâ”€â”€ index.rst
|   |   |   â”œâ”€â”€ performance.inc.rst
|   |   |   â””â”€â”€ usage
|   |   |       â”œâ”€â”€ headers.rst
|   |   |       â”œâ”€â”€ image.rst
|   |   |       â”œâ”€â”€ misc.rst
|   |   |       â”œâ”€â”€ scripts.rst
|   |   |       â”œâ”€â”€ table.rst
|   |   |       â”œâ”€â”€ unfamiliar.rst
|   |   |       â””â”€â”€ verification.rst
|   |   â”œâ”€â”€ misc.rst
|   |   â”œâ”€â”€ registry.rst
|   |   â”œâ”€â”€ unified.rst
|   |   â””â”€â”€ votable
|   |       â”œâ”€â”€ api_exceptions.rst
|   |       â”œâ”€â”€ index.rst
|   |       â”œâ”€â”€ performance.inc.rst
|   |       â””â”€â”€ references.txt
|   â”œâ”€â”€ known_issues.rst
|   â”œâ”€â”€ license.rst
|   â”œâ”€â”€ logging.rst
|   â”œâ”€â”€ lts_policy.rst
|   â”œâ”€â”€ modeling
|   |   â”œâ”€â”€ add-units.rst
|   |   â”œâ”€â”€ compound-models.rst
|   |   â”œâ”€â”€ example-fitting-constraints.rst
|   |   â”œâ”€â”€ example-fitting-line.rst
|   |   â”œâ”€â”€ example-fitting-model-sets.rst
|   |   â”œâ”€â”€ fitting.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ jointfitter.rst
|   |   â”œâ”€â”€ models.rst
|   |   â”œâ”€â”€ new-fitter.rst
|   |   â”œâ”€â”€ new-model.rst
|   |   â”œâ”€â”€ parameters.rst
|   |   â”œâ”€â”€ performance.rst
|   |   â”œâ”€â”€ physical_models.rst
|   |   â”œâ”€â”€ polynomial_models.rst
|   |   â”œâ”€â”€ powerlaw_models.rst
|   |   â”œâ”€â”€ predef_models1D.rst
|   |   â”œâ”€â”€ predef_models2D.rst
|   |   â”œâ”€â”€ reference_api.rst
|   |   â”œâ”€â”€ spline_models.rst
|   |   â””â”€â”€ units.rst
|   â”œâ”€â”€ nddata
|   |   â”œâ”€â”€ bitmask.rst
|   |   â”œâ”€â”€ ccddata.rst
|   |   â”œâ”€â”€ decorator.rst
|   |   â”œâ”€â”€ examples
|   |   |   â””â”€â”€ cutout2d_tofits.py
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ mixins
|   |   |   â”œâ”€â”€ index.rst
|   |   |   â”œâ”€â”€ ndarithmetic.rst
|   |   |   â”œâ”€â”€ ndio.rst
|   |   |   â””â”€â”€ ndslicing.rst
|   |   â”œâ”€â”€ nddata.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â”œâ”€â”€ subclassing.rst
|   |   â””â”€â”€ utils.rst
|   â”œâ”€â”€ overview.rst
|   â”œâ”€â”€ robots.txt
|   â”œâ”€â”€ samp
|   |   â”œâ”€â”€ advanced_embed_samp_hub.rst
|   |   â”œâ”€â”€ example_clients.rst
|   |   â”œâ”€â”€ example_hub.rst
|   |   â”œâ”€â”€ example_table_image.rst
|   |   â”œâ”€â”€ index.rst
|   |   â””â”€â”€ performance.inc.rst
|   â”œâ”€â”€ stats
|   |   â”œâ”€â”€ circ.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â”œâ”€â”€ ripley.rst
|   |   â””â”€â”€ robust.rst
|   â”œâ”€â”€ table
|   |   â”œâ”€â”€ access_table.rst
|   |   â”œâ”€â”€ construct_table.rst
|   |   â”œâ”€â”€ implementation_details.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ indexing.rst
|   |   â”œâ”€â”€ io.rst
|   |   â”œâ”€â”€ masking.rst
|   |   â”œâ”€â”€ mixin_columns.rst
|   |   â”œâ”€â”€ modify_table.rst
|   |   â”œâ”€â”€ operations.rst
|   |   â”œâ”€â”€ pandas.rst
|   |   â””â”€â”€ performance.inc.rst
|   â”œâ”€â”€ testhelpers.rst
|   â”œâ”€â”€ time
|   |   â”œâ”€â”€ index.rst
|   |   â””â”€â”€ performance.inc.rst
|   â”œâ”€â”€ timeseries
|   |   â”œâ”€â”€ analysis.rst
|   |   â”œâ”€â”€ bls.rst
|   |   â”œâ”€â”€ data_access.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ initializing.rst
|   |   â”œâ”€â”€ io.rst
|   |   â”œâ”€â”€ lombscargle.rst
|   |   â”œâ”€â”€ masking.rst
|   |   â”œâ”€â”€ pandas.rst
|   |   â””â”€â”€ times.rst
|   â”œâ”€â”€ uncertainty
|   |   â”œâ”€â”€ index.rst
|   |   â””â”€â”€ performance.inc.rst
|   â”œâ”€â”€ units
|   |   â”œâ”€â”€ combining_and_defining.rst
|   |   â”œâ”€â”€ constants_versions.rst
|   |   â”œâ”€â”€ conversion.rst
|   |   â”œâ”€â”€ decomposing_and_composing.rst
|   |   â”œâ”€â”€ equivalencies.rst
|   |   â”œâ”€â”€ format.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ logarithmic_units.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â”œâ”€â”€ physical_types.rst
|   |   â”œâ”€â”€ quantity.rst
|   |   â”œâ”€â”€ standard_units.rst
|   |   â”œâ”€â”€ structured_units.rst
|   |   â””â”€â”€ type_hints.rst
|   â”œâ”€â”€ utils
|   |   â”œâ”€â”€ data.rst
|   |   â”œâ”€â”€ iers.rst
|   |   â”œâ”€â”€ index.rst
|   |   â””â”€â”€ masked
|   |       â””â”€â”€ index.rst
|   â”œâ”€â”€ visualization
|   |   â”œâ”€â”€ histogram.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ matplotlib_integration.rst
|   |   â”œâ”€â”€ normalization.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â”œâ”€â”€ rgb.rst
|   |   â””â”€â”€ wcsaxes
|   |       â”œâ”€â”€ controlling_axes.rst
|   |       â”œâ”€â”€ custom_frames.rst
|   |       â”œâ”€â”€ generic_transforms.rst
|   |       â”œâ”€â”€ images_contours.rst
|   |       â”œâ”€â”€ index.rst
|   |       â”œâ”€â”€ initializing_axes.rst
|   |       â”œâ”€â”€ overlaying_coordinate_systems.rst
|   |       â”œâ”€â”€ overlays.rst
|   |       â”œâ”€â”€ slicing_datacubes.rst
|   |       â””â”€â”€ ticks_labels_grid.rst
|   â”œâ”€â”€ warnings.rst
|   â”œâ”€â”€ wcs
|   |   â”œâ”€â”€ example_create_imaging.rst
|   |   â”œâ”€â”€ example_cube_wcs.rst
|   |   â”œâ”€â”€ examples
|   |   |   â”œâ”€â”€ cube_wcs.py
|   |   |   â”œâ”€â”€ from_file.py
|   |   |   â””â”€â”€ programmatic.py
|   |   â”œâ”€â”€ history.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ legacy_interface.rst
|   |   â”œâ”€â”€ loading_from_fits.rst
|   |   â”œâ”€â”€ note_sip.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â”œâ”€â”€ reference_api.rst
|   |   â”œâ”€â”€ references.rst
|   |   â”œâ”€â”€ references.txt
|   |   â”œâ”€â”€ relax.rst
|   |   â”œâ”€â”€ supported_projections.rst
|   |   â”œâ”€â”€ validation.rst
|   |   â”œâ”€â”€ wcsapi.rst
|   |   â””â”€â”€ wcstools.rst
|   â””â”€â”€ whatsnew
|       â”œâ”€â”€ 0.1.rst
|       â”œâ”€â”€ 0.2.rst
|       â”œâ”€â”€ 0.3.rst
|       â”œâ”€â”€ 0.4.rst
|       â”œâ”€â”€ 1.0.rst
|       â”œâ”€â”€ 1.1.rst
|       â”œâ”€â”€ 1.2.rst
|       â”œâ”€â”€ 1.3.rst
|       â”œâ”€â”€ 2.0.rst
|       â”œâ”€â”€ 3.0.rst
|       â”œâ”€â”€ 3.1.rst
|       â”œâ”€â”€ 3.2.rst
|       â”œâ”€â”€ 4.0.rst
|       â”œâ”€â”€ 4.1.rst
|       â”œâ”€â”€ 4.2.rst
|       â”œâ”€â”€ 4.3.rst
|       â”œâ”€â”€ 5.0.rst
|       â”œâ”€â”€ 5.1.rst
|       â”œâ”€â”€ 5.2.rst
|       â””â”€â”€ index.rst
â”œâ”€â”€ examples
|   â”œâ”€â”€ README.rst
|   â”œâ”€â”€ coordinates
|   |   â”œâ”€â”€ README.txt
|   |   â”œâ”€â”€ plot_galactocentric-frame.py
|   |   â”œâ”€â”€ plot_obs-planning.py
|   |   â”œâ”€â”€ plot_sgr-coordinate-frame.py
|   |   â””â”€â”€ rv-to-gsr.py
|   â”œâ”€â”€ io
|   |   â”œâ”€â”€ README.txt
|   |   â”œâ”€â”€ create-mef.py
|   |   â”œâ”€â”€ fits-tables.py
|   |   â”œâ”€â”€ modify-fits-header.py
|   |   â”œâ”€â”€ plot_fits-image.py
|   |   â”œâ”€â”€ skip_create-large-fits.py
|   |   â””â”€â”€ split-jpeg-to-fits.py
|   â””â”€â”€ template
|       â””â”€â”€ example-template.py
â”œâ”€â”€ licenses
|   â”œâ”€â”€ AURA_LICENSE.rst
|   â”œâ”€â”€ CONFIGOBJ_LICENSE.rst
|   â”œâ”€â”€ DATATABLES_LICENSE.rst
|   â”œâ”€â”€ ERFA.rst
|   â”œâ”€â”€ EXPAT_LICENSE.rst
|   â”œâ”€â”€ JQUERY_LICENSE.rst
|   â”œâ”€â”€ NUMPY_LICENSE.rst
|   â”œâ”€â”€ PLY_LICENSE.rst
|   â”œâ”€â”€ PYFITS.rst
|   â”œâ”€â”€ PYTHON.rst
|   â”œâ”€â”€ README.rst
|   â””â”€â”€ WCSLIB_LICENSE.rst
â””â”€â”€ setup.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---
Issue title:
Consider removing auto-transform of structured column into NdarrayMixin

Issue description: 
<!-- This comments are hidden when you submit the issue,
so you do not need to remove them! -->

<!-- Please be sure to check out our contributing guidelines,
https://github.com/astropy/astropy/blob/main/CONTRIBUTING.md .
Please be sure to check out our code of conduct,
https://github.com/astropy/astropy/blob/main/CODE_OF_CONDUCT.md . -->

<!-- Please have a search on our GitHub repository to see if a similar
issue has already been posted.
If a similar issue is closed, have a quick look to see if you are satisfied
by the resolution.
If not please go ahead and open an issue! -->

### Description
<!-- Provide a general description of the feature you would like. -->
<!-- If you want to, you can suggest a draft design or API. -->
<!-- This way we have a deeper discussion on the feature. -->

Currently if you add a structured `np.array` to a Table, it gets turned into an `NdarrayMixin` (via the code below). While this mostly works, I am not sure this is necessary or desirable any more after #12644. Basically the original rational for `NdarrayMixin` was that structured dtype `Column` didn't quite work, in particular for serialization. So we pushed that out to a mixin class which would signal to unified I/O that it might not be supported.

```
        # Structured ndarray gets viewed as a mixin unless already a valid
        # mixin class
        if (not isinstance(data, Column) and not data_is_mixin
                and isinstance(data, np.ndarray) and len(data.dtype) > 1):
            data = data.view(NdarrayMixin)
            data_is_mixin = True
```

Proposal:
- Add a FutureWarning here telling the user to wrap `data` in `Column` and that in the future (5.2) the structured array will be added as a `Column`.
- Change the behavior in 5.2 by removing this clause.

This is not critical for 5.1 but if we have the opportunity due to other (critical) bugfixes it might be nice to save 6 months in the change process.

cc: @mhvk

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: astropy/table/tests/test_mixin.py
Line number range: 1 - 880
Content:
1. # -*- coding: utf-8 -*-
2. # Licensed under a 3-clause BSD style license - see LICENSE.rst
3. 
4. 
5. import copy
6. import pickle
7. from io import StringIO
8. 
9. import pytest
10. import numpy as np
11. 
12. from astropy.table.serialize import represent_mixins_as_columns
13. from astropy.utils.data_info import ParentDtypeInfo
14. from astropy.table.table_helpers import ArrayWrapper
15. from astropy.coordinates import EarthLocation, SkyCoord
16. from astropy.table import Table, QTable, join, hstack, vstack, Column, NdarrayMixin
17. from astropy.table import serialize
18. from astropy import time
19. from astropy import coordinates
20. from astropy import units as u
21. from astropy.table.column import BaseColumn
22. from astropy.table import table_helpers
23. from astropy.utils.exceptions import AstropyUserWarning
24. from astropy.utils.metadata import MergeConflictWarning
25. from astropy.coordinates.tests.test_representation import representation_equal
26. from astropy.coordinates.tests.helper import skycoord_equal
27. 
28. from .conftest import MIXIN_COLS
29. 
30. 
31. def test_attributes(mixin_cols):
32.     """
33.     Required attributes for a column can be set.
34.     """
35.     m = mixin_cols['m']
36.     m.info.name = 'a'
37.     assert m.info.name == 'a'
38. 
39.     m.info.description = 'a'
40.     assert m.info.description == 'a'
41. 
42.     # Cannot set unit for these classes
43.     if isinstance(m, (u.Quantity, coordinates.SkyCoord, time.Time, time.TimeDelta,
44.                       coordinates.BaseRepresentationOrDifferential)):
45.         with pytest.raises(AttributeError):
46.             m.info.unit = u.m
47.     else:
48.         m.info.unit = u.m
49.         assert m.info.unit is u.m
50. 
51.     m.info.format = 'a'
52.     assert m.info.format == 'a'
53. 
54.     m.info.meta = {'a': 1}
55.     assert m.info.meta == {'a': 1}
56. 
57.     with pytest.raises(AttributeError):
58.         m.info.bad_attr = 1
59. 
60.     with pytest.raises(AttributeError):
61.         m.info.bad_attr
62. 
63. 
64. def check_mixin_type(table, table_col, in_col):
65.     # We check for QuantityInfo rather than just isinstance(col, u.Quantity)
66.     # since we want to treat EarthLocation as a mixin, even though it is
67.     # a Quantity subclass.
68.     if ((isinstance(in_col.info, u.QuantityInfo) and type(table) is not QTable)
69.             or isinstance(in_col, Column)):
70.         assert type(table_col) is table.ColumnClass
71.     else:
72.         assert type(table_col) is type(in_col)
73. 
74.     # Make sure in_col got copied and creating table did not touch it
75.     assert in_col.info.name is None
76. 
77. 
78. def test_make_table(table_types, mixin_cols):
79.     """
80.     Make a table with the columns in mixin_cols, which is an ordered dict of
81.     three cols: 'a' and 'b' are table_types.Column type, and 'm' is a mixin.
82.     """
83.     t = table_types.Table(mixin_cols)
84.     check_mixin_type(t, t['m'], mixin_cols['m'])
85. 
86.     cols = list(mixin_cols.values())
87.     t = table_types.Table(cols, names=('i', 'a', 'b', 'm'))
88.     check_mixin_type(t, t['m'], mixin_cols['m'])
89. 
90.     t = table_types.Table(cols)
91.     check_mixin_type(t, t['col3'], mixin_cols['m'])
92. 
93. 
94. def test_io_ascii_write():
95.     """
96.     Test that table with mixin column can be written by io.ascii for
97.     every pure Python writer.  No validation of the output is done,
98.     this just confirms no exceptions.
99.     """
100.     from astropy.io.ascii.connect import _get_connectors_table
101.     t = QTable(MIXIN_COLS)
102.     for fmt in _get_connectors_table():
103.         if fmt['Write'] and '.fast_' not in fmt['Format']:
104.             out = StringIO()
105.             t.write(out, format=fmt['Format'])
106. 
107. 
108. def test_votable_quantity_write(tmpdir):
109.     """
110.     Test that table with Quantity mixin column can be round-tripped by
111.     io.votable.  Note that FITS and HDF5 mixin support are tested (much more
112.     thoroughly) in their respective subpackage tests
113.     (io/fits/tests/test_connect.py and io/misc/tests/test_hdf5.py).
114.     """
115.     t = QTable()
116.     t['a'] = u.Quantity([1, 2, 4], unit='nm')
117. 
118.     filename = str(tmpdir.join('table-tmp'))
119.     t.write(filename, format='votable', overwrite=True)
120.     qt = QTable.read(filename, format='votable')
121.     assert isinstance(qt['a'], u.Quantity)
122.     assert qt['a'].unit == 'nm'
123. 
124. 
125. @pytest.mark.remote_data
126. @pytest.mark.parametrize('table_types', (Table, QTable))
127. def test_io_time_write_fits_standard(tmpdir, table_types):
128.     """
129.     Test that table with Time mixin columns can be written by io.fits.
130.     Validation of the output is done. Test that io.fits writes a table
131.     containing Time mixin columns that can be partially round-tripped
132.     (metadata scale, location).
133. 
134.     Note that we postpone checking the "local" scale, since that cannot
135.     be done with format 'cxcsec', as it requires an epoch.
136.     """
137.     t = table_types([[1, 2], ['string', 'column']])
138.     for scale in time.STANDARD_TIME_SCALES:
139.         t['a' + scale] = time.Time([[1, 2], [3, 4]], format='cxcsec',
140.                                    scale=scale, location=EarthLocation(
141.             -2446354, 4237210, 4077985, unit='m'))
142.         t['b' + scale] = time.Time(['1999-01-01T00:00:00.123456789',
143.                                     '2010-01-01T00:00:00'], scale=scale)
144.     t['c'] = [3., 4.]
145. 
146.     filename = str(tmpdir.join('table-tmp'))
147. 
148.     # Show that FITS format succeeds
149.     with pytest.warns(
150.             AstropyUserWarning,
151.             match='Time Column "btai" has no specified location, '
152.             'but global Time Position is present'):
153.         t.write(filename, format='fits', overwrite=True)
154.     with pytest.warns(
155.             AstropyUserWarning,
156.             match='Time column reference position "TRPOSn" is not specified'):
157.         tm = table_types.read(filename, format='fits', astropy_native=True)
158. 
159.     for scale in time.STANDARD_TIME_SCALES:
160.         for ab in ('a', 'b'):
161.             name = ab + scale
162. 
163.             # Assert that the time columns are read as Time
164.             assert isinstance(tm[name], time.Time)
165. 
166.             # Assert that the scales round-trip
167.             assert tm[name].scale == t[name].scale
168. 
169.             # Assert that the format is jd
170.             assert tm[name].format == 'jd'
171. 
172.             # Assert that the location round-trips
173.             assert tm[name].location == t[name].location
174. 
175.             # Finally assert that the column data round-trips
176.             assert (tm[name] == t[name]).all()
177. 
178.     for name in ('col0', 'col1', 'c'):
179.         # Assert that the non-time columns are read as Column
180.         assert isinstance(tm[name], Column)
181. 
182.         # Assert that the non-time columns' data round-trips
183.         assert (tm[name] == t[name]).all()
184. 
185.     # Test for conversion of time data to its value, as defined by its format
186.     for scale in time.STANDARD_TIME_SCALES:
187.         for ab in ('a', 'b'):
188.             name = ab + scale
189.             t[name].info.serialize_method['fits'] = 'formatted_value'
190. 
191.     t.write(filename, format='fits', overwrite=True)
192.     tm = table_types.read(filename, format='fits')
193. 
194.     for scale in time.STANDARD_TIME_SCALES:
195.         for ab in ('a', 'b'):
196.             name = ab + scale
197. 
198.             assert not isinstance(tm[name], time.Time)
199.             assert (tm[name] == t[name].value).all()
200. 
201. 
202. @pytest.mark.parametrize('table_types', (Table, QTable))
203. def test_io_time_write_fits_local(tmpdir, table_types):
204.     """
205.     Test that table with a Time mixin with scale local can also be written
206.     by io.fits. Like ``test_io_time_write_fits_standard`` above, but avoiding
207.     ``cxcsec`` format, which requires an epoch and thus cannot be used for a
208.     local time scale.
209.     """
210.     t = table_types([[1, 2], ['string', 'column']])
211.     t['a_local'] = time.Time([[50001, 50002], [50003, 50004]],
212.                              format='mjd', scale='local',
213.                              location=EarthLocation(-2446354, 4237210, 4077985,
214.                                                     unit='m'))
215.     t['b_local'] = time.Time(['1999-01-01T00:00:00.123456789',
216.                               '2010-01-01T00:00:00'], scale='local')
217.     t['c'] = [3., 4.]
218. 
219.     filename = str(tmpdir.join('table-tmp'))
220. 
221.     # Show that FITS format succeeds
222. 
223.     with pytest.warns(AstropyUserWarning,
224.                       match='Time Column "b_local" has no specified location'):
225.         t.write(filename, format='fits', overwrite=True)
226. 
227.     with pytest.warns(AstropyUserWarning,
228.                       match='Time column reference position "TRPOSn" is not specified.'):
229.         tm = table_types.read(filename, format='fits', astropy_native=True)
230. 
231.     for ab in ('a', 'b'):
232.         name = ab + '_local'
233. 
234.         # Assert that the time columns are read as Time
235.         assert isinstance(tm[name], time.Time)
236. 
237.         # Assert that the scales round-trip
238.         assert tm[name].scale == t[name].scale
239. 
240.         # Assert that the format is jd
241.         assert tm[name].format == 'jd'
242. 
243.         # Assert that the location round-trips
244.         assert tm[name].location == t[name].location
245. 
246.         # Finally assert that the column data round-trips
247.         assert (tm[name] == t[name]).all()
248. 
249.     for name in ('col0', 'col1', 'c'):
250.         # Assert that the non-time columns are read as Column
251.         assert isinstance(tm[name], Column)
252. 
253.         # Assert that the non-time columns' data round-trips
254.         assert (tm[name] == t[name]).all()
255. 
256.     # Test for conversion of time data to its value, as defined by its format.
257.     for ab in ('a', 'b'):
258.         name = ab + '_local'
259.         t[name].info.serialize_method['fits'] = 'formatted_value'
260. 
261.     t.write(filename, format='fits', overwrite=True)
262.     tm = table_types.read(filename, format='fits')
263. 
264.     for ab in ('a', 'b'):
265.         name = ab + '_local'
266. 
267.         assert not isinstance(tm[name], time.Time)
268.         assert (tm[name] == t[name].value).all()
269. 
270. 
271. def test_votable_mixin_write_fail(mixin_cols):
272.     """
273.     Test that table with mixin columns (excluding Quantity) cannot be written by
274.     io.votable.
275.     """
276.     t = QTable(mixin_cols)
277.     # Only do this test if there are unsupported column types (i.e. anything besides
278.     # BaseColumn and Quantity class instances).
279.     unsupported_cols = t.columns.not_isinstance((BaseColumn, u.Quantity))
280. 
281.     if not unsupported_cols:
282.         pytest.skip("no unsupported column types")
283. 
284.     out = StringIO()
285.     with pytest.raises(ValueError) as err:
286.         t.write(out, format='votable')
287.     assert 'cannot write table with mixin column(s)' in str(err.value)
288. 
289. 
290. def test_join(table_types):
291.     """
292.     Join tables with mixin cols.  Use column "i" as proxy for what the
293.     result should be for each mixin.
294.     """
295.     t1 = table_types.Table()
296.     t1['a'] = table_types.Column(['a', 'b', 'b', 'c'])
297.     t1['i'] = table_types.Column([0, 1, 2, 3])
298.     for name, col in MIXIN_COLS.items():
299.         t1[name] = col
300. 
301.     t2 = table_types.Table(t1)
302.     t2['a'] = ['b', 'c', 'a', 'd']
303. 
304.     for name, col in MIXIN_COLS.items():
305.         t1[name].info.description = name
306.         t2[name].info.description = name + '2'
307. 
308.     for join_type in ('inner', 'left'):
309.         t12 = join(t1, t2, keys='a', join_type=join_type)
310.         idx1 = t12['i_1']
311.         idx2 = t12['i_2']
312.         for name, col in MIXIN_COLS.items():
313.             name1 = name + '_1'
314.             name2 = name + '_2'
315.             assert_table_name_col_equal(t12, name1, col[idx1])
316.             assert_table_name_col_equal(t12, name2, col[idx2])
317.             assert t12[name1].info.description == name
318.             assert t12[name2].info.description == name + '2'
319. 
320.     for join_type in ('outer', 'right'):
321.         with pytest.raises(NotImplementedError) as exc:
322.             t12 = join(t1, t2, keys='a', join_type=join_type)
323.         assert 'join requires masking column' in str(exc.value)
324. 
325.     with pytest.raises(TypeError) as exc:
326.         t12 = join(t1, t2, keys=['a', 'skycoord'])
327.     assert 'one or more key columns are not sortable' in str(exc.value)
328. 
329.     # Join does work for a mixin which is a subclass of np.ndarray
330.     with pytest.warns(MergeConflictWarning,
331.                       match="In merged column 'quantity' the 'description' "
332.                             "attribute does not match"):
333.         t12 = join(t1, t2, keys=['quantity'])
334.     assert np.all(t12['a_1'] == t1['a'])
335. 
336. 
337. def test_hstack(table_types):
338.     """
339.     Hstack tables with mixin cols.  Use column "i" as proxy for what the
340.     result should be for each mixin.
341.     """
342.     t1 = table_types.Table()
343.     t1['i'] = table_types.Column([0, 1, 2, 3])
344.     for name, col in MIXIN_COLS.items():
345.         t1[name] = col
346.         t1[name].info.description = name
347.         t1[name].info.meta = {'a': 1}
348. 
349.     for join_type in ('inner', 'outer'):
350.         for chop in (True, False):
351.             t2 = table_types.Table(t1)
352.             if chop:
353.                 t2 = t2[:-1]
354.                 if join_type == 'outer':
355.                     with pytest.raises(NotImplementedError) as exc:
356.                         t12 = hstack([t1, t2], join_type=join_type)
357.                     assert 'hstack requires masking column' in str(exc.value)
358.                     continue
359. 
360.             t12 = hstack([t1, t2], join_type=join_type)
361.             idx1 = t12['i_1']
362.             idx2 = t12['i_2']
363.             for name, col in MIXIN_COLS.items():
364.                 name1 = name + '_1'
365.                 name2 = name + '_2'
366.                 assert_table_name_col_equal(t12, name1, col[idx1])
367.                 assert_table_name_col_equal(t12, name2, col[idx2])
368.                 for attr in ('description', 'meta'):
369.                     assert getattr(t1[name].info, attr) == getattr(t12[name1].info, attr)
370.                     assert getattr(t2[name].info, attr) == getattr(t12[name2].info, attr)
371. 
372. 
373. def assert_table_name_col_equal(t, name, col):
374.     """
375.     Assert all(t[name] == col), with special handling for known mixin cols.
376.     """
377.     if isinstance(col, coordinates.SkyCoord):
378.         assert np.all(t[name].ra == col.ra)
379.         assert np.all(t[name].dec == col.dec)
380.     elif isinstance(col, coordinates.BaseRepresentationOrDifferential):
381.         assert np.all(representation_equal(t[name], col))
382.     elif isinstance(col, u.Quantity):
383.         if type(t) is QTable:
384.             assert np.all(t[name] == col)
385.     elif isinstance(col, table_helpers.ArrayWrapper):
386.         assert np.all(t[name].data == col.data)
387.     else:
388.         assert np.all(t[name] == col)
389. 
390. 
391. def test_get_items(mixin_cols):
392.     """
393.     Test that slicing / indexing table gives right values and col attrs inherit
394.     """
395.     attrs = ('name', 'unit', 'dtype', 'format', 'description', 'meta')
396.     m = mixin_cols['m']
397.     m.info.name = 'm'
398.     m.info.format = '{0}'
399.     m.info.description = 'd'
400.     m.info.meta = {'a': 1}
401.     t = QTable([m])
402.     for item in ([1, 3], np.array([0, 2]), slice(1, 3)):
403.         t2 = t[item]
404.         m2 = m[item]
405.         assert_table_name_col_equal(t2, 'm', m[item])
406.         for attr in attrs:
407.             assert getattr(t2['m'].info, attr) == getattr(m.info, attr)
408.             assert getattr(m2.info, attr) == getattr(m.info, attr)
409. 
410. 
411. def test_info_preserved_pickle_copy_init(mixin_cols):
412.     """
413.     Test copy, pickle, and init from class roundtrip preserve info.  This
414.     tests not only the mixin classes but a regular column as well.
415.     """
416.     def pickle_roundtrip(c):
417.         return pickle.loads(pickle.dumps(c))
418. 
419.     def init_from_class(c):
420.         return c.__class__(c)
421. 
422.     attrs = ('name', 'unit', 'dtype', 'format', 'description', 'meta')
423.     for colname in ('i', 'm'):
424.         m = mixin_cols[colname]
425.         m.info.name = colname
426.         m.info.format = '{0}'
427.         m.info.description = 'd'
428.         m.info.meta = {'a': 1}
429.         for func in (copy.copy, copy.deepcopy, pickle_roundtrip, init_from_class):
430.             m2 = func(m)
431.             for attr in attrs:
432.                 # non-native byteorder not preserved by last 2 func, _except_ for structured dtype
433.                 if (attr != 'dtype'
434.                         or getattr(m.info.dtype, 'isnative', True)
435.                         or m.info.dtype.name.startswith('void')
436.                         or func in (copy.copy, copy.deepcopy)):
437.                     original = getattr(m.info, attr)
438.                 else:
439.                     # func does not preserve byteorder, check against (native) type.
440.                     original = m.info.dtype.newbyteorder('=')
441.                 assert getattr(m2.info, attr) == original
442. 
443. 
444. def test_add_column(mixin_cols):
445.     """
446.     Test that adding a column preserves values and attributes
447.     """
448.     attrs = ('name', 'unit', 'dtype', 'format', 'description', 'meta')
449.     m = mixin_cols['m']
450.     assert m.info.name is None
451. 
452.     # Make sure adding column in various ways doesn't touch
453.     t = QTable([m], names=['a'])
454.     assert m.info.name is None
455. 
456.     t['new'] = m
457.     assert m.info.name is None
458. 
459.     m.info.name = 'm'
460.     m.info.format = '{0}'
461.     m.info.description = 'd'
462.     m.info.meta = {'a': 1}
463.     t = QTable([m])
464. 
465.     # Add columns m2, m3, m4 by two different methods and test expected equality
466.     t['m2'] = m
467.     m.info.name = 'm3'
468.     t.add_columns([m], copy=True)
469.     m.info.name = 'm4'
470.     t.add_columns([m], copy=False)
471.     for name in ('m2', 'm3', 'm4'):
472.         assert_table_name_col_equal(t, name, m)
473.         for attr in attrs:
474.             if attr != 'name':
475.                 assert getattr(t['m'].info, attr) == getattr(t[name].info, attr)
476.     # Also check that one can set using a scalar.
477.     s = m[0]
478.     if type(s) is type(m) and 'info' in s.__dict__:
479.         # We're not going to worry about testing classes for which scalars
480.         # are a different class than the real array, or where info is not copied.
481.         t['s'] = m[0]
482.         assert_table_name_col_equal(t, 's', m[0])
483.         for attr in attrs:
484.             if attr != 'name':
485.                 assert getattr(t['m'].info, attr) == getattr(t['s'].info, attr)
486. 
487.     # While we're add it, also check a length-1 table.
488.     t = QTable([m[1:2]], names=['m'])
489.     if type(s) is type(m) and 'info' in s.__dict__:
490.         t['s'] = m[0]
491.         assert_table_name_col_equal(t, 's', m[0])
492.         for attr in attrs:
493.             if attr != 'name':
494.                 assert getattr(t['m'].info, attr) == getattr(t['s'].info, attr)
495. 
496. 
497. def test_vstack():
498.     """
499.     Vstack tables with mixin cols.
500.     """
501.     t1 = QTable(MIXIN_COLS)
502.     t2 = QTable(MIXIN_COLS)
503.     with pytest.raises(NotImplementedError):
504.         vstack([t1, t2])
505. 
506. 
507. def test_insert_row(mixin_cols):
508.     """
509.     Test inserting a row, which works for Column, Quantity, Time and SkyCoord.
510.     """
511.     t = QTable(mixin_cols)
512.     t0 = t.copy()
513.     t['m'].info.description = 'd'
514.     idxs = [0, -1, 1, 2, 3]
515.     if isinstance(t['m'], (u.Quantity, Column, time.Time, time.TimeDelta, coordinates.SkyCoord)):
516.         t.insert_row(1, t[-1])
517. 
518.         for name in t.colnames:
519.             col = t[name]
520.             if isinstance(col, coordinates.SkyCoord):
521.                 assert skycoord_equal(col, t0[name][idxs])
522.             else:
523.                 assert np.all(col == t0[name][idxs])
524. 
525.         assert t['m'].info.description == 'd'
526.     else:
527.         with pytest.raises(ValueError) as exc:
528.             t.insert_row(1, t[-1])
529.         assert "Unable to insert row" in str(exc.value)
530. 
531. 
532. def test_insert_row_bad_unit():
533.     """
534.     Insert a row into a QTable with the wrong unit
535.     """
536.     t = QTable([[1] * u.m])
537.     with pytest.raises(ValueError) as exc:
538.         t.insert_row(0, (2 * u.m / u.s,))
539.     assert "'m / s' (speed/velocity) and 'm' (length) are not convertible" in str(exc.value)
540. 
541. 
542. def test_convert_np_array(mixin_cols):
543.     """
544.     Test that converting to numpy array creates an object dtype and that
545.     each instance in the array has the expected type.
546.     """
547.     t = QTable(mixin_cols)
548.     ta = t.as_array()
549.     m = mixin_cols['m']
550.     dtype_kind = m.dtype.kind if hasattr(m, 'dtype') else 'O'
551.     assert ta['m'].dtype.kind == dtype_kind
552. 
553. 
554. def test_assignment_and_copy():
555.     """
556.     Test that assignment of an int, slice, and fancy index works.
557.     Along the way test that copying table works.
558.     """
559.     for name in ('quantity', 'arraywrap'):
560.         m = MIXIN_COLS[name]
561.         t0 = QTable([m], names=['m'])
562.         for i0, i1 in ((1, 2),
563.                        (slice(0, 2), slice(1, 3)),
564.                        (np.array([1, 2]), np.array([2, 3]))):
565.             t = t0.copy()
566.             t['m'][i0] = m[i1]
567.             if name == 'arraywrap':
568.                 assert np.all(t['m'].data[i0] == m.data[i1])
569.                 assert np.all(t0['m'].data[i0] == m.data[i0])
570.                 assert np.all(t0['m'].data[i0] != t['m'].data[i0])
571.             else:
572.                 assert np.all(t['m'][i0] == m[i1])
573.                 assert np.all(t0['m'][i0] == m[i0])
574.                 assert np.all(t0['m'][i0] != t['m'][i0])
575. 
576. 
577. def test_conversion_qtable_table():
578.     """
579.     Test that a table round trips from QTable => Table => QTable
580.     """
581.     qt = QTable(MIXIN_COLS)
582.     names = qt.colnames
583.     for name in names:
584.         qt[name].info.description = name
585. 
586.     t = Table(qt)
587.     for name in names:
588.         assert t[name].info.description == name
589.         if name == 'quantity':
590.             assert np.all(t['quantity'] == qt['quantity'].value)
591.             assert np.all(t['quantity'].unit is qt['quantity'].unit)
592.             assert isinstance(t['quantity'], t.ColumnClass)
593.         else:
594.             assert_table_name_col_equal(t, name, qt[name])
595. 
596.     qt2 = QTable(qt)
597.     for name in names:
598.         assert qt2[name].info.description == name
599.         assert_table_name_col_equal(qt2, name, qt[name])
600. 
601. 
602. def test_setitem_as_column_name():
603.     """
604.     Test for mixin-related regression described in #3321.
605.     """
606.     t = Table()
607.     t['a'] = ['x', 'y']
608.     t['b'] = 'b'  # Previously was failing with KeyError
609.     assert np.all(t['a'] == ['x', 'y'])
610.     assert np.all(t['b'] == ['b', 'b'])
611. 
612. 
613. def test_quantity_representation():
614.     """
615.     Test that table representation of quantities does not have unit
616.     """
617.     t = QTable([[1, 2] * u.m])
618.     assert t.pformat() == ['col0',
619.                            ' m  ',
620.                            '----',
621.                            ' 1.0',
622.                            ' 2.0']
623. 
624. 
625. def test_representation_representation():
626.     """
627.     Test that Representations are represented correctly.
628.     """
629.     # With no unit we get "None" in the unit row
630.     c = coordinates.CartesianRepresentation([0], [1], [0], unit=u.one)
631.     t = Table([c])
632.     assert t.pformat() == ['    col0    ',
633.                            '------------',
634.                            '(0., 1., 0.)']
635. 
636.     c = coordinates.CartesianRepresentation([0], [1], [0], unit='m')
637.     t = Table([c])
638.     assert t.pformat() == ['    col0    ',
639.                            '     m      ',
640.                            '------------',
641.                            '(0., 1., 0.)']
642. 
643.     c = coordinates.SphericalRepresentation([10]*u.deg, [20]*u.deg, [1]*u.pc)
644.     t = Table([c])
645.     assert t.pformat() == ['     col0     ',
646.                            ' deg, deg, pc ',
647.                            '--------------',
648.                            '(10., 20., 1.)']
649. 
650.     c = coordinates.UnitSphericalRepresentation([10]*u.deg, [20]*u.deg)
651.     t = Table([c])
652.     assert t.pformat() == ['   col0   ',
653.                            '   deg    ',
654.                            '----------',
655.                            '(10., 20.)']
656. 
657.     c = coordinates.SphericalCosLatDifferential(
658.         [10]*u.mas/u.yr, [2]*u.mas/u.yr, [10]*u.km/u.s)
659.     t = Table([c])
660.     assert t.pformat() == ['           col0           ',
661.                            'mas / yr, mas / yr, km / s',
662.                            '--------------------------',
663.                            '            (10., 2., 10.)']
664. 
665. 
666. def test_skycoord_representation():
667.     """
668.     Test that skycoord representation works, both in the way that the
669.     values are output and in changing the frame representation.
670.     """
671.     # With no unit we get "None" in the unit row
672.     c = coordinates.SkyCoord([0], [1], [0], representation_type='cartesian')
673.     t = Table([c])
674.     assert t.pformat() == ['     col0     ',
675.                            'None,None,None',
676.                            '--------------',
677.                            '   0.0,1.0,0.0']
678. 
679.     # Test that info works with a dynamically changed representation
680.     c = coordinates.SkyCoord([0], [1], [0], unit='m', representation_type='cartesian')
681.     t = Table([c])
682.     assert t.pformat() == ['    col0   ',
683.                            '   m,m,m   ',
684.                            '-----------',
685.                            '0.0,1.0,0.0']
686. 
687.     t['col0'].representation_type = 'unitspherical'
688.     assert t.pformat() == ['  col0  ',
689.                            'deg,deg ',
690.                            '--------',
691.                            '90.0,0.0']
692. 
693.     t['col0'].representation_type = 'cylindrical'
694.     assert t.pformat() == ['    col0    ',
695.                            '  m,deg,m   ',
696.                            '------------',
697.                            '1.0,90.0,0.0']
698. 
699. 
700. def test_ndarray_mixin():
701.     """
702.     Test directly adding a plain structured array into a table instead of the
703.     view as an NdarrayMixin.  Once added as an NdarrayMixin then all the previous
704.     tests apply.
705.     """
706.     a = np.array([(1, 'a'), (2, 'b'), (3, 'c'), (4, 'd')],
707.                  dtype='<i4,' + ('|U1'))
708.     b = np.array([(10, 'aa'), (20, 'bb'), (30, 'cc'), (40, 'dd')],
709.                  dtype=[('x', 'i4'), ('y', ('U2'))])
710.     c = np.rec.fromrecords([(100., 'raa'), (200., 'rbb'), (300., 'rcc'), (400., 'rdd')],
711.                            names=['rx', 'ry'])
712.     d = np.arange(8, dtype='i8').reshape(4, 2).view(NdarrayMixin)
713. 
714.     # Add one during initialization and the next as a new column.
715.     t = Table([a], names=['a'])
716.     t['b'] = b
717.     t['c'] = c
718.     t['d'] = d
719. 
720.     assert isinstance(t['a'], NdarrayMixin)
721. 
722.     assert t['a'][1][1] == a[1][1]
723.     assert t['a'][2][0] == a[2][0]
724. 
725.     assert t[1]['a'][1] == a[1][1]
726.     assert t[2]['a'][0] == a[2][0]
727. 
728.     assert isinstance(t['b'], NdarrayMixin)
729. 
730.     assert t['b'][1]['x'] == b[1]['x']
731.     assert t['b'][1]['y'] == b[1]['y']
732. 
733.     assert t[1]['b']['x'] == b[1]['x']
734.     assert t[1]['b']['y'] == b[1]['y']
735. 
736.     assert isinstance(t['c'], NdarrayMixin)
737. 
738.     assert t['c'][1]['rx'] == c[1]['rx']
739.     assert t['c'][1]['ry'] == c[1]['ry']
740. 
741.     assert t[1]['c']['rx'] == c[1]['rx']
742.     assert t[1]['c']['ry'] == c[1]['ry']
743. 
744.     assert isinstance(t['d'], NdarrayMixin)
745. 
746.     assert t['d'][1][0] == d[1][0]
747.     assert t['d'][1][1] == d[1][1]
748. 
749.     assert t[1]['d'][0] == d[1][0]
750.     assert t[1]['d'][1] == d[1][1]
751. 
752.     assert t.pformat(show_dtype=True) == [
753.         '  a [f0, f1]     b [x, y]      c [rx, ry]      d    ',
754.         '(int32, str1) (int32, str2) (float64, str3) int64[2]',
755.         '------------- ------------- --------------- --------',
756.         "     (1, 'a')    (10, 'aa')   (100., 'raa')   0 .. 1",
757.         "     (2, 'b')    (20, 'bb')   (200., 'rbb')   2 .. 3",
758.         "     (3, 'c')    (30, 'cc')   (300., 'rcc')   4 .. 5",
759.         "     (4, 'd')    (40, 'dd')   (400., 'rdd')   6 .. 7"]
760. 
761. 
762. def test_possible_string_format_functions():
763.     """
764.     The QuantityInfo info class for Quantity implements a
765.     possible_string_format_functions() method that overrides the
766.     standard pprint._possible_string_format_functions() function.
767.     Test this.
768.     """
769.     t = QTable([[1, 2] * u.m])
770.     t['col0'].info.format = '%.3f'
771.     assert t.pformat() == [' col0',
772.                            '  m  ',
773.                            '-----',
774.                            '1.000',
775.                            '2.000']
776. 
777.     t['col0'].info.format = 'hi {:.3f}'
778.     assert t.pformat() == ['  col0  ',
779.                            '   m    ',
780.                            '--------',
781.                            'hi 1.000',
782.                            'hi 2.000']
783. 
784.     t['col0'].info.format = '.4f'
785.     assert t.pformat() == [' col0 ',
786.                            '  m   ',
787.                            '------',
788.                            '1.0000',
789.                            '2.0000']
790. 
791. 
792. def test_rename_mixin_columns(mixin_cols):
793.     """
794.     Rename a mixin column.
795.     """
796.     t = QTable(mixin_cols)
797.     tc = t.copy()
798.     t.rename_column('m', 'mm')
799.     assert t.colnames == ['i', 'a', 'b', 'mm']
800.     if isinstance(t['mm'], table_helpers.ArrayWrapper):
801.         assert np.all(t['mm'].data == tc['m'].data)
802.     elif isinstance(t['mm'], coordinates.SkyCoord):
803.         assert np.all(t['mm'].ra == tc['m'].ra)
804.         assert np.all(t['mm'].dec == tc['m'].dec)
805.     elif isinstance(t['mm'], coordinates.BaseRepresentationOrDifferential):
806.         assert np.all(representation_equal(t['mm'], tc['m']))
807.     else:
808.         assert np.all(t['mm'] == tc['m'])
809. 
810. 
811. def test_represent_mixins_as_columns_unit_fix():
812.     """
813.     If the unit is invalid for a column that gets serialized this would
814.     cause an exception.  Fixed in #7481.
815.     """
816.     t = Table({'a': [1, 2]}, masked=True)
817.     t['a'].unit = 'not a valid unit'
818.     t['a'].mask[1] = True
819.     serialize.represent_mixins_as_columns(t)
820. 
821. 
822. def test_primary_data_column_gets_description():
823.     """
824.     If the mixin defines a primary data column, that should get the
825.     description, format, etc., so no __info__ should be needed.
826.     """
827.     t = QTable({'a': [1, 2] * u.m})
828.     t['a'].info.description = 'parrot'
829.     t['a'].info.format = '7.2f'
830.     tser = serialize.represent_mixins_as_columns(t)
831.     assert '__info__' not in tser.meta['__serialized_columns__']['a']
832.     assert tser['a'].format == '7.2f'
833.     assert tser['a'].description == 'parrot'
834. 
835. 
836. def test_skycoord_with_velocity():
837.     # Regression test for gh-6447
838.     sc = SkyCoord([1], [2], unit='deg', galcen_v_sun=None)
839.     t = Table([sc])
840.     s = StringIO()
841.     t.write(s, format='ascii.ecsv', overwrite=True)
842.     s.seek(0)
843.     t2 = Table.read(s.read(), format='ascii.ecsv')
844.     assert skycoord_equal(t2['col0'], sc)
845. 
846. 
847. @pytest.mark.parametrize('table_cls', [Table, QTable])
848. def test_ensure_input_info_is_unchanged(table_cls):
849.     """If a mixin input to a table has no info, it should stay that way.
850. 
851.     This since having 'info' slows down slicing, etc.
852.     See gh-11066.
853.     """
854.     q = [1, 2] * u.m
855.     assert 'info' not in q.__dict__
856.     t = table_cls([q], names=['q'])
857.     assert 'info' not in q.__dict__
858.     t = table_cls([q])
859.     assert 'info' not in q.__dict__
860.     t = table_cls({'q': q})
861.     assert 'info' not in q.__dict__
862.     t['q2'] = q
863.     assert 'info' not in q.__dict__
864.     sc = SkyCoord([1, 2], [2, 3], unit='deg')
865.     t['sc'] = sc
866.     assert 'info' not in sc.__dict__
867. 
868. 
869. def test_bad_info_class():
870.     """Make a mixin column class that does not trigger the machinery to generate
871.     a pure column representation"""
872.     class MyArrayWrapper(ArrayWrapper):
873.         info = ParentDtypeInfo()
874. 
875.     t = Table()
876.     t['tm'] = MyArrayWrapper([0, 1, 2])
877.     out = StringIO()
878.     match = r"failed to represent column 'tm' \(MyArrayWrapper\) as one or more Column subclasses"
879.     with pytest.raises(TypeError, match=match):
880.         represent_mixins_as_columns(t)

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

2025-10-04 06:58:12,042 - thread-139911184823872.app.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The user wants to find 5 relevant test cases that demonstrate the auto-transformation of a structured numpy array into an `NdarrayMixin` when added to an `astropy` `Table`. The provided context from `astropy/table/tests/test_mixin.py` is sufficient for this task. I have identified the following relevant tests:\n\n1.  **`test_ndarray_mixin`**: This is the most direct and relevant test. It explicitly creates structured `numpy` arrays, adds them to a `Table`, and asserts that the resulting columns are instances of `NdarrayMixin`. This perfectly demonstrates the behavior described in the user's query.\n\n2.  **`test_represent_mixins_as_columns`**: The user's issue description mentions that the original rationale for `NdarrayMixin` was related to serialization. This test, along with its helper function `represent_mixins_as_columns`, demonstrates how mixin columns are prepared for serialization, which is a key part of the `NdarrayMixin`'s purpose.\n\n3.  **`test_bad_info_class`**: This test shows the failure mode when a mixin column *cannot* be properly serialized. It highlights the problem that the `NdarrayMixin` auto-conversion mechanism was designed to solve, providing crucial context for why the feature exists in the first place.\n\n4.  **`test_assignment_and_copy`**: This test verifies the behavior of mixin columns (including `ArrayWrapper`, a related class) during assignment and copy operations. This is important to show how the `NdarrayMixin` column integrates with fundamental table operations after it has been created.\n\n5.  **`test_get_items`**: This test checks that slicing and indexing a table with mixin columns works correctly and that the column's metadata (`info`) is preserved. This is a fundamental behavior that any column, including an `NdarrayMixin`, must support correctly.\n\nAll these tests are contained within the provided file and have their necessary imports listed at the top of the file. Therefore, no additional context is required." refined_query=''
2025-10-04 06:58:12,042 - thread-139911184823872.app.lang_graph.nodes.context_retrieval_subgraph_node - INFO - Context retrieved: [Context(relative_path='astropy/table/tests/test_mixin.py', content='1. # -*- coding: utf-8 -*-\n2. # Licensed under a 3-clause BSD style license - see LICENSE.rst\n3. \n4. \n5. import copy\n6. import pickle\n7. from io import StringIO\n8. \n9. import pytest\n10. import numpy as np\n11. \n12. from astropy.table.serialize import represent_mixins_as_columns\n13. from astropy.utils.data_info import ParentDtypeInfo\n14. from astropy.table.table_helpers import ArrayWrapper\n15. from astropy.coordinates import EarthLocation, SkyCoord\n16. from astropy.table import Table, QTable, join, hstack, vstack, Column, NdarrayMixin\n17. from astropy.table import serialize\n18. from astropy import time\n19. from astropy import coordinates\n20. from astropy import units as u\n21. from astropy.table.column import BaseColumn\n22. from astropy.table import table_helpers\n23. from astropy.utils.exceptions import AstropyUserWarning\n24. from astropy.utils.metadata import MergeConflictWarning\n25. from astropy.coordinates.tests.test_representation import representation_equal\n26. from astropy.coordinates.tests.helper import skycoord_equal\n27. \n28. from .conftest import MIXIN_COLS\n29. \n30. \n31. def test_attributes(mixin_cols):\n32.     """\n33.     Required attributes for a column can be set.\n34.     """\n35.     m = mixin_cols[\'m\']\n36.     m.info.name = \'a\'\n37.     assert m.info.name == \'a\'\n38. \n39.     m.info.description = \'a\'\n40.     assert m.info.description == \'a\'\n41. \n42.     # Cannot set unit for these classes\n43.     if isinstance(m, (u.Quantity, coordinates.SkyCoord, time.Time, time.TimeDelta,\n44.                       coordinates.BaseRepresentationOrDifferential)):\n45.         with pytest.raises(AttributeError):\n46.             m.info.unit = u.m\n47.     else:\n48.         m.info.unit = u.m\n49.         assert m.info.unit is u.m\n50. \n51.     m.info.format = \'a\'\n52.     assert m.info.format == \'a\'\n53. \n54.     m.info.meta = {\'a\': 1}\n55.     assert m.info.meta == {\'a\': 1}\n56. \n57.     with pytest.raises(AttributeError):\n58.         m.info.bad_attr = 1\n59. \n60.     with pytest.raises(AttributeError):\n61.         m.info.bad_attr\n62. \n63. \n64. def check_mixin_type(table, table_col, in_col):\n65.     # We check for QuantityInfo rather than just isinstance(col, u.Quantity)\n66.     # since we want to treat EarthLocation as a mixin, even though it is\n67.     # a Quantity subclass.\n68.     if ((isinstance(in_col.info, u.QuantityInfo) and type(table) is not QTable)\n69.             or isinstance(in_col, Column)):\n70.         assert type(table_col) is table.ColumnClass\n71.     else:\n72.         assert type(table_col) is type(in_col)\n73. \n74.     # Make sure in_col got copied and creating table did not touch it\n75.     assert in_col.info.name is None\n76. \n77. \n78. def test_make_table(table_types, mixin_cols):\n79.     """\n80.     Make a table with the columns in mixin_cols, which is an ordered dict of\n81.     three cols: \'a\' and \'b\' are table_types.Column type, and \'m\' is a mixin.\n82.     """\n83.     t = table_types.Table(mixin_cols)\n84.     check_mixin_type(t, t[\'m\'], mixin_cols[\'m\'])\n85. \n86.     cols = list(mixin_cols.values())\n87.     t = table_types.Table(cols, names=(\'i\', \'a\', \'b\', \'m\'))\n88.     check_mixin_type(t, t[\'m\'], mixin_cols[\'m\'])\n89. \n90.     t = table_types.Table(cols)\n91.     check_mixin_type(t, t[\'col3\'], mixin_cols[\'m\'])\n92. \n93. \n94. def test_io_ascii_write():\n95.     """\n96.     Test that table with mixin column can be written by io.ascii for\n97.     every pure Python writer.  No validation of the output is done,\n98.     this just confirms no exceptions.\n99.     """\n100.     from astropy.io.ascii.connect import _get_connectors_table\n101.     t = QTable(MIXIN_COLS)\n102.     for fmt in _get_connectors_table():\n103.         if fmt[\'Write\'] and \'.fast_\' not in fmt[\'Format\']:\n104.             out = StringIO()\n105.             t.write(out, format=fmt[\'Format\'])\n106. \n107. \n108. def test_votable_quantity_write(tmpdir):\n109.     """\n110.     Test that table with Quantity mixin column can be round-tripped by\n111.     io.votable.  Note that FITS and HDF5 mixin support are tested (much more\n112.     thoroughly) in their respective subpackage tests\n113.     (io/fits/tests/test_connect.py and io/misc/tests/test_hdf5.py).\n114.     """\n115.     t = QTable()\n116.     t[\'a\'] = u.Quantity([1, 2, 4], unit=\'nm\')\n117. \n118.     filename = str(tmpdir.join(\'table-tmp\'))\n119.     t.write(filename, format=\'votable\', overwrite=True)\n120.     qt = QTable.read(filename, format=\'votable\')\n121.     assert isinstance(qt[\'a\'], u.Quantity)\n122.     assert qt[\'a\'].unit == \'nm\'\n123. \n124. \n125. @pytest.mark.remote_data\n126. @pytest.mark.parametrize(\'table_types\', (Table, QTable))\n127. def test_io_time_write_fits_standard(tmpdir, table_types):\n128.     """\n129.     Test that table with Time mixin columns can be written by io.fits.\n130.     Validation of the output is done. Test that io.fits writes a table\n131.     containing Time mixin columns that can be partially round-tripped\n132.     (metadata scale, location).\n133. \n134.     Note that we postpone checking the "local" scale, since that cannot\n135.     be done with format \'cxcsec\', as it requires an epoch.\n136.     """\n137.     t = table_types([[1, 2], [\'string\', \'column\']])\n138.     for scale in time.STANDARD_TIME_SCALES:\n139.         t[\'a\' + scale] = time.Time([[1, 2], [3, 4]], format=\'cxcsec\',\n140.                                    scale=scale, location=EarthLocation(\n141.             -2446354, 4237210, 4077985, unit=\'m\'))\n142.         t[\'b\' + scale] = time.Time([\'1999-01-01T00:00:00.123456789\',\n143.                                     \'2010-01-01T00:00:00\'], scale=scale)\n144.     t[\'c\'] = [3., 4.]\n145. \n146.     filename = str(tmpdir.join(\'table-tmp\'))\n147. \n148.     # Show that FITS format succeeds\n149.     with pytest.warns(\n150.             AstropyUserWarning,\n151.             match=\'Time Column "btai" has no specified location, \'\n152.             \'but global Time Position is present\'):\n153.         t.write(filename, format=\'fits\', overwrite=True)\n154.     with pytest.warns(\n155.             AstropyUserWarning,\n156.             match=\'Time column reference position "TRPOSn" is not specified\'):\n157.         tm = table_types.read(filename, format=\'fits\', astropy_native=True)\n158. \n159.     for scale in time.STANDARD_TIME_SCALES:\n160.         for ab in (\'a\', \'b\'):\n161.             name = ab + scale\n162. \n163.             # Assert that the time columns are read as Time\n164.             assert isinstance(tm[name], time.Time)\n165. \n166.             # Assert that the scales round-trip\n167.             assert tm[name].scale == t[name].scale\n168. \n169.             # Assert that the format is jd\n170.             assert tm[name].format == \'jd\'\n171. \n172.             # Assert that the location round-trips\n173.             assert tm[name].location == t[name].location\n174. \n175.             # Finally assert that the column data round-trips\n176.             assert (tm[name] == t[name]).all()\n177. \n178.     for name in (\'col0\', \'col1\', \'c\'):\n179.         # Assert that the non-time columns are read as Column\n180.         assert isinstance(tm[name], Column)\n181. \n182.         # Assert that the non-time columns\' data round-trips\n183.         assert (tm[name] == t[name]).all()\n184. \n185.     # Test for conversion of time data to its value, as defined by its format\n186.     for scale in time.STANDARD_TIME_SCALES:\n187.         for ab in (\'a\', \'b\'):\n188.             name = ab + scale\n189.             t[name].info.serialize_method[\'fits\'] = \'formatted_value\'\n190. \n191.     t.write(filename, format=\'fits\', overwrite=True)\n192.     tm = table_types.read(filename, format=\'fits\')\n193. \n194.     for scale in time.STANDARD_TIME_SCALES:\n195.         for ab in (\'a\', \'b\'):\n196.             name = ab + scale\n197. \n198.             assert not isinstance(tm[name], time.Time)\n199.             assert (tm[name] == t[name].value).all()\n200. \n201. \n202. @pytest.mark.parametrize(\'table_types\', (Table, QTable))\n203. def test_io_time_write_fits_local(tmpdir, table_types):\n204.     """\n205.     Test that table with a Time mixin with scale local can also be written\n206.     by io.fits. Like ``test_io_time_write_fits_standard`` above, but avoiding\n207.     ``cxcsec`` format, which requires an epoch and thus cannot be used for a\n208.     local time scale.\n209.     """\n210.     t = table_types([[1, 2], [\'string\', \'column\']])\n211.     t[\'a_local\'] = time.Time([[50001, 50002], [50003, 50004]],\n212.                              format=\'mjd\', scale=\'local\',\n213.                              location=EarthLocation(-2446354, 4237210, 4077985,\n214.                                                     unit=\'m\'))\n215.     t[\'b_local\'] = time.Time([\'1999-01-01T00:00:00.123456789\',\n216.                               \'2010-01-01T00:00:00\'], scale=\'local\')\n217.     t[\'c\'] = [3., 4.]\n218. \n219.     filename = str(tmpdir.join(\'table-tmp\'))\n220. \n221.     # Show that FITS format succeeds\n222. \n223.     with pytest.warns(AstropyUserWarning,\n224.                       match=\'Time Column "b_local" has no specified location\'):\n225.         t.write(filename, format=\'fits\', overwrite=True)\n226. \n227.     with pytest.warns(AstropyUserWarning,\n228.                       match=\'Time column reference position "TRPOSn" is not specified.\'):\n229.         tm = table_types.read(filename, format=\'fits\', astropy_native=True)\n230. \n231.     for ab in (\'a\', \'b\'):\n232.         name = ab + \'_local\'\n233. \n234.         # Assert that the time columns are read as Time\n235.         assert isinstance(tm[name], time.Time)\n236. \n237.         # Assert that the scales round-trip\n238.         assert tm[name].scale == t[name].scale\n239. \n240.         # Assert that the format is jd\n241.         assert tm[name].format == \'jd\'\n242. \n243.         # Assert that the location round-trips\n244.         assert tm[name].location == t[name].location\n245. \n246.         # Finally assert that the column data round-trips\n247.         assert (tm[name] == t[name]).all()\n248. \n249.     for name in (\'col0\', \'col1\', \'c\'):\n250.         # Assert that the non-time columns are read as Column\n251.         assert isinstance(tm[name], Column)\n252. \n253.         # Assert that the non-time columns\' data round-trips\n254.         assert (tm[name] == t[name]).all()\n255. \n256.     # Test for conversion of time data to its value, as defined by its format.\n257.     for ab in (\'a\', \'b\'):\n258.         name = ab + \'_local\'\n259.         t[name].info.serialize_method[\'fits\'] = \'formatted_value\'\n260. \n261.     t.write(filename, format=\'fits\', overwrite=True)\n262.     tm = table_types.read(filename, format=\'fits\')\n263. \n264.     for ab in (\'a\', \'b\'):\n265.         name = ab + \'_local\'\n266. \n267.         assert not isinstance(tm[name], time.Time)\n268.         assert (tm[name] == t[name].value).all()\n269. \n270. \n271. def test_votable_mixin_write_fail(mixin_cols):\n272.     """\n273.     Test that table with mixin columns (excluding Quantity) cannot be written by\n274.     io.votable.\n275.     """\n276.     t = QTable(mixin_cols)\n277.     # Only do this test if there are unsupported column types (i.e. anything besides\n278.     # BaseColumn and Quantity class instances).\n279.     unsupported_cols = t.columns.not_isinstance((BaseColumn, u.Quantity))\n280. \n281.     if not unsupported_cols:\n282.         pytest.skip("no unsupported column types")\n283. \n284.     out = StringIO()\n285.     with pytest.raises(ValueError) as err:\n286.         t.write(out, format=\'votable\')\n287.     assert \'cannot write table with mixin column(s)\' in str(err.value)\n288. \n289. \n290. def test_join(table_types):\n291.     """\n292.     Join tables with mixin cols.  Use column "i" as proxy for what the\n293.     result should be for each mixin.\n294.     """\n295.     t1 = table_types.Table()\n296.     t1[\'a\'] = table_types.Column([\'a\', \'b\', \'b\', \'c\'])\n297.     t1[\'i\'] = table_types.Column([0, 1, 2, 3])\n298.     for name, col in MIXIN_COLS.items():\n299.         t1[name] = col\n300. \n301.     t2 = table_types.Table(t1)\n302.     t2[\'a\'] = [\'b\', \'c\', \'a\', \'d\']\n303. \n304.     for name, col in MIXIN_COLS.items():\n305.         t1[name].info.description = name\n306.         t2[name].info.description = name + \'2\'\n307. \n308.     for join_type in (\'inner\', \'left\'):\n309.         t12 = join(t1, t2, keys=\'a\', join_type=join_type)\n310.         idx1 = t12[\'i_1\']\n311.         idx2 = t12[\'i_2\']\n312.         for name, col in MIXIN_COLS.items():\n313.             name1 = name + \'_1\'\n314.             name2 = name + \'_2\'\n315.             assert_table_name_col_equal(t12, name1, col[idx1])\n316.             assert_table_name_col_equal(t12, name2, col[idx2])\n317.             assert t12[name1].info.description == name\n318.             assert t12[name2].info.description == name + \'2\'\n319. \n320.     for join_type in (\'outer\', \'right\'):\n321.         with pytest.raises(NotImplementedError) as exc:\n322.             t12 = join(t1, t2, keys=\'a\', join_type=join_type)\n323.         assert \'join requires masking column\' in str(exc.value)\n324. \n325.     with pytest.raises(TypeError) as exc:\n326.         t12 = join(t1, t2, keys=[\'a\', \'skycoord\'])\n327.     assert \'one or more key columns are not sortable\' in str(exc.value)\n328. \n329.     # Join does work for a mixin which is a subclass of np.ndarray\n330.     with pytest.warns(MergeConflictWarning,\n331.                       match="In merged column \'quantity\' the \'description\' "\n332.                             "attribute does not match"):\n333.         t12 = join(t1, t2, keys=[\'quantity\'])\n334.     assert np.all(t12[\'a_1\'] == t1[\'a\'])\n335. \n336. \n337. def test_hstack(table_types):\n338.     """\n339.     Hstack tables with mixin cols.  Use column "i" as proxy for what the\n340.     result should be for each mixin.\n341.     """\n342.     t1 = table_types.Table()\n343.     t1[\'i\'] = table_types.Column([0, 1, 2, 3])\n344.     for name, col in MIXIN_COLS.items():\n345.         t1[name] = col\n346.         t1[name].info.description = name\n347.         t1[name].info.meta = {\'a\': 1}\n348. \n349.     for join_type in (\'inner\', \'outer\'):\n350.         for chop in (True, False):\n351.             t2 = table_types.Table(t1)\n352.             if chop:\n353.                 t2 = t2[:-1]\n354.                 if join_type == \'outer\':\n355.                     with pytest.raises(NotImplementedError) as exc:\n356.                         t12 = hstack([t1, t2], join_type=join_type)\n357.                     assert \'hstack requires masking column\' in str(exc.value)\n358.                     continue\n359. \n360.             t12 = hstack([t1, t2], join_type=join_type)\n361.             idx1 = t12[\'i_1\']\n362.             idx2 = t12[\'i_2\']\n363.             for name, col in MIXIN_COLS.items():\n364.                 name1 = name + \'_1\'\n365.                 name2 = name + \'_2\'\n366.                 assert_table_name_col_equal(t12, name1, col[idx1])\n367.                 assert_table_name_col_equal(t12, name2, col[idx2])\n368.                 for attr in (\'description\', \'meta\'):\n369.                     assert getattr(t1[name].info, attr) == getattr(t12[name1].info, attr)\n370.                     assert getattr(t2[name].info, attr) == getattr(t12[name2].info, attr)\n371. \n372. \n373. def assert_table_name_col_equal(t, name, col):\n374.     """\n375.     Assert all(t[name] == col), with special handling for known mixin cols.\n376.     """\n377.     if isinstance(col, coordinates.SkyCoord):\n378.         assert np.all(t[name].ra == col.ra)\n379.         assert np.all(t[name].dec == col.dec)\n380.     elif isinstance(col, coordinates.BaseRepresentationOrDifferential):\n381.         assert np.all(representation_equal(t[name], col))\n382.     elif isinstance(col, u.Quantity):\n383.         if type(t) is QTable:\n384.             assert np.all(t[name] == col)\n385.     elif isinstance(col, table_helpers.ArrayWrapper):\n386.         assert np.all(t[name].data == col.data)\n387.     else:\n388.         assert np.all(t[name] == col)\n389. \n390. \n391. def test_get_items(mixin_cols):\n392.     """\n393.     Test that slicing / indexing table gives right values and col attrs inherit\n394.     """\n395.     attrs = (\'name\', \'unit\', \'dtype\', \'format\', \'description\', \'meta\')\n396.     m = mixin_cols[\'m\']\n397.     m.info.name = \'m\'\n398.     m.info.format = \'{0}\'\n399.     m.info.description = \'d\'\n400.     m.info.meta = {\'a\': 1}\n401.     t = QTable([m])\n402.     for item in ([1, 3], np.array([0, 2]), slice(1, 3)):\n403.         t2 = t[item]\n404.         m2 = m[item]\n405.         assert_table_name_col_equal(t2, \'m\', m[item])\n406.         for attr in attrs:\n407.             assert getattr(t2[\'m\'].info, attr) == getattr(m.info, attr)\n408.             assert getattr(m2.info, attr) == getattr(m.info, attr)\n409. \n410. \n411. def test_info_preserved_pickle_copy_init(mixin_cols):\n412.     """\n413.     Test copy, pickle, and init from class roundtrip preserve info.  This\n414.     tests not only the mixin classes but a regular column as well.\n415.     """\n416.     def pickle_roundtrip(c):\n417.         return pickle.loads(pickle.dumps(c))\n418. \n419.     def init_from_class(c):\n420.         return c.__class__(c)\n421. \n422.     attrs = (\'name\', \'unit\', \'dtype\', \'format\', \'description\', \'meta\')\n423.     for colname in (\'i\', \'m\'):\n424.         m = mixin_cols[colname]\n425.         m.info.name = colname\n426.         m.info.format = \'{0}\'\n427.         m.info.description = \'d\'\n428.         m.info.meta = {\'a\': 1}\n429.         for func in (copy.copy, copy.deepcopy, pickle_roundtrip, init_from_class):\n430.             m2 = func(m)\n431.             for attr in attrs:\n432.                 # non-native byteorder not preserved by last 2 func, _except_ for structured dtype\n433.                 if (attr != \'dtype\'\n434.                         or getattr(m.info.dtype, \'isnative\', True)\n435.                         or m.info.dtype.name.startswith(\'void\')\n436.                         or func in (copy.copy, copy.deepcopy)):\n437.                     original = getattr(m.info, attr)\n438.                 else:\n439.                     # func does not preserve byteorder, check against (native) type.\n440.                     original = m.info.dtype.newbyteorder(\'=\')\n441.                 assert getattr(m2.info, attr) == original\n442. \n443. \n444. def test_add_column(mixin_cols):\n445.     """\n446.     Test that adding a column preserves values and attributes\n447.     """\n448.     attrs = (\'name\', \'unit\', \'dtype\', \'format\', \'description\', \'meta\')\n449.     m = mixin_cols[\'m\']\n450.     assert m.info.name is None\n451. \n452.     # Make sure adding column in various ways doesn\'t touch\n453.     t = QTable([m], names=[\'a\'])\n454.     assert m.info.name is None\n455. \n456.     t[\'new\'] = m\n457.     assert m.info.name is None\n458. \n459.     m.info.name = \'m\'\n460.     m.info.format = \'{0}\'\n461.     m.info.description = \'d\'\n462.     m.info.meta = {\'a\': 1}\n463.     t = QTable([m])\n464. \n465.     # Add columns m2, m3, m4 by two different methods and test expected equality\n466.     t[\'m2\'] = m\n467.     m.info.name = \'m3\'\n468.     t.add_columns([m], copy=True)\n469.     m.info.name = \'m4\'\n470.     t.add_columns([m], copy=False)\n471.     for name in (\'m2\', \'m3\', \'m4\'):\n472.         assert_table_name_col_equal(t, name, m)\n473.         for attr in attrs:\n474.             if attr != \'name\':\n475.                 assert getattr(t[\'m\'].info, attr) == getattr(t[name].info, attr)\n476.     # Also check that one can set using a scalar.\n477.     s = m[0]\n478.     if type(s) is type(m) and \'info\' in s.__dict__:\n479.         # We\'re not going to worry about testing classes for which scalars\n480.         # are a different class than the real array, or where info is not copied.\n481.         t[\'s\'] = m[0]\n482.         assert_table_name_col_equal(t, \'s\', m[0])\n483.         for attr in attrs:\n484.             if attr != \'name\':\n485.                 assert getattr(t[\'m\'].info, attr) == getattr(t[\'s\'].info, attr)\n486. \n487.     # While we\'re add it, also check a length-1 table.\n488.     t = QTable([m[1:2]], names=[\'m\'])\n489.     if type(s) is type(m) and \'info\' in s.__dict__:\n490.         t[\'s\'] = m[0]\n491.         assert_table_name_col_equal(t, \'s\', m[0])\n492.         for attr in attrs:\n493.             if attr != \'name\':\n494.                 assert getattr(t[\'m\'].info, attr) == getattr(t[\'s\'].info, attr)\n495. \n496. \n497. def test_vstack():\n498.     """\n499.     Vstack tables with mixin cols.\n500.     """\n501.     t1 = QTable(MIXIN_COLS)\n502.     t2 = QTable(MIXIN_COLS)\n503.     with pytest.raises(NotImplementedError):\n504.         vstack([t1, t2])\n505. \n506. \n507. def test_insert_row(mixin_cols):\n508.     """\n509.     Test inserting a row, which works for Column, Quantity, Time and SkyCoord.\n510.     """\n511.     t = QTable(mixin_cols)\n512.     t0 = t.copy()\n513.     t[\'m\'].info.description = \'d\'\n514.     idxs = [0, -1, 1, 2, 3]\n515.     if isinstance(t[\'m\'], (u.Quantity, Column, time.Time, time.TimeDelta, coordinates.SkyCoord)):\n516.         t.insert_row(1, t[-1])\n517. \n518.         for name in t.colnames:\n519.             col = t[name]\n520.             if isinstance(col, coordinates.SkyCoord):\n521.                 assert skycoord_equal(col, t0[name][idxs])\n522.             else:\n523.                 assert np.all(col == t0[name][idxs])\n524. \n525.         assert t[\'m\'].info.description == \'d\'\n526.     else:\n527.         with pytest.raises(ValueError) as exc:\n528.             t.insert_row(1, t[-1])\n529.         assert "Unable to insert row" in str(exc.value)\n530. \n531. \n532. def test_insert_row_bad_unit():\n533.     """\n534.     Insert a row into a QTable with the wrong unit\n535.     """\n536.     t = QTable([[1] * u.m])\n537.     with pytest.raises(ValueError) as exc:\n538.         t.insert_row(0, (2 * u.m / u.s,))\n539.     assert "\'m / s\' (speed/velocity) and \'m\' (length) are not convertible" in str(exc.value)\n540. \n541. \n542. def test_convert_np_array(mixin_cols):\n543.     """\n544.     Test that converting to numpy array creates an object dtype and that\n545.     each instance in the array has the expected type.\n546.     """\n547.     t = QTable(mixin_cols)\n548.     ta = t.as_array()\n549.     m = mixin_cols[\'m\']\n550.     dtype_kind = m.dtype.kind if hasattr(m, \'dtype\') else \'O\'\n551.     assert ta[\'m\'].dtype.kind == dtype_kind\n552. \n553. \n554. def test_assignment_and_copy():\n555.     """\n556.     Test that assignment of an int, slice, and fancy index works.\n557.     Along the way test that copying table works.\n558.     """\n559.     for name in (\'quantity\', \'arraywrap\'):\n560.         m = MIXIN_COLS[name]\n561.         t0 = QTable([m], names=[\'m\'])\n562.         for i0, i1 in ((1, 2),\n563.                        (slice(0, 2), slice(1, 3)),\n564.                        (np.array([1, 2]), np.array([2, 3]))):\n565.             t = t0.copy()\n566.             t[\'m\'][i0] = m[i1]\n567.             if name == \'arraywrap\':\n568.                 assert np.all(t[\'m\'].data[i0] == m.data[i1])\n569.                 assert np.all(t0[\'m\'].data[i0] == m.data[i0])\n570.                 assert np.all(t0[\'m\'].data[i0] != t[\'m\'].data[i0])\n571.             else:\n572.                 assert np.all(t[\'m\'][i0] == m[i1])\n573.                 assert np.all(t0[\'m\'][i0] == m[i0])\n574.                 assert np.all(t0[\'m\'][i0] != t[\'m\'][i0])\n575. \n576. \n577. def test_conversion_qtable_table():\n578.     """\n579.     Test that a table round trips from QTable => Table => QTable\n580.     """\n581.     qt = QTable(MIXIN_COLS)\n582.     names = qt.colnames\n583.     for name in names:\n584.         qt[name].info.description = name\n585. \n586.     t = Table(qt)\n587.     for name in names:\n588.         assert t[name].info.description == name\n589.         if name == \'quantity\':\n590.             assert np.all(t[\'quantity\'] == qt[\'quantity\'].value)\n591.             assert np.all(t[\'quantity\'].unit is qt[\'quantity\'].unit)\n592.             assert isinstance(t[\'quantity\'], t.ColumnClass)\n593.         else:\n594.             assert_table_name_col_equal(t, name, qt[name])\n595. \n596.     qt2 = QTable(qt)\n597.     for name in names:\n598.         assert qt2[name].info.description == name\n599.         assert_table_name_col_equal(qt2, name, qt[name])\n600. \n601. \n602. def test_setitem_as_column_name():\n603.     """\n604.     Test for mixin-related regression described in #3321.\n605.     """\n606.     t = Table()\n607.     t[\'a\'] = [\'x\', \'y\']\n608.     t[\'b\'] = \'b\'  # Previously was failing with KeyError\n609.     assert np.all(t[\'a\'] == [\'x\', \'y\'])\n610.     assert np.all(t[\'b\'] == [\'b\', \'b\'])\n611. \n612. \n613. def test_quantity_representation():\n614.     """\n615.     Test that table representation of quantities does not have unit\n616.     """\n617.     t = QTable([[1, 2] * u.m])\n618.     assert t.pformat() == [\'col0\',\n619.                            \' m  \',\n620.                            \'----\',\n621.                            \' 1.0\',\n622.                            \' 2.0\']\n623. \n624. \n625. def test_representation_representation():\n626.     """\n627.     Test that Representations are represented correctly.\n628.     """\n629.     # With no unit we get "None" in the unit row\n630.     c = coordinates.CartesianRepresentation([0], [1], [0], unit=u.one)\n631.     t = Table([c])\n632.     assert t.pformat() == [\'    col0    \',\n633.                            \'------------\',\n634.                            \'(0., 1., 0.)\']\n635. \n636.     c = coordinates.CartesianRepresentation([0], [1], [0], unit=\'m\')\n637.     t = Table([c])\n638.     assert t.pformat() == [\'    col0    \',\n639.                            \'     m      \',\n640.                            \'------------\',\n641.                            \'(0., 1., 0.)\']\n642. \n643.     c = coordinates.SphericalRepresentation([10]*u.deg, [20]*u.deg, [1]*u.pc)\n644.     t = Table([c])\n645.     assert t.pformat() == [\'     col0     \',\n646.                            \' deg, deg, pc \',\n647.                            \'--------------\',\n648.                            \'(10., 20., 1.)\']\n649. \n650.     c = coordinates.UnitSphericalRepresentation([10]*u.deg, [20]*u.deg)\n651.     t = Table([c])\n652.     assert t.pformat() == [\'   col0   \',\n653.                            \'   deg    \',\n654.                            \'----------\',\n655.                            \'(10., 20.)\']\n656. \n657.     c = coordinates.SphericalCosLatDifferential(\n658.         [10]*u.mas/u.yr, [2]*u.mas/u.yr, [10]*u.km/u.s)\n659.     t = Table([c])\n660.     assert t.pformat() == [\'           col0           \',\n661.                            \'mas / yr, mas / yr, km / s\',\n662.                            \'--------------------------\',\n663.                            \'            (10., 2., 10.)\']\n664. \n665. \n666. def test_skycoord_representation():\n667.     """\n668.     Test that skycoord representation works, both in the way that the\n669.     values are output and in changing the frame representation.\n670.     """\n671.     # With no unit we get "None" in the unit row\n672.     c = coordinates.SkyCoord([0], [1], [0], representation_type=\'cartesian\')\n673.     t = Table([c])\n674.     assert t.pformat() == [\'     col0     \',\n675.                            \'None,None,None\',\n676.                            \'--------------\',\n677.                            \'   0.0,1.0,0.0\']\n678. \n679.     # Test that info works with a dynamically changed representation\n680.     c = coordinates.SkyCoord([0], [1], [0], unit=\'m\', representation_type=\'cartesian\')\n681.     t = Table([c])\n682.     assert t.pformat() == [\'    col0   \',\n683.                            \'   m,m,m   \',\n684.                            \'-----------\',\n685.                            \'0.0,1.0,0.0\']\n686. \n687.     t[\'col0\'].representation_type = \'unitspherical\'\n688.     assert t.pformat() == [\'  col0  \',\n689.                            \'deg,deg \',\n690.                            \'--------\',\n691.                            \'90.0,0.0\']\n692. \n693.     t[\'col0\'].representation_type = \'cylindrical\'\n694.     assert t.pformat() == [\'    col0    \',\n695.                            \'  m,deg,m   \',\n696.                            \'------------\',\n697.                            \'1.0,90.0,0.0\']\n698. \n699. \n700. def test_ndarray_mixin():\n701.     """\n702.     Test directly adding a plain structured array into a table instead of the\n703.     view as an NdarrayMixin.  Once added as an NdarrayMixin then all the previous\n704.     tests apply.\n705.     """\n706.     a = np.array([(1, \'a\'), (2, \'b\'), (3, \'c\'), (4, \'d\')],\n707.                  dtype=\'<i4,\' + (\'|U1\'))\n708.     b = np.array([(10, \'aa\'), (20, \'bb\'), (30, \'cc\'), (40, \'dd\')],\n709.                  dtype=[(\'x\', \'i4\'), (\'y\', (\'U2\'))])\n710.     c = np.rec.fromrecords([(100., \'raa\'), (200., \'rbb\'), (300., \'rcc\'), (400., \'rdd\')],\n711.                            names=[\'rx\', \'ry\'])\n712.     d = np.arange(8, dtype=\'i8\').reshape(4, 2).view(NdarrayMixin)\n713. \n714.     # Add one during initialization and the next as a new column.\n715.     t = Table([a], names=[\'a\'])\n716.     t[\'b\'] = b\n717.     t[\'c\'] = c\n718.     t[\'d\'] = d\n719. \n720.     assert isinstance(t[\'a\'], NdarrayMixin)\n721. \n722.     assert t[\'a\'][1][1] == a[1][1]\n723.     assert t[\'a\'][2][0] == a[2][0]\n724. \n725.     assert t[1][\'a\'][1] == a[1][1]\n726.     assert t[2][\'a\'][0] == a[2][0]\n727. \n728.     assert isinstance(t[\'b\'], NdarrayMixin)\n729. \n730.     assert t[\'b\'][1][\'x\'] == b[1][\'x\']\n731.     assert t[\'b\'][1][\'y\'] == b[1][\'y\']\n732. \n733.     assert t[1][\'b\'][\'x\'] == b[1][\'x\']\n734.     assert t[1][\'b\'][\'y\'] == b[1][\'y\']\n735. \n736.     assert isinstance(t[\'c\'], NdarrayMixin)\n737. \n738.     assert t[\'c\'][1][\'rx\'] == c[1][\'rx\']\n739.     assert t[\'c\'][1][\'ry\'] == c[1][\'ry\']\n740. \n741.     assert t[1][\'c\'][\'rx\'] == c[1][\'rx\']\n742.     assert t[1][\'c\'][\'ry\'] == c[1][\'ry\']\n743. \n744.     assert isinstance(t[\'d\'], NdarrayMixin)\n745. \n746.     assert t[\'d\'][1][0] == d[1][0]\n747.     assert t[\'d\'][1][1] == d[1][1]\n748. \n749.     assert t[1][\'d\'][0] == d[1][0]\n750.     assert t[1][\'d\'][1] == d[1][1]\n751. \n752.     assert t.pformat(show_dtype=True) == [\n753.         \'  a [f0, f1]     b [x, y]      c [rx, ry]      d    \',\n754.         \'(int32, str1) (int32, str2) (float64, str3) int64[2]\',\n755.         \'------------- ------------- --------------- --------\',\n756.         "     (1, \'a\')    (10, \'aa\')   (100., \'raa\')   0 .. 1",\n757.         "     (2, \'b\')    (20, \'bb\')   (200., \'rbb\')   2 .. 3",\n758.         "     (3, \'c\')    (30, \'cc\')   (300., \'rcc\')   4 .. 5",\n759.         "     (4, \'d\')    (40, \'dd\')   (400., \'rdd\')   6 .. 7"]\n760. \n761. \n762. def test_possible_string_format_functions():\n763.     """\n764.     The QuantityInfo info class for Quantity implements a\n765.     possible_string_format_functions() method that overrides the\n766.     standard pprint._possible_string_format_functions() function.\n767.     Test this.\n768.     """\n769.     t = QTable([[1, 2] * u.m])\n770.     t[\'col0\'].info.format = \'%.3f\'\n771.     assert t.pformat() == [\' col0\',\n772.                            \'  m  \',\n773.                            \'-----\',\n774.                            \'1.000\',\n775.                            \'2.000\']\n776. \n777.     t[\'col0\'].info.format = \'hi {:.3f}\'\n778.     assert t.pformat() == [\'  col0  \',\n779.                            \'   m    \',\n780.                            \'--------\',\n781.                            \'hi 1.000\',\n782.                            \'hi 2.000\']\n783. \n784.     t[\'col0\'].info.format = \'.4f\'\n785.     assert t.pformat() == [\' col0 \',\n786.                            \'  m   \',\n787.                            \'------\',\n788.                            \'1.0000\',\n789.                            \'2.0000\']\n790. \n791. \n792. def test_rename_mixin_columns(mixin_cols):\n793.     """\n794.     Rename a mixin column.\n795.     """\n796.     t = QTable(mixin_cols)\n797.     tc = t.copy()\n798.     t.rename_column(\'m\', \'mm\')\n799.     assert t.colnames == [\'i\', \'a\', \'b\', \'mm\']\n800.     if isinstance(t[\'mm\'], table_helpers.ArrayWrapper):\n801.         assert np.all(t[\'mm\'].data == tc[\'m\'].data)\n802.     elif isinstance(t[\'mm\'], coordinates.SkyCoord):\n803.         assert np.all(t[\'mm\'].ra == tc[\'m\'].ra)\n804.         assert np.all(t[\'mm\'].dec == tc[\'m\'].dec)\n805.     elif isinstance(t[\'mm\'], coordinates.BaseRepresentationOrDifferential):\n806.         assert np.all(representation_equal(t[\'mm\'], tc[\'m\']))\n807.     else:\n808.         assert np.all(t[\'mm\'] == tc[\'m\'])\n809. \n810. \n811. def test_represent_mixins_as_columns_unit_fix():\n812.     """\n813.     If the unit is invalid for a column that gets serialized this would\n814.     cause an exception.  Fixed in #7481.\n815.     """\n816.     t = Table({\'a\': [1, 2]}, masked=True)\n817.     t[\'a\'].unit = \'not a valid unit\'\n818.     t[\'a\'].mask[1] = True\n819.     serialize.represent_mixins_as_columns(t)\n820. \n821. \n822. def test_primary_data_column_gets_description():\n823.     """\n824.     If the mixin defines a primary data column, that should get the\n825.     description, format, etc., so no __info__ should be needed.\n826.     """\n827.     t = QTable({\'a\': [1, 2] * u.m})\n828.     t[\'a\'].info.description = \'parrot\'\n829.     t[\'a\'].info.format = \'7.2f\'\n830.     tser = serialize.represent_mixins_as_columns(t)\n831.     assert \'__info__\' not in tser.meta[\'__serialized_columns__\'][\'a\']\n832.     assert tser[\'a\'].format == \'7.2f\'\n833.     assert tser[\'a\'].description == \'parrot\'\n834. \n835. \n836. def test_skycoord_with_velocity():\n837.     # Regression test for gh-6447\n838.     sc = SkyCoord([1], [2], unit=\'deg\', galcen_v_sun=None)\n839.     t = Table([sc])\n840.     s = StringIO()\n841.     t.write(s, format=\'ascii.ecsv\', overwrite=True)\n842.     s.seek(0)\n843.     t2 = Table.read(s.read(), format=\'ascii.ecsv\')\n844.     assert skycoord_equal(t2[\'col0\'], sc)\n845. \n846. \n847. @pytest.mark.parametrize(\'table_cls\', [Table, QTable])\n848. def test_ensure_input_info_is_unchanged(table_cls):\n849.     """If a mixin input to a table has no info, it should stay that way.\n850. \n851.     This since having \'info\' slows down slicing, etc.\n852.     See gh-11066.\n853.     """\n854.     q = [1, 2] * u.m\n855.     assert \'info\' not in q.__dict__\n856.     t = table_cls([q], names=[\'q\'])\n857.     assert \'info\' not in q.__dict__\n858.     t = table_cls([q])\n859.     assert \'info\' not in q.__dict__\n860.     t = table_cls({\'q\': q})\n861.     assert \'info\' not in q.__dict__\n862.     t[\'q2\'] = q\n863.     assert \'info\' not in q.__dict__\n864.     sc = SkyCoord([1, 2], [2, 3], unit=\'deg\')\n865.     t[\'sc\'] = sc\n866.     assert \'info\' not in sc.__dict__\n867. \n868. \n869. def test_bad_info_class():\n870.     """Make a mixin column class that does not trigger the machinery to generate\n871.     a pure column representation"""\n872.     class MyArrayWrapper(ArrayWrapper):\n873.         info = ParentDtypeInfo()\n874. \n875.     t = Table()\n876.     t[\'tm\'] = MyArrayWrapper([0, 1, 2])\n877.     out = StringIO()\n878.     match = r"failed to represent column \'tm\' \\(MyArrayWrapper\\) as one or more Column subclasses"\n879.     with pytest.raises(TypeError, match=match):\n880.         represent_mixins_as_columns(t)', start_line_number=1, end_line_number=880)]
2025-10-04 06:58:12,043 - thread-139911184823872.app.lang_graph.nodes.bug_reproducing_write_message_node - DEBUG - Sending message to BugReproducingWriteNode:
content='Issue title:\nConsider removing auto-transform of structured column into NdarrayMixin\n\nIssue description: \n<!-- This comments are hidden when you submit the issue,\nso you do not need to remove them! -->\n\n<!-- Please be sure to check out our contributing guidelines,\nhttps://github.com/astropy/astropy/blob/main/CONTRIBUTING.md .\nPlease be sure to check out our code of conduct,\nhttps://github.com/astropy/astropy/blob/main/CODE_OF_CONDUCT.md . -->\n\n<!-- Please have a search on our GitHub repository to see if a similar\nissue has already been posted.\nIf a similar issue is closed, have a quick look to see if you are satisfied\nby the resolution.\nIf not please go ahead and open an issue! -->\n\n### Description\n<!-- Provide a general description of the feature you would like. -->\n<!-- If you want to, you can suggest a draft design or API. -->\n<!-- This way we have a deeper discussion on the feature. -->\n\nCurrently if you add a structured `np.array` to a Table, it gets turned into an `NdarrayMixin` (via the code below). While this mostly works, I am not sure this is necessary or desirable any more after #12644. Basically the original rational for `NdarrayMixin` was that structured dtype `Column` didn\'t quite work, in particular for serialization. So we pushed that out to a mixin class which would signal to unified I/O that it might not be supported.\n\n```\n        # Structured ndarray gets viewed as a mixin unless already a valid\n        # mixin class\n        if (not isinstance(data, Column) and not data_is_mixin\n                and isinstance(data, np.ndarray) and len(data.dtype) > 1):\n            data = data.view(NdarrayMixin)\n            data_is_mixin = True\n```\n\nProposal:\n- Add a FutureWarning here telling the user to wrap `data` in `Column` and that in the future (5.2) the structured array will be added as a `Column`.\n- Change the behavior in 5.2 by removing this clause.\n\nThis is not critical for 5.1 but if we have the opportunity due to other (critical) bugfixes it might be nice to save 6 months in the change process.\n\ncc: @mhvk\n\nIssue comments:\n\n\nBug reproducing context:\nFile: astropy/table/tests/test_mixin.py\nLine number range: 1 - 880\nContent:\n1. # -*- coding: utf-8 -*-\n2. # Licensed under a 3-clause BSD style license - see LICENSE.rst\n3. \n4. \n5. import copy\n6. import pickle\n7. from io import StringIO\n8. \n9. import pytest\n10. import numpy as np\n11. \n12. from astropy.table.serialize import represent_mixins_as_columns\n13. from astropy.utils.data_info import ParentDtypeInfo\n14. from astropy.table.table_helpers import ArrayWrapper\n15. from astropy.coordinates import EarthLocation, SkyCoord\n16. from astropy.table import Table, QTable, join, hstack, vstack, Column, NdarrayMixin\n17. from astropy.table import serialize\n18. from astropy import time\n19. from astropy import coordinates\n20. from astropy import units as u\n21. from astropy.table.column import BaseColumn\n22. from astropy.table import table_helpers\n23. from astropy.utils.exceptions import AstropyUserWarning\n24. from astropy.utils.metadata import MergeConflictWarning\n25. from astropy.coordinates.tests.test_representation import representation_equal\n26. from astropy.coordinates.tests.helper import skycoord_equal\n27. \n28. from .conftest import MIXIN_COLS\n29. \n30. \n31. def test_attributes(mixin_cols):\n32.     """\n33.     Required attributes for a column can be set.\n34.     """\n35.     m = mixin_cols[\'m\']\n36.     m.info.name = \'a\'\n37.     assert m.info.name == \'a\'\n38. \n39.     m.info.description = \'a\'\n40.     assert m.info.description == \'a\'\n41. \n42.     # Cannot set unit for these classes\n43.     if isinstance(m, (u.Quantity, coordinates.SkyCoord, time.Time, time.TimeDelta,\n44.                       coordinates.BaseRepresentationOrDifferential)):\n45.         with pytest.raises(AttributeError):\n46.             m.info.unit = u.m\n47.     else:\n48.         m.info.unit = u.m\n49.         assert m.info.unit is u.m\n50. \n51.     m.info.format = \'a\'\n52.     assert m.info.format == \'a\'\n53. \n54.     m.info.meta = {\'a\': 1}\n55.     assert m.info.meta == {\'a\': 1}\n56. \n57.     with pytest.raises(AttributeError):\n58.         m.info.bad_attr = 1\n59. \n60.     with pytest.raises(AttributeError):\n61.         m.info.bad_attr\n62. \n63. \n64. def check_mixin_type(table, table_col, in_col):\n65.     # We check for QuantityInfo rather than just isinstance(col, u.Quantity)\n66.     # since we want to treat EarthLocation as a mixin, even though it is\n67.     # a Quantity subclass.\n68.     if ((isinstance(in_col.info, u.QuantityInfo) and type(table) is not QTable)\n69.             or isinstance(in_col, Column)):\n70.         assert type(table_col) is table.ColumnClass\n71.     else:\n72.         assert type(table_col) is type(in_col)\n73. \n74.     # Make sure in_col got copied and creating table did not touch it\n75.     assert in_col.info.name is None\n76. \n77. \n78. def test_make_table(table_types, mixin_cols):\n79.     """\n80.     Make a table with the columns in mixin_cols, which is an ordered dict of\n81.     three cols: \'a\' and \'b\' are table_types.Column type, and \'m\' is a mixin.\n82.     """\n83.     t = table_types.Table(mixin_cols)\n84.     check_mixin_type(t, t[\'m\'], mixin_cols[\'m\'])\n85. \n86.     cols = list(mixin_cols.values())\n87.     t = table_types.Table(cols, names=(\'i\', \'a\', \'b\', \'m\'))\n88.     check_mixin_type(t, t[\'m\'], mixin_cols[\'m\'])\n89. \n90.     t = table_types.Table(cols)\n91.     check_mixin_type(t, t[\'col3\'], mixin_cols[\'m\'])\n92. \n93. \n94. def test_io_ascii_write():\n95.     """\n96.     Test that table with mixin column can be written by io.ascii for\n97.     every pure Python writer.  No validation of the output is done,\n98.     this just confirms no exceptions.\n99.     """\n100.     from astropy.io.ascii.connect import _get_connectors_table\n101.     t = QTable(MIXIN_COLS)\n102.     for fmt in _get_connectors_table():\n103.         if fmt[\'Write\'] and \'.fast_\' not in fmt[\'Format\']:\n104.             out = StringIO()\n105.             t.write(out, format=fmt[\'Format\'])\n106. \n107. \n108. def test_votable_quantity_write(tmpdir):\n109.     """\n110.     Test that table with Quantity mixin column can be round-tripped by\n111.     io.votable.  Note that FITS and HDF5 mixin support are tested (much more\n112.     thoroughly) in their respective subpackage tests\n113.     (io/fits/tests/test_connect.py and io/misc/tests/test_hdf5.py).\n114.     """\n115.     t = QTable()\n116.     t[\'a\'] = u.Quantity([1, 2, 4], unit=\'nm\')\n117. \n118.     filename = str(tmpdir.join(\'table-tmp\'))\n119.     t.write(filename, format=\'votable\', overwrite=True)\n120.     qt = QTable.read(filename, format=\'votable\')\n121.     assert isinstance(qt[\'a\'], u.Quantity)\n122.     assert qt[\'a\'].unit == \'nm\'\n123. \n124. \n125. @pytest.mark.remote_data\n126. @pytest.mark.parametrize(\'table_types\', (Table, QTable))\n127. def test_io_time_write_fits_standard(tmpdir, table_types):\n128.     """\n129.     Test that table with Time mixin columns can be written by io.fits.\n130.     Validation of the output is done. Test that io.fits writes a table\n131.     containing Time mixin columns that can be partially round-tripped\n132.     (metadata scale, location).\n133. \n134.     Note that we postpone checking the "local" scale, since that cannot\n135.     be done with format \'cxcsec\', as it requires an epoch.\n136.     """\n137.     t = table_types([[1, 2], [\'string\', \'column\']])\n138.     for scale in time.STANDARD_TIME_SCALES:\n139.         t[\'a\' + scale] = time.Time([[1, 2], [3, 4]], format=\'cxcsec\',\n140.                                    scale=scale, location=EarthLocation(\n141.             -2446354, 4237210, 4077985, unit=\'m\'))\n142.         t[\'b\' + scale] = time.Time([\'1999-01-01T00:00:00.123456789\',\n143.                                     \'2010-01-01T00:00:00\'], scale=scale)\n144.     t[\'c\'] = [3., 4.]\n145. \n146.     filename = str(tmpdir.join(\'table-tmp\'))\n147. \n148.     # Show that FITS format succeeds\n149.     with pytest.warns(\n150.             AstropyUserWarning,\n151.             match=\'Time Column "btai" has no specified location, \'\n152.             \'but global Time Position is present\'):\n153.         t.write(filename, format=\'fits\', overwrite=True)\n154.     with pytest.warns(\n155.             AstropyUserWarning,\n156.             match=\'Time column reference position "TRPOSn" is not specified\'):\n157.         tm = table_types.read(filename, format=\'fits\', astropy_native=True)\n158. \n159.     for scale in time.STANDARD_TIME_SCALES:\n160.         for ab in (\'a\', \'b\'):\n161.             name = ab + scale\n162. \n163.             # Assert that the time columns are read as Time\n164.             assert isinstance(tm[name], time.Time)\n165. \n166.             # Assert that the scales round-trip\n167.             assert tm[name].scale == t[name].scale\n168. \n169.             # Assert that the format is jd\n170.             assert tm[name].format == \'jd\'\n171. \n172.             # Assert that the location round-trips\n173.             assert tm[name].location == t[name].location\n174. \n175.             # Finally assert that the column data round-trips\n176.             assert (tm[name] == t[name]).all()\n177. \n178.     for name in (\'col0\', \'col1\', \'c\'):\n179.         # Assert that the non-time columns are read as Column\n180.         assert isinstance(tm[name], Column)\n181. \n182.         # Assert that the non-time columns\' data round-trips\n183.         assert (tm[name] == t[name]).all()\n184. \n185.     # Test for conversion of time data to its value, as defined by its format\n186.     for scale in time.STANDARD_TIME_SCALES:\n187.         for ab in (\'a\', \'b\'):\n188.             name = ab + scale\n189.             t[name].info.serialize_method[\'fits\'] = \'formatted_value\'\n190. \n191.     t.write(filename, format=\'fits\', overwrite=True)\n192.     tm = table_types.read(filename, format=\'fits\')\n193. \n194.     for scale in time.STANDARD_TIME_SCALES:\n195.         for ab in (\'a\', \'b\'):\n196.             name = ab + scale\n197. \n198.             assert not isinstance(tm[name], time.Time)\n199.             assert (tm[name] == t[name].value).all()\n200. \n201. \n202. @pytest.mark.parametrize(\'table_types\', (Table, QTable))\n203. def test_io_time_write_fits_local(tmpdir, table_types):\n204.     """\n205.     Test that table with a Time mixin with scale local can also be written\n206.     by io.fits. Like ``test_io_time_write_fits_standard`` above, but avoiding\n207.     ``cxcsec`` format, which requires an epoch and thus cannot be used for a\n208.     local time scale.\n209.     """\n210.     t = table_types([[1, 2], [\'string\', \'column\']])\n211.     t[\'a_local\'] = time.Time([[50001, 50002], [50003, 50004]],\n212.                              format=\'mjd\', scale=\'local\',\n213.                              location=EarthLocation(-2446354, 4237210, 4077985,\n214.                                                     unit=\'m\'))\n215.     t[\'b_local\'] = time.Time([\'1999-01-01T00:00:00.123456789\',\n216.                               \'2010-01-01T00:00:00\'], scale=\'local\')\n217.     t[\'c\'] = [3., 4.]\n218. \n219.     filename = str(tmpdir.join(\'table-tmp\'))\n220. \n221.     # Show that FITS format succeeds\n222. \n223.     with pytest.warns(AstropyUserWarning,\n224.                       match=\'Time Column "b_local" has no specified location\'):\n225.         t.write(filename, format=\'fits\', overwrite=True)\n226. \n227.     with pytest.warns(AstropyUserWarning,\n228.                       match=\'Time column reference position "TRPOSn" is not specified.\'):\n229.         tm = table_types.read(filename, format=\'fits\', astropy_native=True)\n230. \n231.     for ab in (\'a\', \'b\'):\n232.         name = ab + \'_local\'\n233. \n234.         # Assert that the time columns are read as Time\n235.         assert isinstance(tm[name], time.Time)\n236. \n237.         # Assert that the scales round-trip\n238.         assert tm[name].scale == t[name].scale\n239. \n240.         # Assert that the format is jd\n241.         assert tm[name].format == \'jd\'\n242. \n243.         # Assert that the location round-trips\n244.         assert tm[name].location == t[name].location\n245. \n246.         # Finally assert that the column data round-trips\n247.         assert (tm[name] == t[name]).all()\n248. \n249.     for name in (\'col0\', \'col1\', \'c\'):\n250.         # Assert that the non-time columns are read as Column\n251.         assert isinstance(tm[name], Column)\n252. \n253.         # Assert that the non-time columns\' data round-trips\n254.         assert (tm[name] == t[name]).all()\n255. \n256.     # Test for conversion of time data to its value, as defined by its format.\n257.     for ab in (\'a\', \'b\'):\n258.         name = ab + \'_local\'\n259.         t[name].info.serialize_method[\'fits\'] = \'formatted_value\'\n260. \n261.     t.write(filename, format=\'fits\', overwrite=True)\n262.     tm = table_types.read(filename, format=\'fits\')\n263. \n264.     for ab in (\'a\', \'b\'):\n265.         name = ab + \'_local\'\n266. \n267.         assert not isinstance(tm[name], time.Time)\n268.         assert (tm[name] == t[name].value).all()\n269. \n270. \n271. def test_votable_mixin_write_fail(mixin_cols):\n272.     """\n273.     Test that table with mixin columns (excluding Quantity) cannot be written by\n274.     io.votable.\n275.     """\n276.     t = QTable(mixin_cols)\n277.     # Only do this test if there are unsupported column types (i.e. anything besides\n278.     # BaseColumn and Quantity class instances).\n279.     unsupported_cols = t.columns.not_isinstance((BaseColumn, u.Quantity))\n280. \n281.     if not unsupported_cols:\n282.         pytest.skip("no unsupported column types")\n283. \n284.     out = StringIO()\n285.     with pytest.raises(ValueError) as err:\n286.         t.write(out, format=\'votable\')\n287.     assert \'cannot write table with mixin column(s)\' in str(err.value)\n288. \n289. \n290. def test_join(table_types):\n291.     """\n292.     Join tables with mixin cols.  Use column "i" as proxy for what the\n293.     result should be for each mixin.\n294.     """\n295.     t1 = table_types.Table()\n296.     t1[\'a\'] = table_types.Column([\'a\', \'b\', \'b\', \'c\'])\n297.     t1[\'i\'] = table_types.Column([0, 1, 2, 3])\n298.     for name, col in MIXIN_COLS.items():\n299.         t1[name] = col\n300. \n301.     t2 = table_types.Table(t1)\n302.     t2[\'a\'] = [\'b\', \'c\', \'a\', \'d\']\n303. \n304.     for name, col in MIXIN_COLS.items():\n305.         t1[name].info.description = name\n306.         t2[name].info.description = name + \'2\'\n307. \n308.     for join_type in (\'inner\', \'left\'):\n309.         t12 = join(t1, t2, keys=\'a\', join_type=join_type)\n310.         idx1 = t12[\'i_1\']\n311.         idx2 = t12[\'i_2\']\n312.         for name, col in MIXIN_COLS.items():\n313.             name1 = name + \'_1\'\n314.             name2 = name + \'_2\'\n315.             assert_table_name_col_equal(t12, name1, col[idx1])\n316.             assert_table_name_col_equal(t12, name2, col[idx2])\n317.             assert t12[name1].info.description == name\n318.             assert t12[name2].info.description == name + \'2\'\n319. \n320.     for join_type in (\'outer\', \'right\'):\n321.         with pytest.raises(NotImplementedError) as exc:\n322.             t12 = join(t1, t2, keys=\'a\', join_type=join_type)\n323.         assert \'join requires masking column\' in str(exc.value)\n324. \n325.     with pytest.raises(TypeError) as exc:\n326.         t12 = join(t1, t2, keys=[\'a\', \'skycoord\'])\n327.     assert \'one or more key columns are not sortable\' in str(exc.value)\n328. \n329.     # Join does work for a mixin which is a subclass of np.ndarray\n330.     with pytest.warns(MergeConflictWarning,\n331.                       match="In merged column \'quantity\' the \'description\' "\n332.                             "attribute does not match"):\n333.         t12 = join(t1, t2, keys=[\'quantity\'])\n334.     assert np.all(t12[\'a_1\'] == t1[\'a\'])\n335. \n336. \n337. def test_hstack(table_types):\n338.     """\n339.     Hstack tables with mixin cols.  Use column "i" as proxy for what the\n340.     result should be for each mixin.\n341.     """\n342.     t1 = table_types.Table()\n343.     t1[\'i\'] = table_types.Column([0, 1, 2, 3])\n344.     for name, col in MIXIN_COLS.items():\n345.         t1[name] = col\n346.         t1[name].info.description = name\n347.         t1[name].info.meta = {\'a\': 1}\n348. \n349.     for join_type in (\'inner\', \'outer\'):\n350.         for chop in (True, False):\n351.             t2 = table_types.Table(t1)\n352.             if chop:\n353.                 t2 = t2[:-1]\n354.                 if join_type == \'outer\':\n355.                     with pytest.raises(NotImplementedError) as exc:\n356.                         t12 = hstack([t1, t2], join_type=join_type)\n357.                     assert \'hstack requires masking column\' in str(exc.value)\n358.                     continue\n359. \n360.             t12 = hstack([t1, t2], join_type=join_type)\n361.             idx1 = t12[\'i_1\']\n362.             idx2 = t12[\'i_2\']\n363.             for name, col in MIXIN_COLS.items():\n364.                 name1 = name + \'_1\'\n365.                 name2 = name + \'_2\'\n366.                 assert_table_name_col_equal(t12, name1, col[idx1])\n367.                 assert_table_name_col_equal(t12, name2, col[idx2])\n368.                 for attr in (\'description\', \'meta\'):\n369.                     assert getattr(t1[name].info, attr) == getattr(t12[name1].info, attr)\n370.                     assert getattr(t2[name].info, attr) == getattr(t12[name2].info, attr)\n371. \n372. \n373. def assert_table_name_col_equal(t, name, col):\n374.     """\n375.     Assert all(t[name] == col), with special handling for known mixin cols.\n376.     """\n377.     if isinstance(col, coordinates.SkyCoord):\n378.         assert np.all(t[name].ra == col.ra)\n379.         assert np.all(t[name].dec == col.dec)\n380.     elif isinstance(col, coordinates.BaseRepresentationOrDifferential):\n381.         assert np.all(representation_equal(t[name], col))\n382.     elif isinstance(col, u.Quantity):\n383.         if type(t) is QTable:\n384.             assert np.all(t[name] == col)\n385.     elif isinstance(col, table_helpers.ArrayWrapper):\n386.         assert np.all(t[name].data == col.data)\n387.     else:\n388.         assert np.all(t[name] == col)\n389. \n390. \n391. def test_get_items(mixin_cols):\n392.     """\n393.     Test that slicing / indexing table gives right values and col attrs inherit\n394.     """\n395.     attrs = (\'name\', \'unit\', \'dtype\', \'format\', \'description\', \'meta\')\n396.     m = mixin_cols[\'m\']\n397.     m.info.name = \'m\'\n398.     m.info.format = \'{0}\'\n399.     m.info.description = \'d\'\n400.     m.info.meta = {\'a\': 1}\n401.     t = QTable([m])\n402.     for item in ([1, 3], np.array([0, 2]), slice(1, 3)):\n403.         t2 = t[item]\n404.         m2 = m[item]\n405.         assert_table_name_col_equal(t2, \'m\', m[item])\n406.         for attr in attrs:\n407.             assert getattr(t2[\'m\'].info, attr) == getattr(m.info, attr)\n408.             assert getattr(m2.info, attr) == getattr(m.info, attr)\n409. \n410. \n411. def test_info_preserved_pickle_copy_init(mixin_cols):\n412.     """\n413.     Test copy, pickle, and init from class roundtrip preserve info.  This\n414.     tests not only the mixin classes but a regular column as well.\n415.     """\n416.     def pickle_roundtrip(c):\n417.         return pickle.loads(pickle.dumps(c))\n418. \n419.     def init_from_class(c):\n420.         return c.__class__(c)\n421. \n422.     attrs = (\'name\', \'unit\', \'dtype\', \'format\', \'description\', \'meta\')\n423.     for colname in (\'i\', \'m\'):\n424.         m = mixin_cols[colname]\n425.         m.info.name = colname\n426.         m.info.format = \'{0}\'\n427.         m.info.description = \'d\'\n428.         m.info.meta = {\'a\': 1}\n429.         for func in (copy.copy, copy.deepcopy, pickle_roundtrip, init_from_class):\n430.             m2 = func(m)\n431.             for attr in attrs:\n432.                 # non-native byteorder not preserved by last 2 func, _except_ for structured dtype\n433.                 if (attr != \'dtype\'\n434.                         or getattr(m.info.dtype, \'isnative\', True)\n435.                         or m.info.dtype.name.startswith(\'void\')\n436.                         or func in (copy.copy, copy.deepcopy)):\n437.                     original = getattr(m.info, attr)\n438.                 else:\n439.                     # func does not preserve byteorder, check against (native) type.\n440.                     original = m.info.dtype.newbyteorder(\'=\')\n441.                 assert getattr(m2.info, attr) == original\n442. \n443. \n444. def test_add_column(mixin_cols):\n445.     """\n446.     Test that adding a column preserves values and attributes\n447.     """\n448.     attrs = (\'name\', \'unit\', \'dtype\', \'format\', \'description\', \'meta\')\n449.     m = mixin_cols[\'m\']\n450.     assert m.info.name is None\n451. \n452.     # Make sure adding column in various ways doesn\'t touch\n453.     t = QTable([m], names=[\'a\'])\n454.     assert m.info.name is None\n455. \n456.     t[\'new\'] = m\n457.     assert m.info.name is None\n458. \n459.     m.info.name = \'m\'\n460.     m.info.format = \'{0}\'\n461.     m.info.description = \'d\'\n462.     m.info.meta = {\'a\': 1}\n463.     t = QTable([m])\n464. \n465.     # Add columns m2, m3, m4 by two different methods and test expected equality\n466.     t[\'m2\'] = m\n467.     m.info.name = \'m3\'\n468.     t.add_columns([m], copy=True)\n469.     m.info.name = \'m4\'\n470.     t.add_columns([m], copy=False)\n471.     for name in (\'m2\', \'m3\', \'m4\'):\n472.         assert_table_name_col_equal(t, name, m)\n473.         for attr in attrs:\n474.             if attr != \'name\':\n475.                 assert getattr(t[\'m\'].info, attr) == getattr(t[name].info, attr)\n476.     # Also check that one can set using a scalar.\n477.     s = m[0]\n478.     if type(s) is type(m) and \'info\' in s.__dict__:\n479.         # We\'re not going to worry about testing classes for which scalars\n480.         # are a different class than the real array, or where info is not copied.\n481.         t[\'s\'] = m[0]\n482.         assert_table_name_col_equal(t, \'s\', m[0])\n483.         for attr in attrs:\n484.             if attr != \'name\':\n485.                 assert getattr(t[\'m\'].info, attr) == getattr(t[\'s\'].info, attr)\n486. \n487.     # While we\'re add it, also check a length-1 table.\n488.     t = QTable([m[1:2]], names=[\'m\'])\n489.     if type(s) is type(m) and \'info\' in s.__dict__:\n490.         t[\'s\'] = m[0]\n491.         assert_table_name_col_equal(t, \'s\', m[0])\n492.         for attr in attrs:\n493.             if attr != \'name\':\n494.                 assert getattr(t[\'m\'].info, attr) == getattr(t[\'s\'].info, attr)\n495. \n496. \n497. def test_vstack():\n498.     """\n499.     Vstack tables with mixin cols.\n500.     """\n501.     t1 = QTable(MIXIN_COLS)\n502.     t2 = QTable(MIXIN_COLS)\n503.     with pytest.raises(NotImplementedError):\n504.         vstack([t1, t2])\n505. \n506. \n507. def test_insert_row(mixin_cols):\n508.     """\n509.     Test inserting a row, which works for Column, Quantity, Time and SkyCoord.\n510.     """\n511.     t = QTable(mixin_cols)\n512.     t0 = t.copy()\n513.     t[\'m\'].info.description = \'d\'\n514.     idxs = [0, -1, 1, 2, 3]\n515.     if isinstance(t[\'m\'], (u.Quantity, Column, time.Time, time.TimeDelta, coordinates.SkyCoord)):\n516.         t.insert_row(1, t[-1])\n517. \n518.         for name in t.colnames:\n519.             col = t[name]\n520.             if isinstance(col, coordinates.SkyCoord):\n521.                 assert skycoord_equal(col, t0[name][idxs])\n522.             else:\n523.                 assert np.all(col == t0[name][idxs])\n524. \n525.         assert t[\'m\'].info.description == \'d\'\n526.     else:\n527.         with pytest.raises(ValueError) as exc:\n528.             t.insert_row(1, t[-1])\n529.         assert "Unable to insert row" in str(exc.value)\n530. \n531. \n532. def test_insert_row_bad_unit():\n533.     """\n534.     Insert a row into a QTable with the wrong unit\n535.     """\n536.     t = QTable([[1] * u.m])\n537.     with pytest.raises(ValueError) as exc:\n538.         t.insert_row(0, (2 * u.m / u.s,))\n539.     assert "\'m / s\' (speed/velocity) and \'m\' (length) are not convertible" in str(exc.value)\n540. \n541. \n542. def test_convert_np_array(mixin_cols):\n543.     """\n544.     Test that converting to numpy array creates an object dtype and that\n545.     each instance in the array has the expected type.\n546.     """\n547.     t = QTable(mixin_cols)\n548.     ta = t.as_array()\n549.     m = mixin_cols[\'m\']\n550.     dtype_kind = m.dtype.kind if hasattr(m, \'dtype\') else \'O\'\n551.     assert ta[\'m\'].dtype.kind == dtype_kind\n552. \n553. \n554. def test_assignment_and_copy():\n555.     """\n556.     Test that assignment of an int, slice, and fancy index works.\n557.     Along the way test that copying table works.\n558.     """\n559.     for name in (\'quantity\', \'arraywrap\'):\n560.         m = MIXIN_COLS[name]\n561.         t0 = QTable([m], names=[\'m\'])\n562.         for i0, i1 in ((1, 2),\n563.                        (slice(0, 2), slice(1, 3)),\n564.                        (np.array([1, 2]), np.array([2, 3]))):\n565.             t = t0.copy()\n566.             t[\'m\'][i0] = m[i1]\n567.             if name == \'arraywrap\':\n568.                 assert np.all(t[\'m\'].data[i0] == m.data[i1])\n569.                 assert np.all(t0[\'m\'].data[i0] == m.data[i0])\n570.                 assert np.all(t0[\'m\'].data[i0] != t[\'m\'].data[i0])\n571.             else:\n572.                 assert np.all(t[\'m\'][i0] == m[i1])\n573.                 assert np.all(t0[\'m\'][i0] == m[i0])\n574.                 assert np.all(t0[\'m\'][i0] != t[\'m\'][i0])\n575. \n576. \n577. def test_conversion_qtable_table():\n578.     """\n579.     Test that a table round trips from QTable => Table => QTable\n580.     """\n581.     qt = QTable(MIXIN_COLS)\n582.     names = qt.colnames\n583.     for name in names:\n584.         qt[name].info.description = name\n585. \n586.     t = Table(qt)\n587.     for name in names:\n588.         assert t[name].info.description == name\n589.         if name == \'quantity\':\n590.             assert np.all(t[\'quantity\'] == qt[\'quantity\'].value)\n591.             assert np.all(t[\'quantity\'].unit is qt[\'quantity\'].unit)\n592.             assert isinstance(t[\'quantity\'], t.ColumnClass)\n593.         else:\n594.             assert_table_name_col_equal(t, name, qt[name])\n595. \n596.     qt2 = QTable(qt)\n597.     for name in names:\n598.         assert qt2[name].info.description == name\n599.         assert_table_name_col_equal(qt2, name, qt[name])\n600. \n601. \n602. def test_setitem_as_column_name():\n603.     """\n604.     Test for mixin-related regression described in #3321.\n605.     """\n606.     t = Table()\n607.     t[\'a\'] = [\'x\', \'y\']\n608.     t[\'b\'] = \'b\'  # Previously was failing with KeyError\n609.     assert np.all(t[\'a\'] == [\'x\', \'y\'])\n610.     assert np.all(t[\'b\'] == [\'b\', \'b\'])\n611. \n612. \n613. def test_quantity_representation():\n614.     """\n615.     Test that table representation of quantities does not have unit\n616.     """\n617.     t = QTable([[1, 2] * u.m])\n618.     assert t.pformat() == [\'col0\',\n619.                            \' m  \',\n620.                            \'----\',\n621.                            \' 1.0\',\n622.                            \' 2.0\']\n623. \n624. \n625. def test_representation_representation():\n626.     """\n627.     Test that Representations are represented correctly.\n628.     """\n629.     # With no unit we get "None" in the unit row\n630.     c = coordinates.CartesianRepresentation([0], [1], [0], unit=u.one)\n631.     t = Table([c])\n632.     assert t.pformat() == [\'    col0    \',\n633.                            \'------------\',\n634.                            \'(0., 1., 0.)\']\n635. \n636.     c = coordinates.CartesianRepresentation([0], [1], [0], unit=\'m\')\n637.     t = Table([c])\n638.     assert t.pformat() == [\'    col0    \',\n639.                            \'     m      \',\n640.                            \'------------\',\n641.                            \'(0., 1., 0.)\']\n642. \n643.     c = coordinates.SphericalRepresentation([10]*u.deg, [20]*u.deg, [1]*u.pc)\n644.     t = Table([c])\n645.     assert t.pformat() == [\'     col0     \',\n646.                            \' deg, deg, pc \',\n647.                            \'--------------\',\n648.                            \'(10., 20., 1.)\']\n649. \n650.     c = coordinates.UnitSphericalRepresentation([10]*u.deg, [20]*u.deg)\n651.     t = Table([c])\n652.     assert t.pformat() == [\'   col0   \',\n653.                            \'   deg    \',\n654.                            \'----------\',\n655.                            \'(10., 20.)\']\n656. \n657.     c = coordinates.SphericalCosLatDifferential(\n658.         [10]*u.mas/u.yr, [2]*u.mas/u.yr, [10]*u.km/u.s)\n659.     t = Table([c])\n660.     assert t.pformat() == [\'           col0           \',\n661.                            \'mas / yr, mas / yr, km / s\',\n662.                            \'--------------------------\',\n663.                            \'            (10., 2., 10.)\']\n664. \n665. \n666. def test_skycoord_representation():\n667.     """\n668.     Test that skycoord representation works, both in the way that the\n669.     values are output and in changing the frame representation.\n670.     """\n671.     # With no unit we get "None" in the unit row\n672.     c = coordinates.SkyCoord([0], [1], [0], representation_type=\'cartesian\')\n673.     t = Table([c])\n674.     assert t.pformat() == [\'     col0     \',\n675.                            \'None,None,None\',\n676.                            \'--------------\',\n677.                            \'   0.0,1.0,0.0\']\n678. \n679.     # Test that info works with a dynamically changed representation\n680.     c = coordinates.SkyCoord([0], [1], [0], unit=\'m\', representation_type=\'cartesian\')\n681.     t = Table([c])\n682.     assert t.pformat() == [\'    col0   \',\n683.                            \'   m,m,m   \',\n684.                            \'-----------\',\n685.                            \'0.0,1.0,0.0\']\n686. \n687.     t[\'col0\'].representation_type = \'unitspherical\'\n688.     assert t.pformat() == [\'  col0  \',\n689.                            \'deg,deg \',\n690.                            \'--------\',\n691.                            \'90.0,0.0\']\n692. \n693.     t[\'col0\'].representation_type = \'cylindrical\'\n694.     assert t.pformat() == [\'    col0    \',\n695.                            \'  m,deg,m   \',\n696.                            \'------------\',\n697.                            \'1.0,90.0,0.0\']\n698. \n699. \n700. def test_ndarray_mixin():\n701.     """\n702.     Test directly adding a plain structured array into a table instead of the\n703.     view as an NdarrayMixin.  Once added as an NdarrayMixin then all the previous\n704.     tests apply.\n705.     """\n706.     a = np.array([(1, \'a\'), (2, \'b\'), (3, \'c\'), (4, \'d\')],\n707.                  dtype=\'<i4,\' + (\'|U1\'))\n708.     b = np.array([(10, \'aa\'), (20, \'bb\'), (30, \'cc\'), (40, \'dd\')],\n709.                  dtype=[(\'x\', \'i4\'), (\'y\', (\'U2\'))])\n710.     c = np.rec.fromrecords([(100., \'raa\'), (200., \'rbb\'), (300., \'rcc\'), (400., \'rdd\')],\n711.                            names=[\'rx\', \'ry\'])\n712.     d = np.arange(8, dtype=\'i8\').reshape(4, 2).view(NdarrayMixin)\n713. \n714.     # Add one during initialization and the next as a new column.\n715.     t = Table([a], names=[\'a\'])\n716.     t[\'b\'] = b\n717.     t[\'c\'] = c\n718.     t[\'d\'] = d\n719. \n720.     assert isinstance(t[\'a\'], NdarrayMixin)\n721. \n722.     assert t[\'a\'][1][1] == a[1][1]\n723.     assert t[\'a\'][2][0] == a[2][0]\n724. \n725.     assert t[1][\'a\'][1] == a[1][1]\n726.     assert t[2][\'a\'][0] == a[2][0]\n727. \n728.     assert isinstance(t[\'b\'], NdarrayMixin)\n729. \n730.     assert t[\'b\'][1][\'x\'] == b[1][\'x\']\n731.     assert t[\'b\'][1][\'y\'] == b[1][\'y\']\n732. \n733.     assert t[1][\'b\'][\'x\'] == b[1][\'x\']\n734.     assert t[1][\'b\'][\'y\'] == b[1][\'y\']\n735. \n736.     assert isinstance(t[\'c\'], NdarrayMixin)\n737. \n738.     assert t[\'c\'][1][\'rx\'] == c[1][\'rx\']\n739.     assert t[\'c\'][1][\'ry\'] == c[1][\'ry\']\n740. \n741.     assert t[1][\'c\'][\'rx\'] == c[1][\'rx\']\n742.     assert t[1][\'c\'][\'ry\'] == c[1][\'ry\']\n743. \n744.     assert isinstance(t[\'d\'], NdarrayMixin)\n745. \n746.     assert t[\'d\'][1][0] == d[1][0]\n747.     assert t[\'d\'][1][1] == d[1][1]\n748. \n749.     assert t[1][\'d\'][0] == d[1][0]\n750.     assert t[1][\'d\'][1] == d[1][1]\n751. \n752.     assert t.pformat(show_dtype=True) == [\n753.         \'  a [f0, f1]     b [x, y]      c [rx, ry]      d    \',\n754.         \'(int32, str1) (int32, str2) (float64, str3) int64[2]\',\n755.         \'------------- ------------- --------------- --------\',\n756.         "     (1, \'a\')    (10, \'aa\')   (100., \'raa\')   0 .. 1",\n757.         "     (2, \'b\')    (20, \'bb\')   (200., \'rbb\')   2 .. 3",\n758.         "     (3, \'c\')    (30, \'cc\')   (300., \'rcc\')   4 .. 5",\n759.         "     (4, \'d\')    (40, \'dd\')   (400., \'rdd\')   6 .. 7"]\n760. \n761. \n762. def test_possible_string_format_functions():\n763.     """\n764.     The QuantityInfo info class for Quantity implements a\n765.     possible_string_format_functions() method that overrides the\n766.     standard pprint._possible_string_format_functions() function.\n767.     Test this.\n768.     """\n769.     t = QTable([[1, 2] * u.m])\n770.     t[\'col0\'].info.format = \'%.3f\'\n771.     assert t.pformat() == [\' col0\',\n772.                            \'  m  \',\n773.                            \'-----\',\n774.                            \'1.000\',\n775.                            \'2.000\']\n776. \n777.     t[\'col0\'].info.format = \'hi {:.3f}\'\n778.     assert t.pformat() == [\'  col0  \',\n779.                            \'   m    \',\n780.                            \'--------\',\n781.                            \'hi 1.000\',\n782.                            \'hi 2.000\']\n783. \n784.     t[\'col0\'].info.format = \'.4f\'\n785.     assert t.pformat() == [\' col0 \',\n786.                            \'  m   \',\n787.                            \'------\',\n788.                            \'1.0000\',\n789.                            \'2.0000\']\n790. \n791. \n792. def test_rename_mixin_columns(mixin_cols):\n793.     """\n794.     Rename a mixin column.\n795.     """\n796.     t = QTable(mixin_cols)\n797.     tc = t.copy()\n798.     t.rename_column(\'m\', \'mm\')\n799.     assert t.colnames == [\'i\', \'a\', \'b\', \'mm\']\n800.     if isinstance(t[\'mm\'], table_helpers.ArrayWrapper):\n801.         assert np.all(t[\'mm\'].data == tc[\'m\'].data)\n802.     elif isinstance(t[\'mm\'], coordinates.SkyCoord):\n803.         assert np.all(t[\'mm\'].ra == tc[\'m\'].ra)\n804.         assert np.all(t[\'mm\'].dec == tc[\'m\'].dec)\n805.     elif isinstance(t[\'mm\'], coordinates.BaseRepresentationOrDifferential):\n806.         assert np.all(representation_equal(t[\'mm\'], tc[\'m\']))\n807.     else:\n808.         assert np.all(t[\'mm\'] == tc[\'m\'])\n809. \n810. \n811. def test_represent_mixins_as_columns_unit_fix():\n812.     """\n813.     If the unit is invalid for a column that gets serialized this would\n814.     cause an exception.  Fixed in #7481.\n815.     """\n816.     t = Table({\'a\': [1, 2]}, masked=True)\n817.     t[\'a\'].unit = \'not a valid unit\'\n818.     t[\'a\'].mask[1] = True\n819.     serialize.represent_mixins_as_columns(t)\n820. \n821. \n822. def test_primary_data_column_gets_description():\n823.     """\n824.     If the mixin defines a primary data column, that should get the\n825.     description, format, etc., so no __info__ should be needed.\n826.     """\n827.     t = QTable({\'a\': [1, 2] * u.m})\n828.     t[\'a\'].info.description = \'parrot\'\n829.     t[\'a\'].info.format = \'7.2f\'\n830.     tser = serialize.represent_mixins_as_columns(t)\n831.     assert \'__info__\' not in tser.meta[\'__serialized_columns__\'][\'a\']\n832.     assert tser[\'a\'].format == \'7.2f\'\n833.     assert tser[\'a\'].description == \'parrot\'\n834. \n835. \n836. def test_skycoord_with_velocity():\n837.     # Regression test for gh-6447\n838.     sc = SkyCoord([1], [2], unit=\'deg\', galcen_v_sun=None)\n839.     t = Table([sc])\n840.     s = StringIO()\n841.     t.write(s, format=\'ascii.ecsv\', overwrite=True)\n842.     s.seek(0)\n843.     t2 = Table.read(s.read(), format=\'ascii.ecsv\')\n844.     assert skycoord_equal(t2[\'col0\'], sc)\n845. \n846. \n847. @pytest.mark.parametrize(\'table_cls\', [Table, QTable])\n848. def test_ensure_input_info_is_unchanged(table_cls):\n849.     """If a mixin input to a table has no info, it should stay that way.\n850. \n851.     This since having \'info\' slows down slicing, etc.\n852.     See gh-11066.\n853.     """\n854.     q = [1, 2] * u.m\n855.     assert \'info\' not in q.__dict__\n856.     t = table_cls([q], names=[\'q\'])\n857.     assert \'info\' not in q.__dict__\n858.     t = table_cls([q])\n859.     assert \'info\' not in q.__dict__\n860.     t = table_cls({\'q\': q})\n861.     assert \'info\' not in q.__dict__\n862.     t[\'q2\'] = q\n863.     assert \'info\' not in q.__dict__\n864.     sc = SkyCoord([1, 2], [2, 3], unit=\'deg\')\n865.     t[\'sc\'] = sc\n866.     assert \'info\' not in sc.__dict__\n867. \n868. \n869. def test_bad_info_class():\n870.     """Make a mixin column class that does not trigger the machinery to generate\n871.     a pure column representation"""\n872.     class MyArrayWrapper(ArrayWrapper):\n873.         info = ParentDtypeInfo()\n874. \n875.     t = Table()\n876.     t[\'tm\'] = MyArrayWrapper([0, 1, 2])\n877.     out = StringIO()\n878.     match = r"failed to represent column \'tm\' \\(MyArrayWrapper\\) as one or more Column subclasses"\n879.     with pytest.raises(TypeError, match=match):\n880.         represent_mixins_as_columns(t)\n\n\nNow generate the complete self-contained test case that reproduces the bug with the same error/exception.\n' additional_kwargs={} response_metadata={}
2025-10-04 06:59:06,709 - thread-139911184823872.app.lang_graph.nodes.bug_reproducing_write_node - DEBUG - content='```python\n# -*- coding: utf-8 -*-\n# Licensed under a 3-clause BSD style license - see LICENSE.rst\n\nimport numpy as np\nimport pytest\n\nfrom astropy.table import Column, NdarrayMixin, Table\n\n\ndef test_structured_array_becomes_column():\n    """\n    Test that a structured array added to a Table becomes a Column.\n\n    Currently, it is transformed into a bare NdarrayMixin instance, which\n    is a deprecated behavior. This test will fail until the deprecation\n    cycle is complete. See #13186.\n    """\n    structured_array = np.array([(1, \'a\'), (2, \'b\')],\n                                dtype=[(\'f0\', \'<i4\'), (\'f1\', \'<U1\')])\n\n    t = Table([structured_array], names=[\'a\'])\n\n    # This fails now, as type(t[\'a\']) is NdarrayMixin.\n    # It will pass when the auto-transform is removed and it becomes a Column.\n    assert type(t[\'a\']) is Column\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 531, 'end_index': 831, 'uri': 'https://github.com/davidrosspainter/TheAttentionAtlas', 'title': '', 'license_': ''}, {'start_index': 2405, 'end_index': 2733, 'uri': 'https://github.com/astropy/astropy', 'license_': 'BSD-3-Clause', 'title': ''}, {'start_index': 18901, 'end_index': 19880, 'uri': 'https://github.com/astropy/astropy', 'license_': 'BSD-3-Clause', 'title': ''}]}, 'usage_metadata': {'prompt_token_count': 14856, 'candidates_token_count': 235, 'total_token_count': 20720, 'prompt_tokens_details': [{'modality': 1, 'token_count': 14856}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 235}], 'thoughts_token_count': 5629, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -3.5847170565990694, 'model_name': 'gemini-2.5-pro'} id='run--828e860f-a7af-4088-b68d-86103b549eb4-0' usage_metadata={'input_tokens': 14856, 'output_tokens': 235, 'total_tokens': 20720, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 5629}}
2025-10-04 06:59:19,640 - thread-139911184823872.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'create_file', 'arguments': '{"content": "# -*- coding: utf-8 -*-\\n# Licensed under a 3-clause BSD style license - see LICENSE.rst\\n\\nimport numpy as np\\nimport pytest\\n\\nfrom astropy.table import Column, NdarrayMixin, Table\\n\\n\\ndef test_structured_array_becomes_column():\\n    \\"\\"\\"\\n    Test that a structured array added to a Table becomes a Column.\\n\\n    Currently, it is transformed into a bare NdarrayMixin instance, which\\n    is a deprecated behavior. This test will fail until the deprecation\\n    cycle is complete. See #13186.\\n    \\"\\"\\"\\n    structured_array = np.array([(1, \'a\'), (2, \'b\')],\\n                                dtype=[(\'f0\', \'<i4\'), (\'f1\', \'<U1\')])\\n\\n    t = Table([structured_array], names=[\'a\'])\\n\\n    # This fails now, as type(t[\'a\']) is NdarrayMixin.\\n    # It will pass when the auto-transform is removed and it becomes a Column.\\n    assert type(t[\'a\']) is Column\\n", "relative_path": "astropy/table/tests/test_structured_array.py"}'}, '__gemini_function_call_thought_signatures__': {'a48bafcf-af93-4297-a91f-d012627e6897': 'CoodAR/MhbZkbaWrfwZcB/Ddi7O/qobYP0LW8JLqcdMSUSMeUhBZfaN21DDHRX1HSYfjh+Jt41dhu1g5YuRBtHXxwXjdsmj4tIDDJ0VRxhYBdTPmVKzwTDpJvJwFQYly02AzxHpvmNIl8oR5o1CNlvi0WX6Hmfsgyd4th7dZVohoi0dKEnB36m9rp9slKjKOfw3ucAxm4HA1NpnEsp+RN/IMUgYudyTEXRVdY9cQJ+devbNF5pMH8+b2S0bZ8Xt5TpYvuFwoFJqe2K885HF042344+dg4sQkSERZ5t/doCHyjkYpLG+Y08z0ukZMHOpLJklfHb16SzkmbPiMKI1sa9HLUBPZamrdW5afGOkgABRR+88TnmRVmuq1UUqWkC2Y4FPk9tzs+EiCNnNy0+di2+/1LIGCLAGlLRGRjRcq5ZyIREgYu/JFGh2l28ayF0dvBJ2ZWBXFFP7WBC0LSOKN3QuNhKEF5STXlLNerhEQuFUgYrMYkoARDuonB0QAACdFyacaq7IzQaGm01sxw7Vd7jI+nklZ+hxQVlqqZ/Lw1JuDmUh69vL1Ke4tLEtRhMW08BFZJGzQyqWVICX03iFWUV0+eL+1ndft6bcxwocWlt5LThlJutfCDOaPZ7Qon9X4QisRG5faf5oEHIvvnmttOzcGazJ9MTzY3ax3ufht/TNZwwjmT7niSjlp9tkdJ3qb73ZQHjgRQRwXSRl5jHDb+d7dDQ2Whsu5HMxV3v57wMBSV7VjeVUU/p19xELG5SErdHSxepjQSL1YxJr1QH0XBjDNt8+GA0ocIz1U/juPhlW3BnP7pWwBhgOzHegMbcGPhVuUzQ5ih8mX2uiezlQzOPlm/jqA/iBU3HTYdci+ANOFdaL4DhKqKicKmvSANcCovQa8GOih8WKYBVBPupl6iUzlAUkf8Cj07RD6tSYftZce8gHLJshNxq22vmfUv0fNNIb0HzbzVRYfs3FsPnZWmUTcEbBHBhrzqITZ6j6F3v+vKwHK0GNnvPI2pv0WK6MZ9TbzFWHGOUOAuB5+q8cOavYbwi5Y69MHeY1ZY5cx1U2rGGqzzqd9Q5LWKh62kI23WoLFf1fzb5UsYCWJlcYVadzq8fzSF7CCuHy5htCInWSWb054WTJAGaRzkBtK2GwyGhOidovMKiox2ldcu0LYuLa5Hwm7BDhEX/g6PMf0hcAFMgKM/JBLDP+qgvJgKyJkeChLnIBWXI6mIlRxt1yuHp5uVKQg/yC3OLlCrcLWDIRnRvYaqBkJwQZSZjMzTgi77fCDDStJ6JwKn0cgoqJW5Ix4C5L/ptSZHG4lFcqx/fveRghB4B28g8O/Hhrr6p/HrPQiCrCLtPyXF92DjwBHAD57WpVYoEs1EHX1A9jz+fXGxOxrzhMokUo51cZs1IRRS3DOkrgVZoMCcNG4TI/MCFh5pZjvp7YsUz0IgCjItXmiXuQSGiRtk0pxhZax1uhIigkoxFyXSzZwY4wxm04Viqp9epuku6DrbDT5LToukh2yOsda9AdRx6l6gqz7QYz2AzYjc0Cyv7pB3hPYGmYVbINbeJCBr9JR5v+4yikcnzDNlKDiSlLYGxnuCa5gzoqI05onamDNtA1eeXE1e7PIzzL/86soZTdgsMh5ekdpBa4/QmVirZ/2isSEbgi8dW53lRIQEnIDdQCyqh6NxqgxNGuHHJMjzWJU44pE7cePInbBuAn7DfHm+0DH5Pw3tVUsi03Kl+m39YLIOF3ji32af0pP2kNsVl7THhW4844dUH9N/hrtX7xNV4XCYB+yYJ/KHPa44T977gdLbjUQK5OMCPqwhOWGT2eqhe+/RlCjPg3W7hlz/SY5749gb6wdn/gVkyHtsS7zUeVIcjdruj3Shma0qCkzgb4fwoS+d6eOIJ66YRNUdtUHKj7q8fi0QON36pnFxkKDC71h8UD7wFutbprmmXXbYAeySZqWDrHoqMLTKzyL2TvG0GMTeQX4jHqpBKjkyyzR71Pw1hmddgSst7CPPFH23Ymkv7K6hVGXu/AS0peGG3hrmlmyJ6fHiAXaG8r5DyrZ1nVKXodH4rn32rQ8J27XGNtB7EyFD9NrRxb05M3OX/5J+48PZNsMceMRdbYDL1RsDqWDgoNCc4tauwZXAuBxK6UadiqAX3wzsZx7hPpAvUWnJHmrNDLL1JaGbV20WCXVUtIEfai7yPa/9y3E2XKQMnow515oCAQ5EyjJtFhdSvMa2oTAFD0VukMwHoH1cTvZB2LUFyFAKpiVx5cAMYlW0+PYqTznlIKXDbWYQ7gKVhNjSOnC+q7MF1dyUr1JElyIWdpJlcTaM13dFciKpBE2dOcHdLoGa3hMr7hMjAzhx2weiaDDSUI7jfSIkGqmXY8JTPX/8bHuc71W/lLXAMof0LCOoYXuvC8RIjHS7km++JzUnffBorgRstdd/fccOGXxQyV1wiPncOM/Ia0+FSV4/v6WUIA6iwuQANQHp8/pgpR6ZisCCQ3fP8IAd5TqTkMT4MQ9qLADqv57EPNWHMwNFAjzK6WbWJNA2AsJ3wv+my6i1kVHZ2mHi3cEnkyU0YhbEcJSPgZH927+LbzNr8rAdY8vRdoN7Nwa2M6g4RB9dPCH/iN6Q8kvMDXMULPy1VCXHFci1GXmo/iNRPRES3wewO8/yjKsBBK2dJg8BYKIVZ1r5SeQxu1mvnUBZVfcaVOMtTePgT5cx9jwlvVsSIAUWZ4yZxyPWX2vZ9+g5gRlo6C5PW7O612jVnw2U5SJbDG0mLeNopR2ke8/NpjUBTou6WOKCfSO0P6KHcdfWphlDKj0HryszlMXCD+jAliF21eP8WDUcuIw42Q/pzg/SYyGVzhNS8tycHsNN8denwW5s9UmzBAMo6s5NOlJCKxlHlNnFaD3o3bcaOk1368VcPu6kaN7ZGolBkW2Y1wSLGf9E/5fTNQL5xfL3U+fvvSiv5A0ef3jbbdmrJ4bwODs7B8Eks3qn0CajbijwX7+wvwSmri4b4dcixqIs7vNJpq7D5qlo7ID6px8Ir0mvUHCeFJpvL+FnbsQmePTIWQwl+0esgJGQtRiKtGSf6pUveStjBRPwSe638UY0phvQ0YszjjRWM1MYnzzgvdz2Ro2i0C7QfVmAPJBqHythIyIws5snX0dQbY3ysVy/DVHFyNmwK3BHkBhEx0rf/g6ZSMO44f8qpy1Ui+ALsoAj2SLBAcNfHAgui/hG0W+C6tMTbNHOD5ehD+lXKfV37XBJoGftpn8JqVFlJjFVIN56ak8MUKPnD+dWLpNVWm6dc3jAMGIWrhkhxhyTumWLzX9Av7VVRyirIdtQxaaq6aLwBLSnm7oveUtx2NbajuclVJQ8wPgXByxDH6eCWJtIOix+HQPMBADepgFXqQEIW9ckWpn/QRJgr2IG9ptlnYzPAdwEM6FnmbZ2AfisZeh4Pzuj+uAPyp13ucbtW6qEuxdjtUb4GP+L3y0GBWSULl7cgP0V5QuEIYA7DX7oUWTsBtDhVIdvKHUHs0ksNepJXsBFFDoJU3RFqUlCeH+39Ye3vyu7HFAUb2ae1wfyjRG8zC3mpr1KZnKNJf1uZi10+YIgRyEygShdLm7IkfwL4bCTCDFz+n94ma2LEVvgVsjn66PMm8pQKeG62oP2jMXOI4V1drO6jF3SnD2SCXvhaT3/GPLp0yAnD8bSejhyXOwb9TmMGzH50UqoOV7Ck1jeC/5oOmnS3uvY2T8p762DPvGFBn3+bbhZP6Mjb4TASe+Rc096NrQSJXW1+ABJ7H+BWauDWTJ7z8/W7jIucgHFftzdJzoH8xRloR9yl06+HSS8UbVU6nhzxjx4gEMvScF/U3Zb7BtZn/HT9eSV2zN+70tI9eJIMbLQ58qDZAa5aHjyq2p8sBTnF0v4j0qYbdPdPm6u+OIbixSCkYWh3WX4nkbVoT9r2g1zRRlo/LHUbHakXO4rGpJfGWp9UjVqdSeEl2hFMlwkF8Sp2Dyfia40Kih66fwNbbT/HdW8Kjx1ArBVhvnvbfy/T+qa+bZMU3I1y44EBooFDN/QIW6Hx/b8SAnpOo14Nbvz2BWvoNuzCd8fTfwEOyvykpO6J44MhN8sbquVWWO379qRM9LBIm5C7f/RSdkTKbMNFDO89IotstOXPZiuHbLCD/f76h//nYNC3uRwo7nnGsZjnYK3+FhQ0wfZmS9RKXczS9PIvDF7gRs8/3iPtL0hq00vmnxBmmWoJNdFLJVXPvppmcVJBghlIudRHgT33375FKnvVt5sHJQxH/TW7Tf0HqcraOT3z9qglX14Jnn2XynFIr9skK+U2U82OPnrpBXYstPfeLS9B+Q85P9Gfpy+vys1ttCFkBa5fv9dBFFCmlfNI6y/601NmHgE6chu1nVTbYV/0Hw432u1KrQ5KrLmsd7eSiTMxEk6ZEYWydtNKC7qI4fGp+F70SXyFlnxkl4NOJsX1tklU2NM0Cnr0GSn830JIfuzdWdQ/VHjL4uT6XqUPGY2D/xzUe6W11wGmfT/aGBEVYZ66KzBIRLzQGHXLswaiI9tahr9B6OywhaeooY2ANcgXC4aBYnGA11tafsyPV5VL7GXtilwfCnUs+wq+PcMKRU646dTzZg03YuqM6NOQsw+0Zc045BcNGDgxNh10jEb1nzfuO0/qoh5gjMOmmUt6SKuhHEORB0sLKNpnvw5kJ812TnFsb/gAyq+ALoZSNrge9KVi9cffkqa91P9aJiciRHnbT5TCY2EdFq/FNP7xJBb9d0pk6a7e3BqWP1DSkEEzgltPexGbZvYX2EM6ByHQn/WXnXcr/uOkeZeD0c6ADO/z97/vu07yLqWWREYMvBcF8uj1sNnR3lDPune2hQM/tWezKym6N/e94eakMTm653zsRpAyTFLOCnluNyHTYDWVvsB25zKXon5Mmb8EBR2TX72LFG8m9vVgr6QbWnnaOKvSAOd9EkiGggEWCuKsymQYrqfcar/Lk='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 605, 'end_index': 1078, 'uri': 'https://github.com/3leeilwhan/SWP1_002', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 18837, 'candidates_token_count': 252, 'total_token_count': 20146, 'prompt_tokens_details': [{'modality': 1, 'token_count': 18837}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 252}], 'thoughts_token_count': 1057, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.6316834707108755, 'model_name': 'gemini-2.5-pro'} id='run--400a9d25-ef64-447d-abef-a59817517735-0' tool_calls=[{'name': 'create_file', 'args': {'content': '# -*- coding: utf-8 -*-\n# Licensed under a 3-clause BSD style license - see LICENSE.rst\n\nimport numpy as np\nimport pytest\n\nfrom astropy.table import Column, NdarrayMixin, Table\n\n\ndef test_structured_array_becomes_column():\n    """\n    Test that a structured array added to a Table becomes a Column.\n\n    Currently, it is transformed into a bare NdarrayMixin instance, which\n    is a deprecated behavior. This test will fail until the deprecation\n    cycle is complete. See #13186.\n    """\n    structured_array = np.array([(1, \'a\'), (2, \'b\')],\n                                dtype=[(\'f0\', \'<i4\'), (\'f1\', \'<U1\')])\n\n    t = Table([structured_array], names=[\'a\'])\n\n    # This fails now, as type(t[\'a\']) is NdarrayMixin.\n    # It will pass when the auto-transform is removed and it becomes a Column.\n    assert type(t[\'a\']) is Column\n', 'relative_path': 'astropy/table/tests/test_structured_array.py'}, 'id': 'a48bafcf-af93-4297-a91f-d012627e6897', 'type': 'tool_call'}] usage_metadata={'input_tokens': 18837, 'output_tokens': 252, 'total_tokens': 20146, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 1057}}
2025-10-04 06:59:20,598 - thread-139911184823872.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='astropy/table/tests/test_structured_array.py' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 19113, 'candidates_token_count': 14, 'total_token_count': 19127, 'cached_content_token_count': 17883, 'prompt_tokens_details': [{'modality': 1, 'token_count': 20168}], 'cache_tokens_details': [{'modality': 1, 'token_count': 17883}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 14}], 'thoughts_token_count': 0}, 'finish_reason': 'STOP', 'avg_logprobs': -4.411964826951069e-05, 'model_name': 'gemini-2.5-pro'} id='run--3d013738-af68-4b91-83d5-8cffc24a46bc-0' usage_metadata={'input_tokens': 19113, 'output_tokens': 14, 'total_tokens': 19127, 'input_token_details': {'cache_read': 17883}}
2025-10-04 06:59:20,690 - thread-139911184823872.app.lang_graph.nodes.git_diff_node - INFO - Generated patch:
diff --git a/astropy/table/tests/test_structured_array.py b/astropy/table/tests/test_structured_array.py
new file mode 100644
index 0000000000..a015f1b688
--- /dev/null
+++ b/astropy/table/tests/test_structured_array.py
@@ -0,0 +1,25 @@
+# -*- coding: utf-8 -*-
+# Licensed under a 3-clause BSD style license - see LICENSE.rst
+
+import numpy as np
+import pytest
+
+from astropy.table import Column, NdarrayMixin, Table
+
+
+def test_structured_array_becomes_column():
+    """
+    Test that a structured array added to a Table becomes a Column.
+
+    Currently, it is transformed into a bare NdarrayMixin instance, which
+    is a deprecated behavior. This test will fail until the deprecation
+    cycle is complete. See #13186.
+    """
+    structured_array = np.array([(1, 'a'), (2, 'b')],
+                                dtype=[('f0', '<i4'), ('f1', '<U1')])
+
+    t = Table([structured_array], names=['a'])
+
+    # This fails now, as type(t['a']) is NdarrayMixin.
+    # It will pass when the auto-transform is removed and it becomes a Column.
+    assert type(t['a']) is Column

2025-10-04 06:59:20,691 - thread-139911184823872.app.lang_graph.nodes.update_container_node - INFO - Copy over all updated files to the container
2025-10-04 06:59:20,704 - thread-139911184823872.app.docker.base_container - INFO - Resetting git repository in the container
2025-10-04 06:59:20,704 - thread-139911184823872.app.docker.base_container - DEBUG - Executing command: git reset --hard
2025-10-04 06:59:20,804 - thread-139911184823872.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-04 06:59:20,805 - thread-139911184823872.app.docker.base_container - DEBUG - Command output:

HEAD is now at 6ed769d58d Merge pull request #13228 from astrofrog/fix-spectralcoord-no-target

2025-10-04 06:59:20,805 - thread-139911184823872.app.docker.base_container - DEBUG - Executing command: git clean -fd
2025-10-04 06:59:20,905 - thread-139911184823872.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-04 06:59:20,905 - thread-139911184823872.app.docker.base_container - DEBUG - Command output:


2025-10-04 06:59:20,905 - thread-139911184823872.app.docker.base_container - INFO - Updating files in the container after edits.
2025-10-04 06:59:20,905 - thread-139911184823872.app.docker.base_container - INFO - Creating directory astropy/table/tests in the container
2025-10-04 06:59:20,905 - thread-139911184823872.app.docker.base_container - DEBUG - Executing command: mkdir -p astropy/table/tests
2025-10-04 06:59:21,006 - thread-139911184823872.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-04 06:59:21,006 - thread-139911184823872.app.docker.base_container - DEBUG - Command output:


2025-10-04 06:59:21,006 - thread-139911184823872.app.docker.base_container - INFO - Updating astropy/table/tests/test_structured_array.py in the container
2025-10-04 06:59:21,010 - thread-139911184823872.app.docker.base_container - INFO - Files updated successfully
2025-10-04 06:59:25,875 - thread-139911184823872.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "pytest astropy/table/tests/test_structured_array.py"}'}, '__gemini_function_call_thought_signatures__': {'6540dea7-c502-4849-be6c-ad42eb1beb51': 'Cu4HAR/MhbZDKajiVsXgQTbowSR3+hkiz8qXvZaRbyIGLrGvfjovD7EavsiBQA6kH+aABdu8rMoUaYNIsVWcYmHikoIBd0TyP6e1t/jK0hZTehvl1J5vIH7uO6xXE/p0VXtcRJ2RjGum2LpIKfKfqeTYPXZz8bIhS8Vxo1lvRCOJqfi57BBDnEn7ziyiQvTRM5R5et3fp9xHBPfcafA3lx4grDfy8F0akPDIBBd/ymCMuI8J06ETVArUkJ7OVB8qgvfM6F1jeC4zWztU8WBPC3v+/nJegBk60fvBOD1f2PvO7nE11L+JbDX9F/IhMT3p+3UbpyvIBdTNX/wnq5WABunT6z5QfUfqUN1toTRMwlQQ2alnx+Jo6KAGINh8Vp9LqhywpSKxBVKhERmf4wWDFB3Gp4OiouyDbDzDygQFK2JCRJxHUvkf7KunDsBtmJIkRNTXFd9Q8QihFET308jWbleQUk2rHpy+4iKI9zzjbruA/J+iFJzREXIdvNTrgBkWfwMsM7Oy/WDSiAVeW9CQQuTU8x/bRO3fBxMlW6rzfa/soykF7d00E7I5LHxEM7QyHVacPN0CQOKg+a+1h8a6W0DT0q762dDsiqOlwZ97BvIwnT2Eg5Jd02/YBF5DsLRhFoYaOMn2S2gr9vW1+T9/xty9rPySU5pvOU6YCdapkBOMG/Qno9O2QJa8O87JyAaXHeT6txx6dy7j8vUjah1muRoY216aAktuxaUnxw6vu7SMWpalvSEJjyAmkR1nnx+ADImqVMCD4mhZ1vncRZ+bXCBM5Q2s105KntBerFxirZHo/x0SvTqIIGe4A9mb6Gpvk1myg5p9lnzlBD7BnEloTy2qvIdPwn69kz9mnw3Rxi2SxZj72ZXmqHHm2pvJKzQBke6b6X9Qopw06IZL29ScJPEB8Se7a/tYrNBQkdrocFZNRUJ2v83zelxl9F7P1+GkH7hUlA83oquJ01m+FnMDnoBL4oQZsGm/16thWUFQsQdZbX9Z/Y53k30kSJ2CkeWJLhDjmlI68rIErjvua4HEmdoqLza1QviPCoFaiejfd1vGmu1JydJQOYCOTO32H41iM7HC5blnrf7ygZKNZ8zm3vDzqGxM/OTP4SX74xd74Vbv9Oxipy30dpW/J6G2xFDG6PGuUJUOVHUWBEA/nmX99wxQ5jBy3yTS83J5VV0eSvmuVDg+wik9Fp06zusJnMaC7eCZFdtRye9dKqkwN5kHv92O60vYs/ozRAdZAUAFZJsRcPMrMUooxBq4284BV8raPdIP4gTSV8P1uyKzpUgtURH72ItCxUgkouzceNAmEkelk64XIgH/Sfu9RUsGAqnxUw=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 735, 'candidates_token_count': 19, 'total_token_count': 1008, 'prompt_tokens_details': [{'modality': 1, 'token_count': 735}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 19}], 'thoughts_token_count': 254, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -1.4709551961798417, 'model_name': 'gemini-2.5-pro'} id='run--accf34e2-91ff-4a95-8329-769850716813-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'pytest astropy/table/tests/test_structured_array.py'}, 'id': '6540dea7-c502-4849-be6c-ad42eb1beb51', 'type': 'tool_call'}] usage_metadata={'input_tokens': 735, 'output_tokens': 19, 'total_tokens': 1008, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 254}}
2025-10-04 06:59:25,877 - thread-139911184823872.app.docker.base_container - DEBUG - Executing command: pytest astropy/table/tests/test_structured_array.py
2025-10-04 06:59:27,101 - thread-139911184823872.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-04 06:59:27,101 - thread-139911184823872.app.docker.base_container - DEBUG - Command output:
pytest astropy/table/tests/test_
_structured_array.py

[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0

Running tests with Astropy version 5.2.dev64+g6ed769d58.d20251003.
Running tests in astropy/table/tests/test_structured_array.py.

Date: 2025-10-03T22:59:26

Platform: Linux-5.15.0-142-generic-x86_64-with-glibc2.35

Executable: /opt/miniconda3/envs/testbed/bin/python

Full Python Version: 
3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]

encodings: sys: utf-8, locale: UTF-8, filesystem: utf-8
byteorder: little
float info: dig: 15, mant_dig: 15

Package versions: 
Numpy: 1.25.2
Scipy: not available
Matplotlib: not available
h5py: not available
Pandas: not available
PyERFA: 2.0.0.3
Cython: not available
Scikit-image: not available
asdf: not available
pyarrow: not available

Using Astropy options: remote_data: none.

ARCH_ON_CI: undefined
IS_CRON: undefined

rootdir: /testbed
configfile: setup.cfg
plugins: filter-subpackage-0.1.2, openfiles-0.5.0, cov-4.1.0, arraydiff-0.5.0, remotedata-0.4.0, xdist-3.3.1, astropy-header-0.2.2, astropy-0.10.0, hypothesis-6.82.6, mock-3.11.1, doctestplus-1.0.0
[1mcollecting ... [0m[1m
collected 1 item                                                               [0m

astropy/table/tests/test_structured_array.py [31mF[0m[31m                           [100%][0m

=================================== FAILURES ===================================
[31m[1m_____________________ test_structured_array_becomes_column _____________________[0m

    def test_structured_array_becomes_column():
        """
        Test that a structured array added to a Table becomes a Column.
    
        Currently, it is transformed into a bare NdarrayMixin instance, which
        is a deprecated behavior. This test will fail until the deprecation
        cycle is complete. See #13186.
        """
        structured_array = np.array([(1, 'a'), (2, 'b')],
                                    dtype=[('f0', '<i4'), ('f1', '<U1')])
    
        t = Table([structured_array], names=['a'])
    
        # This fails now, as type(t['a']) is NdarrayMixin.
        # It will pass when the auto-transform is removed and it becomes a Column.
>       assert type(t['a']) is Column
[1m[31mE       AssertionError: assert <class 'astropy.table.ndarray_mixin.NdarrayMixin'> is Column[0m
[1m[31mE        +  where <class 'astropy.table.ndarray_mixin.NdarrayMixin'> = type(NdarrayMixin([(1, 'a'), (2, 'b')], dtype=[('f0', '<i4'), ('f1', '<U1')]))[0m

[1m[31mastropy/table/tests/test_structured_array.py[0m:25: AssertionError
[36m[1m=========================== short test summary info ============================[0m
[31mFAILED[0m astropy/table/tests/test_structured_array.py::[1mtest_structured_array_becomes_column[0m - AssertionError: assert <class 'astropy.table.ndarray_mixin.NdarrayMixin'> i...
[31m============================== [31m[1m1 failed[0m[31m in 0.02s[0m[31m ===============================[0m

2025-10-04 06:59:28,599 - thread-139911184823872.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={} response_metadata={'usage_metadata': {'prompt_token_count': 1848, 'total_token_count': 1848, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1848}], 'candidates_token_count': 0, 'thoughts_token_count': 0, 'cached_content_token_count': 0, 'cache_tokens_details': [], 'candidates_tokens_details': []}, 'model_name': 'gemini-2.5-pro'} id='run--ef27b7e9-d1f2-438d-bf12-098a7212ce52-0' usage_metadata={'input_tokens': 1848, 'output_tokens': 0, 'total_tokens': 1848, 'input_token_details': {'cache_read': 0}}
2025-10-04 06:59:48,392 - thread-139911184823872.app.lang_graph.nodes.bug_reproducing_structured_node - DEBUG - reproduced_bug=True reproduced_bug_failure_log='pytest astropy/table/tests/test_\n_structured_array.py\n\n============================= test session starts ==============================\nplatform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0\n\nRunning tests with Astropy version 5.2.dev64+g6ed769d58.d20251003.\nRunning tests in astropy/table/tests/test_structured_array.py.\n\nDate: 2025-10-03T22:59:26\n\nPlatform: Linux-5.15.0-142-generic-x86_64-with-glibc2.35\n\nExecutable: /opt/miniconda3/envs/testbed/bin/python\n\nFull Python Version: \n3.9.20 (main, Oct  3 2024, 07:27:41) \n[GCC 11.2.0]\n\nencodings: sys: utf-8, locale: UTF-8, filesystem: utf-8\nbyteorder: little\nfloat info: dig: 15, mant_dig: 15\n\nPackage versions: \nNumpy: 1.25.2\nScipy: not available\nMatplotlib: not available\nh5py: not available\nPandas: not available\nPyERFA: 2.0.0.3\nCython: not available\nScikit-image: not available\nasdf: not available\npyarrow: not available\n\nUsing Astropy options: remote_data: none.\n\nARCH_ON_CI: undefined\nIS_CRON: undefined\n\nrootdir: /testbed\nconfigfile: setup.cfg\nplugins: filter-subpackage-0.1.2, openfiles-0.5.0, cov-4.1.0, arraydiff-0.5.0, remotedata-0.4.0, xdist-3.3.1, astropy-header-0.2.2, astropy-0.10.0, hypothesis-6.82.6, mock-3.11.1, doctestplus-1.0.0\n\ncollecting ... \n\ncollected 1 item                                                               \n\nastropy/table/tests/test_structured_array.py F                           [100%]\n\n=================================== FAILURES ===================================\n_____________________ test_structured_array_becomes_column _____________________\n\n    def test_structured_array_becomes_column():\n        """\n        Test that a structured array added to a Table becomes a Column.\n    \n        Currently, it is transformed into a bare NdarrayMixin instance, which\n        is a deprecated behavior. This test will fail until the deprecation\n        cycle is complete. See #13186.\n        """\n        structured_array = np.array([(1, \'a\'), (2, \'b\')],\n                                    dtype=[(\'f0\', \'<i4\'), (\'f1\', \'<U1\')])\n    \n        t = Table([structured_array], names=[\'a\'])\n    \n        # This fails now, as type(t[\'a\']) is NdarrayMixin.\n        # It will pass when the auto-transform is removed and it becomes a Column.\n>       assert type(t[\'a\']) is Column\nE       AssertionError: assert <class \'astropy.table.ndarray_mixin.NdarrayMixin\'> is Column\nE        +  where <class \'astropy.table.ndarray_mixin.NdarrayMixin\'> = type(NdarrayMixin([(1, \'a\'), (2, \'b\')], dtype=[(\'f0\', \'<i4\'), (\'f1\', \'<U1\')]))\n\nastropy/table/tests/test_structured_array.py:25: AssertionError\n=========================== short test summary info ============================\nFAILED astropy/table/tests/test_structured_array.py::test_structured_array_becomes_column - AssertionError: assert <class \'astropy.table.ndarray_mixin.NdarrayMixin\'> i...\n============================== 1 failed in 0.02s ===============================' reproduced_bug_commands=['pytest astropy/table/tests/test__structured_array.py']
2025-10-04 06:59:48,393 - thread-139911184823872.app.docker.base_container - INFO - Cleaning up container and temporary files
2025-10-04 06:59:48,393 - thread-139911184823872.app.docker.base_container - INFO - Closing persistent shell...
2025-10-04 06:59:48,493 - thread-139911184823872.app.docker.base_container - INFO - Cleaning up container and temporary files
